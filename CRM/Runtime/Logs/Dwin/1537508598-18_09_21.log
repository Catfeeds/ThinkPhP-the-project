[ 2018-09-21T08:52:27+08:00 ] ::1 /Dwin/Public/loginOk
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_staff` [ RunTime:0.6450s ]
SQL: SHOW COLUMNS FROM `crm_staff` [ RunTime:0.3930s ]
SQL: SELECT `id`,`name`,`pwd`,`errorcount`,`lastlogintime`,`loginaddr`,`loginstatus` FROM `crm_staff` WHERE `username` = 'zeng' ORDER BY id LIMIT 1   [ RunTime:1.0421s ]
SQL: SELECT `id`,`name`,`pwd`,`errorcount`,`lastlogintime`,`loginaddr`,`loginstatus` FROM `crm_staff` WHERE `id` = '394' ORDER BY id LIMIT 1   [ RunTime:0.1200s ]
SQL: SHOW COLUMNS FROM `crm_staff` [ RunTime:0.0940s ]
SQL: SELECT * FROM `crm_staff` WHERE `id` = '394'  [ RunTime:0.0970s ]
SQL: UPDATE `crm_staff` SET `lastlogintime`='1537491140',`loginaddr`='::1',`errorcount`='0' WHERE `id` = '394' [ RunTime:0.4160s ]
SQL: show full fields from crm_staff [ RunTime:0.2270s ]
NOTIC: [8] Array to string conversion F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\ThinkPHP\Library\Think\Model.class.php 第 590 行.
NOTIC: [8] Array to string conversion F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\ThinkPHP\Library\Think\Model.class.php 第 590 行.
SQL: SELECT crm_staff.id user_id,name user_name,roleid role_id,rule_ids rules,deptid dept_id,post_id position FROM `crm_staff` WHERE `username` = 'zeng' ORDER BY id LIMIT 1   [ RunTime:0.4890s ]
SQL: SHOW COLUMNS FROM `crm_auth_role` [ RunTime:0.4570s ]
SQL: SELECT * FROM `crm_auth_role` WHERE ( FIND_IN_SET(394,staff_ids) )  [ RunTime:0.2710s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
NOTIC: [8] Undefined index: deptid F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Controller\PublicController.class.php 第 153 行.

[ 2018-09-21T08:52:47+08:00 ] ::1 /Dwin/Index/checkPostInfo
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001001s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:1.1021s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.5020s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.7560s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:1.4431s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%index/checkpostinfo%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.5350s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:1.1871s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('系统检测菜单权限',NULL,'394','::1','index/checkpostinfo','1537491165','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"flag\":\"1\"}') [ RunTime:0.7550s ]

[ 2018-09-21T08:52:59+08:00 ] ::1 /Dwin/Index/getOrderMsg
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.8020s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.3250s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.4920s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:3.2152s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%index/getordermsg%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.3520s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.6060s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('系统检测不合格订单',NULL,'394','::1','index/getordermsg','1537491176','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','[]') [ RunTime:0.8030s ]
SQL: SHOW COLUMNS FROM `crm_orderform` [ RunTime:0.9991s ]
SQL: SELECT `cus_name` FROM `crm_orderform` WHERE `picid` = '394' AND `check_status` = '2' AND `is_del` = 0  [ RunTime:0.6210s ]

[ 2018-09-21T08:55:22+08:00 ] ::1 /Dwin/Purchase/supplierIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.1140s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0130s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0500s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/supplierindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0180s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0120s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/supplierindex','1537491322','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"supplier_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"charge_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"supplier_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"business_licence\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"enterprise_cate\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"legal_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_bank\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"audit_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"second_audit\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"0\",\"dir\":\"asc\"}],\"start\":\"0\",\"length\":\"25\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"function\":\"undefined\",\"staffLimit\":\"1\",\"audit_status\":\"1\"}') [ RunTime:0.1030s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0240s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 786 行.
SQL: SELECT p.*,crm_staff.name,(
                    CASE
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '0' THEN 0 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '2' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '20' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '02' THEN 2 
                    ELSE 1
                    END 
                  ) AS second_audit,group_concat(DISTINCT(a.status)) FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid ORDER BY supplier_id asc LIMIT 0,25   [ RunTime:0.0460s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 797 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0230s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 804 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0140s ]

[ 2018-09-21T08:55:26+08:00 ] ::1 /Dwin/Purchase/getSupplierAllMsg
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0090s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0100s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.1440s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getsupplierallmsg%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0600s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0770s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getsupplierallmsg','1537491324','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"10326\"}') [ RunTime:0.7080s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0750s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_address` [ RunTime:0.0790s ]
SQL: SELECT crm_purchase_supplier_address.*,crm_staff.name FROM `crm_purchase_supplier_address` left join crm_staff on crm_staff.id = crm_purchase_supplier_address.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10326'  [ RunTime:0.0970s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_contact` [ RunTime:0.0960s ]
SQL: SELECT crm_purchase_supplier_contact.*,crm_staff.name FROM `crm_purchase_supplier_contact` left join crm_staff on crm_staff.id = crm_purchase_supplier_contact.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10326'  [ RunTime:0.0700s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_certification` [ RunTime:0.0460s ]
SQL: SELECT crm_purchase_supplier_certification.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_certification` left join crm_staff on crm_staff.id = crm_purchase_supplier_certification.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_certification.file_id  WHERE `is_del` = 0 AND `supplier_pid` = '10326'  [ RunTime:0.0370s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_awards` [ RunTime:0.1310s ]
SQL: SELECT crm_purchase_supplier_awards.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_awards` left join crm_staff on crm_staff.id = crm_purchase_supplier_awards.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_awards.file_id  WHERE `is_del` = 0 AND `supplier_pid` = '10326'  [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_customer` [ RunTime:0.0440s ]
SQL: SELECT crm_purchase_supplier_customer.*,crm_staff.name FROM `crm_purchase_supplier_customer` left join crm_staff on crm_staff.id = crm_purchase_supplier_customer.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10326'  [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_equity` [ RunTime:0.0370s ]
SQL: SELECT crm_purchase_supplier_equity.*,crm_staff.name FROM `crm_purchase_supplier_equity` left join crm_staff on crm_staff.id = crm_purchase_supplier_equity.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10326'  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_finance` [ RunTime:0.0700s ]
SQL: SELECT * FROM `crm_purchase_supplier_finance` WHERE `supplier_pid` = '10326' AND `is_del` = 0  [ RunTime:0.0270s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_team` [ RunTime:0.0680s ]
SQL: SELECT crm_purchase_supplier_team.*,crm_staff.name FROM `crm_purchase_supplier_team` left join crm_staff on crm_staff.id = crm_purchase_supplier_team.create_id  WHERE `supplier_pid` = '10326' AND `is_del` = 0  [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_cooperation` [ RunTime:0.0370s ]
SQL: SELECT crm_purchase_supplier_cooperation.*,crm_staff.name FROM `crm_purchase_supplier_cooperation` left join crm_staff on crm_staff.id = crm_purchase_supplier_cooperation.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10326'  [ RunTime:0.0180s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_audit` [ RunTime:0.0310s ]
SQL: SELECT crm_purchase_supplier_audit.*,crm_variable_type.name as type_name,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_audit` INNER JOIN crm_variable_type on crm_variable_type.id = crm_purchase_supplier_audit.audit_id left join crm_staff on crm_staff.id = crm_purchase_supplier_audit.staff_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_audit.file_id  WHERE crm_purchase_supplier_audit.supplier_pid = '10326' AND crm_variable_type.status = 1  [ RunTime:0.0410s ]

[ 2018-09-21T08:57:20+08:00 ] ::1 /Dwin/Purchase/supplierIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0640s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0290s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.1000s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.4640s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/supplierindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.4960s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.2860s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/supplierindex','1537491439','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"2\",\"columns\":[{\"data\":\"supplier_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"charge_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"supplier_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"business_licence\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"enterprise_cate\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"legal_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_bank\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"audit_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"second_audit\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"0\",\"dir\":\"asc\"}],\"start\":\"0\",\"length\":\"25\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"function\":\"undefined\",\"staffLimit\":\"1\",\"audit_status\":\"1\"}') [ RunTime:0.4100s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.1520s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 786 行.
SQL: SELECT p.*,crm_staff.name,(
                    CASE
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '0' THEN 0 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '2' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '20' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '02' THEN 2 
                    ELSE 1
                    END 
                  ) AS second_audit,group_concat(DISTINCT(a.status)) FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid ORDER BY supplier_id asc LIMIT 0,25   [ RunTime:0.2350s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 797 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.1370s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 804 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.3610s ]

[ 2018-09-21T09:01:06+08:00 ] ::1 /Dwin/Purchase/contractIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0060s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0100s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0150s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/contractindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/contractindex','1537491666','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"contract_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"supplier_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"signing_time\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"total_amount\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"billing_method\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"supplier_representative\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"supplier_phone\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"is_return_contract\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"order_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"audit_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"file_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"0\",\"dir\":\"asc\"}],\"start\":\"0\",\"length\":\"25\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"function\":\"undefined\",\"staffLimit\":\"1\",\"audit_status\":\"0\"}') [ RunTime:0.0730s ]
SQL: SHOW COLUMNS FROM `crm_purchase_contract` [ RunTime:0.0180s ]
SQL: SELECT c.*,s.name,u.file_name,u.path as file_url,IF(IFNULL(count( o.id ),0),1,0) AS order_status FROM crm_purchase_contract c left join crm_staff s on s.id = c.create_id left join crm_file_upload u on u.id = c.file_id left join crm_purchase_order o on o.contract_pid = c.id and o.is_del = 0  WHERE c.audit_status = 0 AND c.charger = '394' AND c.is_del = 0 GROUP BY c.id ORDER BY contract_id asc LIMIT 0,25   [ RunTime:0.0690s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_purchase_contract c left join crm_staff s on s.id = c.create_id left join crm_file_upload u on u.id = c.file_id  WHERE c.audit_status = 0 AND c.charger = '394' AND c.is_del = 0 LIMIT 1   [ RunTime:0.1050s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_purchase_contract c left join crm_staff s on s.id = c.create_id left join crm_file_upload u on u.id = c.file_id  WHERE c.audit_status = 0 AND c.charger = '394' AND c.is_del = 0 LIMIT 1   [ RunTime:0.0700s ]

[ 2018-09-21T09:01:13+08:00 ] ::1 /Dwin/Purchase/orderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001001s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0220s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/orderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0090s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/orderindex','1537491673','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"purchase_order_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"supplier_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"order_time\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"total_amount\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"billing_method\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"supplier_representative\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"supplier_phone\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"purchase_mode\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"purchase_type\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"audit_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"0\",\"dir\":\"asc\"}],\"start\":\"0\",\"length\":\"25\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"function\":\"undefined\",\"staffLimit\":\"1\",\"audit_status\":\"0\"}') [ RunTime:0.0700s ]
SQL: SHOW COLUMNS FROM `crm_purchase_order` [ RunTime:0.0150s ]
SQL: SELECT o.*,s.name FROM crm_purchase_order o left join crm_staff s on s.id = o.create_id  WHERE o.audit_status = 0 AND o.create_id = '394' AND o.is_del = 0 ORDER BY purchase_order_id asc LIMIT 0,25   [ RunTime:0.0080s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_purchase_order o left join crm_staff s on s.id = o.create_id  WHERE o.audit_status = 0 AND o.create_id = '394' AND o.is_del = 0 LIMIT 1   [ RunTime:0.0030s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_purchase_order o left join crm_staff s on s.id = o.create_id  WHERE o.audit_status = 0 AND o.create_id = '394' AND o.is_del = 0 LIMIT 1   [ RunTime:0.0030s ]

[ 2018-09-21T09:01:19+08:00 ] ::1 /Dwin/Stock/stockIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0100s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0100s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%stock/stockindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0080s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','stock/stockindex','1537491679','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"all_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"o_audit\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"out_processing\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"i_audit\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"rework_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"mouth_i_stock\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"mouth_o_stock\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"update_time\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"11\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"repoID\":\"\"}') [ RunTime:0.0650s ]
SQL: SHOW COLUMNS FROM `crm_material` [ RunTime:0.0640s ]
SQL: SELECT COUNT(*) AS tp_count FROM `crm_material` LIMIT 1   [ RunTime:0.0060s ]
SQL: SELECT COUNT(*) AS tp_count FROM `crm_material` LIMIT 1   [ RunTime:0.0040s ]
SQL: SELECT material.product_id,material.product_no,material.product_name,material.product_number,material.material_type,material.rework_number,material.production_number,material.safety_number,sum(stock_number) + sum(o_audit) all_number,sum(stock_number) stock_number,sum(o_audit) o_audit,sum(i_audit) i_audit,sum(out_processing) out_processing,sum(i_record.num) mouth_i_stock,sum(o_record.num) mouth_o_stock,material.safety_number - stock_number warning_number,from_unixtime(max(stock.update_time)) update_time FROM crm_material material LEFT JOIN crm_stock stock ON stock.product_id = material.product_id LEFT JOIN crm_stock_in_record i_record ON (material.product_id = i_record.product_id and i_record.status = 2 and i_record.create_time > 1535731200) LEFT JOIN crm_stock_out_record o_record ON (material.product_id = o_record.product_id and o_record.status = 2 and i_record.create_time > 1535731200)  GROUP BY material.product_id ORDER BY update_time desc LIMIT 0,10   [ RunTime:0.1870s ]

[ 2018-09-21T09:01:43+08:00 ] ::1 /Dwin/Production/productionPlan
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0100s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0080s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionplan%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('展示生产计划',NULL,'394','::1','production/productionplan','1537491703','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_order\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"staff_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_cate_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"create_time\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"delivery_time\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"yqts\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_plan_rest_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"production_status\":\"\",\"production_line\":\"\"}') [ RunTime:0.0680s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0080s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_auth_role` [ RunTime:0.0130s ]
SQL: SELECT `role_id`,`staff_ids` FROM `crm_auth_role` WHERE `role_id` IN (50)  [ RunTime:0.0070s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0450s ]
SQL: SELECT COUNT(*) AS tp_count FROM `crm_production_plan` WHERE `production_status` IN ('1','2','3','4') AND `is_del` = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') LIMIT 1   [ RunTime:0.1490s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_plan plan WHERE `production_status` IN ('1','2','3','4') AND `is_del` = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') LIMIT 1   [ RunTime:0.0210s ]
SQL: SELECT plan.id,`production_order`,`staff_name`,`stock_cate_name`,plan.product_name,`production_line_name`,`production_plan_number`,plan.production_number,from_unixtime(create_time,'%y-%m-%d') create_time,from_unixtime(delivery_time,'%y-%m-%d') delivery_time,`production_status`,ifnull(plan.tips,'无') tips,delivery_time yqts,sum(stock.stock_number) stock_number,sum(stock.o_audit) o_audit,sum(product.production_number) product_num,sum(product.production_number) production_plan_rest_num FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id  WHERE `production_status` IN ('1','2','3','4') AND `is_del` = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') GROUP BY plan.id ORDER BY create_time desc,plan.id desc LIMIT 0,10   [ RunTime:0.0360s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0100s ]
SQL: SELECT SUM(production_plan_rest_number) AS tp_sum FROM `crm_production_plan` WHERE `product_name` = '10.4寸保护膜' AND `production_line_name` = 'SMT线' AND `production_status` = 3 LIMIT 1   [ RunTime:0.0180s ]

[ 2018-09-21T09:01:45+08:00 ] ::1 /Dwin/Production/productionPlan
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0060s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0130s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0170s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionplan%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0090s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('展示生产计划',NULL,'394','::1','production/productionplan','1537491704','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_order\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"staff_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_cate_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"create_time\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"delivery_time\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"yqts\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_plan_rest_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"production_status\":\"\",\"production_line\":\"\"}') [ RunTime:0.0960s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0850s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0620s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_auth_role` [ RunTime:0.0660s ]
SQL: SELECT `role_id`,`staff_ids` FROM `crm_auth_role` WHERE `role_id` IN (50)  [ RunTime:0.0290s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0100s ]
SQL: SELECT COUNT(*) AS tp_count FROM `crm_production_plan` WHERE `production_status` IN ('1','2','3','4') AND `is_del` = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') LIMIT 1   [ RunTime:0.0260s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_plan plan WHERE `production_status` IN ('1','2','3','4') AND `is_del` = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') LIMIT 1   [ RunTime:0.0170s ]
SQL: SELECT plan.id,`production_order`,`staff_name`,`stock_cate_name`,plan.product_name,`production_line_name`,`production_plan_number`,plan.production_number,from_unixtime(create_time,'%y-%m-%d') create_time,from_unixtime(delivery_time,'%y-%m-%d') delivery_time,`production_status`,ifnull(plan.tips,'无') tips,delivery_time yqts,sum(stock.stock_number) stock_number,sum(stock.o_audit) o_audit,sum(product.production_number) product_num,sum(product.production_number) production_plan_rest_num FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id  WHERE `production_status` IN ('1','2','3','4') AND `is_del` = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') GROUP BY plan.id ORDER BY create_time desc,plan.id desc LIMIT 0,10   [ RunTime:0.0400s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0080s ]
SQL: SELECT SUM(production_plan_rest_number) AS tp_sum FROM `crm_production_plan` WHERE `product_name` = '10.4寸保护膜' AND `production_line_name` = 'SMT线' AND `production_status` = 3 LIMIT 1   [ RunTime:0.0220s ]

[ 2018-09-21T09:01:49+08:00 ] ::1 /Dwin/Production/productionPlan
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.004000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0080s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0090s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0170s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionplan%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0140s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('展示生产计划',NULL,'394','::1','production/productionplan','1537491708','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_order\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"staff_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_cate_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"create_time\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"delivery_time\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"yqts\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_plan_rest_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"production_status\":\"\",\"production_line\":\"\"}') [ RunTime:0.0490s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0110s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0110s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_auth_role` [ RunTime:0.0090s ]
SQL: SELECT `role_id`,`staff_ids` FROM `crm_auth_role` WHERE `role_id` IN (50)  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0300s ]
SQL: SELECT COUNT(*) AS tp_count FROM `crm_production_plan` WHERE `production_status` IN ('1','2','3','4') AND `is_del` = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') LIMIT 1   [ RunTime:0.0190s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_plan plan WHERE `production_status` IN ('1','2','3','4') AND `is_del` = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') LIMIT 1   [ RunTime:0.0190s ]
SQL: SELECT plan.id,`production_order`,`staff_name`,`stock_cate_name`,plan.product_name,`production_line_name`,`production_plan_number`,plan.production_number,from_unixtime(create_time,'%y-%m-%d') create_time,from_unixtime(delivery_time,'%y-%m-%d') delivery_time,`production_status`,ifnull(plan.tips,'无') tips,delivery_time yqts,sum(stock.stock_number) stock_number,sum(stock.o_audit) o_audit,sum(product.production_number) product_num,sum(product.production_number) production_plan_rest_num FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id  WHERE `production_status` IN ('1','2','3','4') AND `is_del` = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') GROUP BY plan.id ORDER BY create_time desc,plan.id desc LIMIT 0,10   [ RunTime:0.0410s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0120s ]
SQL: SELECT SUM(production_plan_rest_number) AS tp_sum FROM `crm_production_plan` WHERE `product_name` = '10.4寸保护膜' AND `production_line_name` = 'SMT线' AND `production_status` = 3 LIMIT 1   [ RunTime:0.0200s ]

[ 2018-09-21T09:01:50+08:00 ] ::1 /Dwin/Stock/showWarehouse
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0190s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0090s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0450s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%stock/showwarehouse%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0080s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('库房信息',NULL,'394','::1','stock/showwarehouse','1537491710','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"rep_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"repertory_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"manager_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"logistics_staff_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"display_level\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"0\",\"dir\":\"asc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}') [ RunTime:0.0730s ]
SQL: SHOW COLUMNS FROM `crm_repertorylist` [ RunTime:0.0070s ]
SQL: SELECT COUNT(rep_id) AS tp_count FROM `crm_repertorylist` LIMIT 1   [ RunTime:0.0050s ]
SQL: SELECT COUNT(distinct rep_id) AS tp_count FROM crm_repertorylist repertory LEFT JOIN crm_staff manager ON FIND_IN_SET(manager.id,repertory.warehouse_manager_id) LEFT JOIN crm_staff logistics_staff ON FIND_IN_SET(logistics_staff.id,repertory.logistics_staff_id)  WHERE `is_del` = 0 LIMIT 1   [ RunTime:0.0080s ]
SQL: SELECT repertory.*,group_concat(DISTINCT logistics_staff.name) logistics_staff_name,group_concat(DISTINCT manager.name) manager_name FROM crm_repertorylist repertory LEFT JOIN crm_staff manager ON FIND_IN_SET(manager.id,repertory.warehouse_manager_id) LEFT JOIN crm_staff logistics_staff ON FIND_IN_SET(logistics_staff.id,repertory.logistics_staff_id)  WHERE `is_del` = 0 GROUP BY rep_id ORDER BY rep_id asc LIMIT 0,10   [ RunTime:0.0380s ]

[ 2018-09-21T09:01:58+08:00 ] ::1 /Dwin/Stock/index
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.003001s ]
INFO: [ app_begin ] --END-- [ RunTime:0.004001s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0100s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0100s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0110s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%stock/index%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0180s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('显示所有库存数量',NULL,'394','::1','stock/index','1537491717','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"all_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"o_audit\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"out_processing\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"i_audit\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"rework_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"mouth_i_stock\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"mouth_o_stock\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"update_time\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"11\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"repoID\":\"\"}') [ RunTime:0.0650s ]
SQL: SHOW COLUMNS FROM `crm_material` [ RunTime:0.0100s ]
SQL: SELECT COUNT(*) AS tp_count FROM `crm_material` LIMIT 1   [ RunTime:0.0210s ]
SQL: SELECT COUNT(*) AS tp_count FROM `crm_material` LIMIT 1   [ RunTime:0.0040s ]
SQL: SELECT material.product_id,material.product_no,material.product_name,material.product_number,material.material_type,material.rework_number,material.production_number,material.safety_number,sum(stock_number) + sum(o_audit) all_number,sum(stock_number) stock_number,sum(o_audit) o_audit,sum(i_audit) i_audit,sum(out_processing) out_processing,sum(i_record.num) mouth_i_stock,sum(o_record.num) mouth_o_stock,material.safety_number - stock_number warning_number,from_unixtime(max(stock.update_time)) update_time FROM crm_material material LEFT JOIN crm_stock stock ON stock.product_id = material.product_id LEFT JOIN crm_stock_in_record i_record ON (material.product_id = i_record.product_id and i_record.status = 2 and i_record.create_time > 1535731200) LEFT JOIN crm_stock_out_record o_record ON (material.product_id = o_record.product_id and o_record.status = 2 and i_record.create_time > 1535731200)  WHERE `warehouse_number` IN ('K003','K004') GROUP BY material.product_id ORDER BY update_time desc LIMIT 0,10   [ RunTime:0.0840s ]

[ 2018-09-21T09:02:00+08:00 ] ::1 /Dwin/Stock/index
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0080s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0110s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0180s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%stock/index%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0090s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('显示所有库存数量',NULL,'394','::1','stock/index','1537491720','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"all_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"o_audit\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"out_processing\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"i_audit\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"rework_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"mouth_i_stock\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"mouth_o_stock\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"update_time\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"11\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"repoID\":\"\"}') [ RunTime:0.0800s ]
SQL: SHOW COLUMNS FROM `crm_material` [ RunTime:0.0130s ]
SQL: SELECT COUNT(*) AS tp_count FROM `crm_material` LIMIT 1   [ RunTime:0.0050s ]
SQL: SELECT COUNT(*) AS tp_count FROM `crm_material` LIMIT 1   [ RunTime:0.0070s ]
SQL: SELECT material.product_id,material.product_no,material.product_name,material.product_number,material.material_type,material.rework_number,material.production_number,material.safety_number,sum(stock_number) + sum(o_audit) all_number,sum(stock_number) stock_number,sum(o_audit) o_audit,sum(i_audit) i_audit,sum(out_processing) out_processing,sum(i_record.num) mouth_i_stock,sum(o_record.num) mouth_o_stock,material.safety_number - stock_number warning_number,from_unixtime(max(stock.update_time)) update_time FROM crm_material material LEFT JOIN crm_stock stock ON stock.product_id = material.product_id LEFT JOIN crm_stock_in_record i_record ON (material.product_id = i_record.product_id and i_record.status = 2 and i_record.create_time > 1535731200) LEFT JOIN crm_stock_out_record o_record ON (material.product_id = o_record.product_id and o_record.status = 2 and i_record.create_time > 1535731200)  WHERE `warehouse_number` IN ('K003','K004') GROUP BY material.product_id ORDER BY update_time desc LIMIT 0,10   [ RunTime:0.0960s ]

[ 2018-09-21T09:02:02+08:00 ] ::1 /Dwin/Stock/alarm
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0190s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0530s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%stock/alarm%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0110s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('显示修改库存报警',NULL,'394','::1','stock/alarm','1537491722','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"product_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"safety_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"warning_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"i_audit\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"o_audit\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"rework_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"update_time\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"false\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"9\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}') [ RunTime:0.0870s ]
SQL: SHOW COLUMNS FROM `crm_material` [ RunTime:0.0110s ]
NOTIC: [8] Undefined index: method F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Controller\StockController.class.php 第 1717 行.
SQL: SELECT COUNT(*) AS tp_count FROM `crm_material` LIMIT 1   [ RunTime:0.0120s ]
SQL: SELECT COUNT(*) AS tp_count FROM `crm_material` LIMIT 1   [ RunTime:0.0180s ]
SQL: SELECT material.product_id,material.product_no,material.product_name,material.product_number,material.material_type,material.rework_number,material.production_number,material.safety_number,sum(stock_number) + sum(o_audit) all_number,sum(stock_number) stock_number,sum(o_audit) o_audit,sum(i_audit) i_audit,sum(out_processing) out_processing,sum(i_record.num) mouth_i_stock,sum(o_record.num) mouth_o_stock,material.safety_number - stock_number warning_number,from_unixtime(max(stock.update_time)) update_time FROM crm_material material LEFT JOIN crm_stock stock ON stock.product_id = material.product_id LEFT JOIN crm_stock_in_record i_record ON (material.product_id = i_record.product_id and i_record.status = 2 and i_record.create_time > 1535731200) LEFT JOIN crm_stock_out_record o_record ON (material.product_id = o_record.product_id and o_record.status = 2 and i_record.create_time > 1535731200)  GROUP BY material.product_id ORDER BY update_time desc LIMIT 0,10   [ RunTime:0.1020s ]

[ 2018-09-21T09:02:06+08:00 ] ::1 /Dwin/Stock/showPendingOrderList
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.003000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0310s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0290s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0290s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0810s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%stock/showpendingorderlist%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0200s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0130s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('待出库订单',NULL,'394','::1','stock/showpendingorderlist','1537491725','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"cpo_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"type_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"finance_audit_time\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"staname\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"staff_phone\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"cusname\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"check_status_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"log_type\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"ware_house\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"is_batch_delivery\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"logistices_tip\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"0\",\"dir\":\"asc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"pendingData\":\"3\",\"orderLimit\":\"1\"}') [ RunTime:0.0940s ]
SQL: SHOW COLUMNS FROM `crm_orderform` [ RunTime:0.0290s ]
SQL: SHOW COLUMNS FROM `crm_auth_role` [ RunTime:0.0140s ]
SQL: SELECT `staff_ids` FROM `crm_auth_role` WHERE `role_id` = 1 LIMIT 1   [ RunTime:0.0070s ]
SQL: SELECT `staff_ids` FROM `crm_auth_role` WHERE `role_id` = 2 LIMIT 1   [ RunTime:0.0200s ]
SQL: SELECT `staff_ids` FROM `crm_auth_role` WHERE `role_id` = 3 LIMIT 1   [ RunTime:0.0170s ]
SQL: SELECT `staff_ids` FROM `crm_auth_role` WHERE `role_id` = 8 LIMIT 1   [ RunTime:0.0030s ]
SQL: SELECT `staff_ids` FROM `crm_auth_role` WHERE `role_id` = 13 LIMIT 1   [ RunTime:0.0060s ]
SQL: SELECT `staff_ids` FROM `crm_auth_role` WHERE `role_id` = 16 LIMIT 1   [ RunTime:0.0030s ]
SQL: SELECT `staff_ids` FROM `crm_auth_role` WHERE `role_id` = 34 LIMIT 1   [ RunTime:0.0120s ]
SQL: SELECT `staff_ids` FROM `crm_auth_role` WHERE `role_id` = 37 LIMIT 1   [ RunTime:0.0110s ]
SQL: SELECT `staff_ids` FROM `crm_auth_role` WHERE `role_id` = 40 LIMIT 1   [ RunTime:0.0070s ]
SQL: SELECT `staff_ids` FROM `crm_auth_role` WHERE `role_id` = 43 LIMIT 1   [ RunTime:0.0270s ]
SQL: SELECT `staff_ids` FROM `crm_auth_role` WHERE `role_id` = 44 LIMIT 1   [ RunTime:0.0070s ]
SQL: SELECT `staff_ids` FROM `crm_auth_role` WHERE `role_id` = 45 LIMIT 1   [ RunTime:0.0100s ]
SQL: SELECT `staff_ids` FROM `crm_auth_role` WHERE `role_id` = 46 LIMIT 1   [ RunTime:0.0200s ]
SQL: SELECT `staff_ids` FROM `crm_auth_role` WHERE `role_id` = 47 LIMIT 1   [ RunTime:0.0090s ]
SQL: SELECT `staff_ids` FROM `crm_auth_role` WHERE `role_id` = 48 LIMIT 1   [ RunTime:0.0540s ]
SQL: SELECT `staff_ids` FROM `crm_auth_role` WHERE `role_id` = 49 LIMIT 1   [ RunTime:0.0480s ]
SQL: SELECT `staff_ids` FROM `crm_auth_role` WHERE `role_id` = 51 LIMIT 1   [ RunTime:0.0930s ]
SQL: SELECT `staff_ids` FROM `crm_auth_role` WHERE `role_id` = 21 LIMIT 1   [ RunTime:0.0610s ]
SQL: SELECT COUNT(id) AS tp_count FROM `crm_orderform` WHERE `check_status` = '4' AND `stock_status` IN ('0','1','2') LIMIT 1   [ RunTime:0.0360s ]
SQL: SELECT COUNT(id) AS tp_count FROM `crm_orderform` WHERE `check_status` = '4' AND `stock_status` IN ('0','1','2') LIMIT 1   [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_orderform` [ RunTime:0.0130s ]
SQL: SELECT crm_orderform.id,`cpo_id`,d.order_type_name type_name,from_unixtime(settlement_time) finance_audit_time,pic_name staname,pic_phone staff_phone,if (LENGTH(cus_name) < 7,`cus_name`,REPLACE(cus_name,SUBSTRING(cus_name,3,4),"****")) cusname,j.check_type_name check_status_name,stock_status stock_out_status,f.logistics_type_name log_type,GROUP_CONCAT(distinct b.repertory_name) ware_house,`is_batch_delivery`,`logistices_tip` FROM `crm_orderform` LEFT JOIN `crm_repertorylist` b ON FIND_IN_SET(b.rep_id,delivery_ware_house) LEFT JOIN `crm_settlementlist` c ON c.settle_id = settlement_method LEFT JOIN `crm_order_type` d ON d.type_id = crm_orderform.order_type LEFT JOIN `crm_order_performance_type` e ON e.type_id = crm_orderform.static_type LEFT JOIN `crm_order_logistics_type` f ON f.type_id = crm_orderform.logistics_type LEFT JOIN `crm_order_freight_payment_type` g ON g.type_id = crm_orderform.freight_payment_method LEFT JOIN `crm_order_invoice` h ON h.type_id =crm_orderform.invoice_type LEFT JOIN `crm_order_invoice_situation` i ON i.type_id = crm_orderform.invoice_situation LEFT JOIN `crm_order_check_status` j ON j.type_id = crm_orderform.check_status  WHERE `check_status` = '4' AND `stock_status` IN ('0','1','2') GROUP BY crm_orderform.id ORDER BY cpo_id asc LIMIT 0,10   [ RunTime:0.3100s ]

[ 2018-09-21T09:02:08+08:00 ] ::1 /Dwin/Stock/alarm
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0190s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0160s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0210s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0290s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%stock/alarm%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0110s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('显示修改库存报警',NULL,'394','::1','stock/alarm','1537491727','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"product_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"safety_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"warning_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"i_audit\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"o_audit\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"rework_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"update_time\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"false\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"9\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}') [ RunTime:0.1230s ]
SQL: SHOW COLUMNS FROM `crm_material` [ RunTime:0.0600s ]
NOTIC: [8] Undefined index: method F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Controller\StockController.class.php 第 1717 行.
SQL: SELECT COUNT(*) AS tp_count FROM `crm_material` LIMIT 1   [ RunTime:0.0510s ]
SQL: SELECT COUNT(*) AS tp_count FROM `crm_material` LIMIT 1   [ RunTime:0.0440s ]
SQL: SELECT material.product_id,material.product_no,material.product_name,material.product_number,material.material_type,material.rework_number,material.production_number,material.safety_number,sum(stock_number) + sum(o_audit) all_number,sum(stock_number) stock_number,sum(o_audit) o_audit,sum(i_audit) i_audit,sum(out_processing) out_processing,sum(i_record.num) mouth_i_stock,sum(o_record.num) mouth_o_stock,material.safety_number - stock_number warning_number,from_unixtime(max(stock.update_time)) update_time FROM crm_material material LEFT JOIN crm_stock stock ON stock.product_id = material.product_id LEFT JOIN crm_stock_in_record i_record ON (material.product_id = i_record.product_id and i_record.status = 2 and i_record.create_time > 1535731200) LEFT JOIN crm_stock_out_record o_record ON (material.product_id = o_record.product_id and o_record.status = 2 and i_record.create_time > 1535731200)  GROUP BY material.product_id ORDER BY update_time desc LIMIT 0,10   [ RunTime:0.0830s ]

[ 2018-09-21T09:02:20+08:00 ] ::1 /Dwin/Stock/alarm
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0130s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0260s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0360s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%stock/alarm%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0150s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0170s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('显示修改库存报警',NULL,'394','::1','stock/alarm','1537491740','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"2\",\"columns\":[{\"data\":\"product_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"safety_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"warning_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"i_audit\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"o_audit\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"rework_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"update_time\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"false\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"9\",\"dir\":\"desc\"}],\"start\":\"20\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}') [ RunTime:0.0760s ]
SQL: SHOW COLUMNS FROM `crm_material` [ RunTime:0.0100s ]
NOTIC: [8] Undefined index: method F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Controller\StockController.class.php 第 1717 行.
SQL: SELECT COUNT(*) AS tp_count FROM `crm_material` LIMIT 1   [ RunTime:0.0040s ]
SQL: SELECT COUNT(*) AS tp_count FROM `crm_material` LIMIT 1   [ RunTime:0.0040s ]
SQL: SELECT material.product_id,material.product_no,material.product_name,material.product_number,material.material_type,material.rework_number,material.production_number,material.safety_number,sum(stock_number) + sum(o_audit) all_number,sum(stock_number) stock_number,sum(o_audit) o_audit,sum(i_audit) i_audit,sum(out_processing) out_processing,sum(i_record.num) mouth_i_stock,sum(o_record.num) mouth_o_stock,material.safety_number - stock_number warning_number,from_unixtime(max(stock.update_time)) update_time FROM crm_material material LEFT JOIN crm_stock stock ON stock.product_id = material.product_id LEFT JOIN crm_stock_in_record i_record ON (material.product_id = i_record.product_id and i_record.status = 2 and i_record.create_time > 1535731200) LEFT JOIN crm_stock_out_record o_record ON (material.product_id = o_record.product_id and o_record.status = 2 and i_record.create_time > 1535731200)  GROUP BY material.product_id ORDER BY update_time desc LIMIT 20,10   [ RunTime:0.0930s ]

[ 2018-09-21T09:02:21+08:00 ] ::1 /Dwin/Stock/alarm
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0250s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0150s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0210s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0570s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%stock/alarm%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0390s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0110s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('显示修改库存报警',NULL,'394','::1','stock/alarm','1537491741','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"3\",\"columns\":[{\"data\":\"product_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"safety_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"warning_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"i_audit\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"o_audit\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"rework_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"update_time\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"false\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"9\",\"dir\":\"desc\"}],\"start\":\"10\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}') [ RunTime:0.1090s ]
SQL: SHOW COLUMNS FROM `crm_material` [ RunTime:0.0220s ]
NOTIC: [8] Undefined index: method F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Controller\StockController.class.php 第 1717 行.
SQL: SELECT COUNT(*) AS tp_count FROM `crm_material` LIMIT 1   [ RunTime:0.0530s ]
SQL: SELECT COUNT(*) AS tp_count FROM `crm_material` LIMIT 1   [ RunTime:0.0200s ]
SQL: SELECT material.product_id,material.product_no,material.product_name,material.product_number,material.material_type,material.rework_number,material.production_number,material.safety_number,sum(stock_number) + sum(o_audit) all_number,sum(stock_number) stock_number,sum(o_audit) o_audit,sum(i_audit) i_audit,sum(out_processing) out_processing,sum(i_record.num) mouth_i_stock,sum(o_record.num) mouth_o_stock,material.safety_number - stock_number warning_number,from_unixtime(max(stock.update_time)) update_time FROM crm_material material LEFT JOIN crm_stock stock ON stock.product_id = material.product_id LEFT JOIN crm_stock_in_record i_record ON (material.product_id = i_record.product_id and i_record.status = 2 and i_record.create_time > 1535731200) LEFT JOIN crm_stock_out_record o_record ON (material.product_id = o_record.product_id and o_record.status = 2 and i_record.create_time > 1535731200)  GROUP BY material.product_id ORDER BY update_time desc LIMIT 10,10   [ RunTime:0.0810s ]

[ 2018-09-21T09:02:22+08:00 ] ::1 /Dwin/Stock/alarm
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0190s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0250s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0180s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%stock/alarm%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0120s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('显示修改库存报警',NULL,'394','::1','stock/alarm','1537491742','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"4\",\"columns\":[{\"data\":\"product_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"safety_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"warning_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"i_audit\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"o_audit\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"rework_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"update_time\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"false\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"9\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}') [ RunTime:0.0430s ]
SQL: SHOW COLUMNS FROM `crm_material` [ RunTime:0.0250s ]
NOTIC: [8] Undefined index: method F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Controller\StockController.class.php 第 1717 行.
SQL: SELECT COUNT(*) AS tp_count FROM `crm_material` LIMIT 1   [ RunTime:0.0090s ]
SQL: SELECT COUNT(*) AS tp_count FROM `crm_material` LIMIT 1   [ RunTime:0.0040s ]
SQL: SELECT material.product_id,material.product_no,material.product_name,material.product_number,material.material_type,material.rework_number,material.production_number,material.safety_number,sum(stock_number) + sum(o_audit) all_number,sum(stock_number) stock_number,sum(o_audit) o_audit,sum(i_audit) i_audit,sum(out_processing) out_processing,sum(i_record.num) mouth_i_stock,sum(o_record.num) mouth_o_stock,material.safety_number - stock_number warning_number,from_unixtime(max(stock.update_time)) update_time FROM crm_material material LEFT JOIN crm_stock stock ON stock.product_id = material.product_id LEFT JOIN crm_stock_in_record i_record ON (material.product_id = i_record.product_id and i_record.status = 2 and i_record.create_time > 1535731200) LEFT JOIN crm_stock_out_record o_record ON (material.product_id = o_record.product_id and o_record.status = 2 and i_record.create_time > 1535731200)  GROUP BY material.product_id ORDER BY update_time desc LIMIT 0,10   [ RunTime:0.0940s ]

[ 2018-09-21T09:08:13+08:00 ] ::1 /Dwin/Stock/showStockOutRecord
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.004000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0110s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0020s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0080s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0160s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%stock/showstockoutrecord%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0120s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('入库记录',NULL,'394','::1','stock/showstockoutrecord','1537492093','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"audit_order_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"num\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"warehouse_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"cate_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"action_order_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"express_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"audit_status\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"proposer_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"auditor_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"audit_tips\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"update_time\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"12\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"status\":\"\",\"repertory_id\":\"\"}') [ RunTime:0.0810s ]
SQL: SHOW COLUMNS FROM `crm_repertorylist` [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_auth_role` [ RunTime:0.0080s ]
SQL: SELECT MAX(stock_level) AS max FROM crm_auth_role WHERE FIND_IN_SET('394',staff_ids) [ RunTime:0.0030s ]
SQL: SELECT 
                        rep_id,repertory_name 
                        FROM crm_repertorylist 
                        WHERE 
                          display_level <= 3 
                          or 
                          find_in_set(394, warehouse_manager_id) 
                          or
                          find_in_set(394, logistics_staff_id) [ RunTime:0.0110s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT `staff_ids` FROM `crm_auth_role` WHERE `role_id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SELECT `staff_ids` FROM `crm_auth_role` WHERE `role_id` = 2 LIMIT 1   [ RunTime:0.0070s ]
SQL: SELECT `staff_ids` FROM `crm_auth_role` WHERE `role_id` = 3 LIMIT 1   [ RunTime:0.0040s ]
SQL: SELECT `staff_ids` FROM `crm_auth_role` WHERE `role_id` = 8 LIMIT 1   [ RunTime:0.0040s ]
SQL: SELECT `staff_ids` FROM `crm_auth_role` WHERE `role_id` = 13 LIMIT 1   [ RunTime:0.0040s ]
SQL: SELECT `staff_ids` FROM `crm_auth_role` WHERE `role_id` = 16 LIMIT 1   [ RunTime:0.0060s ]
SQL: SELECT `staff_ids` FROM `crm_auth_role` WHERE `role_id` = 34 LIMIT 1   [ RunTime:0.0070s ]
SQL: SELECT `staff_ids` FROM `crm_auth_role` WHERE `role_id` = 37 LIMIT 1   [ RunTime:0.0030s ]
SQL: SELECT `staff_ids` FROM `crm_auth_role` WHERE `role_id` = 40 LIMIT 1   [ RunTime:0.0030s ]
SQL: SELECT `staff_ids` FROM `crm_auth_role` WHERE `role_id` = 43 LIMIT 1   [ RunTime:0.0040s ]
SQL: SELECT `staff_ids` FROM `crm_auth_role` WHERE `role_id` = 44 LIMIT 1   [ RunTime:0.0030s ]
SQL: SELECT `staff_ids` FROM `crm_auth_role` WHERE `role_id` = 45 LIMIT 1   [ RunTime:0.0050s ]
SQL: SELECT `staff_ids` FROM `crm_auth_role` WHERE `role_id` = 46 LIMIT 1   [ RunTime:0.0040s ]
SQL: SELECT `staff_ids` FROM `crm_auth_role` WHERE `role_id` = 47 LIMIT 1   [ RunTime:0.0090s ]
SQL: SELECT `staff_ids` FROM `crm_auth_role` WHERE `role_id` = 48 LIMIT 1   [ RunTime:0.0020s ]
SQL: SELECT `staff_ids` FROM `crm_auth_role` WHERE `role_id` = 49 LIMIT 1   [ RunTime:0.0060s ]
SQL: SELECT `staff_ids` FROM `crm_auth_role` WHERE `role_id` = 51 LIMIT 1   [ RunTime:0.0030s ]
SQL: SELECT `staff_ids` FROM `crm_auth_role` WHERE `role_id` = 21 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stock_audit_out` [ RunTime:0.0750s ]
SQL: SELECT COUNT(*) AS tp_count FROM `crm_stock_audit_out` WHERE `is_del` = 0 AND `type` = '2' AND `warehouse_number` IN ('BJFY001','C0001','C0002','FY001','FY002','K001','K002','K003','K004','K010','K015','K020','K20','K22','K23','SH001','XC005','XC006','YJ001','YS001','ZC001','ZC002','ZC003','ZC004','ZC005','ZZK001') LIMIT 1   [ RunTime:0.0240s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_stock_audit_out audit WHERE `is_del` = 0 AND `type` = '2' AND `warehouse_number` IN ('BJFY001','C0001','C0002','FY001','FY002','K001','K002','K003','K004','K010','K015','K020','K20','K22','K23','SH001','XC005','XC006','YJ001','YS001','ZC001','ZC002','ZC003','ZC004','ZC005','ZZK001') LIMIT 1   [ RunTime:0.0130s ]
SQL: SELECT audit.* FROM crm_stock_audit_out audit left join crm_staff as proposer on audit.proposer = proposer.id left join crm_staff as auditor on audit.auditor = auditor.id  WHERE `is_del` = 0 AND `type` = '2' AND `warehouse_number` IN ('BJFY001','C0001','C0002','FY001','FY002','K001','K002','K003','K004','K010','K015','K020','K20','K22','K23','SH001','XC005','XC006','YJ001','YS001','ZC001','ZC002','ZC003','ZC004','ZC005','ZZK001') ORDER BY update_time desc LIMIT 0,10   [ RunTime:0.0060s ]

[ 2018-09-21T09:08:15+08:00 ] ::1 /Dwin/Stock/showStockOutAuditList
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0100s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0160s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%stock/showstockoutauditlist%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0080s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('出库申请审核页面',NULL,'394','::1','stock/showstockoutauditlist','1537492095','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"audit_order_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"action_order_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"warehouse_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"num\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"cate_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"audit_status\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"audit_tips\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"update_time\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"1\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"repertory_id\":\"\"}') [ RunTime:0.0720s ]
INFO: [ view_parse ] --START--
INFO: [ template_filter ] --START--
INFO: Run Behavior\ContentReplaceBehavior [ RunTime:0.000000s ]
INFO: [ template_filter ] --END-- [ RunTime:0.000000s ]
NOTIC: [8] Undefined variable: repertoryList F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Runtime\Cache\Dwin\cc8a0864d798723f9e71b298515ea045.php 第 41 行.
INFO: Run Behavior\ParseTemplateBehavior [ RunTime:0.031002s ]
INFO: [ view_parse ] --END-- [ RunTime:0.031002s ]
INFO: [ view_filter ] --START--
INFO: Run Behavior\WriteHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ view_filter ] --END-- [ RunTime:0.001000s ]
INFO: [ app_end ] --START--
INFO: Run Behavior\ShowPageTraceBehavior [ RunTime:0.001000s ]
INFO: [ app_end ] --END-- [ RunTime:0.001000s ]

[ 2018-09-21T09:08:17+08:00 ] ::1 /Dwin/Stock/showRecord
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001001s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001001s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0090s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0140s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0200s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%stock/showrecord%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0090s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('展示所有入库记录',NULL,'394','::1','stock/showrecord','1537492097','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"audit_order_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"warehouse_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"num\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"cate_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"proposer_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"auditor_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"audit_tips\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"action_order_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"update_time\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"audit_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"10\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"repertory_id\":\"\",\"status\":\"1,2\"}') [ RunTime:0.0510s ]
SQL: SHOW COLUMNS FROM `crm_repertorylist` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_auth_role` [ RunTime:0.0070s ]
SQL: SELECT MAX(stock_level) AS max FROM crm_auth_role WHERE FIND_IN_SET('394',staff_ids) [ RunTime:0.0030s ]
SQL: SELECT 
                        rep_id,repertory_name 
                        FROM crm_repertorylist 
                        WHERE 
                          display_level <= 3 
                          or 
                          find_in_set(394, warehouse_manager_id) 
                          or
                          find_in_set(394, logistics_staff_id) [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_stock_audit` [ RunTime:0.0490s ]
SQL: SELECT COUNT(*) AS tp_count FROM `crm_stock_audit` WHERE `type` IN ('1') AND `is_del` = 0 AND `audit_status` IN ('1','2') AND `warehouse_number` IN ('BJFY001','C0001','C0002','FY001','FY002','K001','K002','K003','K004','K010','K015','K020','K20','K22','K23','SH001','XC005','XC006','YJ001','YS001','ZC001','ZC002','ZC003','ZC004','ZC005','ZZK001') LIMIT 1   [ RunTime:0.3100s ]
NOTIC: [8] Undefined index: vueData F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Controller\StockController.class.php 第 1646 行.
SQL: SELECT COUNT(*) AS tp_count FROM `crm_stock_audit` WHERE `type` IN ('1') AND `is_del` = 0 AND `audit_status` IN ('1','2') AND `warehouse_number` IN ('BJFY001','C0001','C0002','FY001','FY002','K001','K002','K003','K004','K010','K015','K020','K20','K22','K23','SH001','XC005','XC006','YJ001','YS001','ZC001','ZC002','ZC003','ZC004','ZC005','ZZK001') LIMIT 1   [ RunTime:0.0880s ]
SQL: SELECT audit.* FROM crm_stock_audit audit WHERE `type` IN ('1') AND `is_del` = 0 AND `audit_status` IN ('1','2') AND `warehouse_number` IN ('BJFY001','C0001','C0002','FY001','FY002','K001','K002','K003','K004','K010','K015','K020','K20','K22','K23','SH001','XC005','XC006','YJ001','YS001','ZC001','ZC002','ZC003','ZC004','ZC005','ZZK001') ORDER BY update_time desc LIMIT 0,10   [ RunTime:0.0980s ]

[ 2018-09-21T09:08:19+08:00 ] ::1 /Dwin/Stock/showRecord
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0210s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%stock/showrecord%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0080s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('展示所有入库记录',NULL,'394','::1','stock/showrecord','1537492099','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"audit_order_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"warehouse_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"num\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"cate_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"proposer_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"auditor_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"audit_tips\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"action_order_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"update_time\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"audit_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"10\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"repertory_id\":\"\",\"status\":\"1,2\"}') [ RunTime:0.0540s ]
SQL: SHOW COLUMNS FROM `crm_repertorylist` [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_auth_role` [ RunTime:0.0140s ]
SQL: SELECT MAX(stock_level) AS max FROM crm_auth_role WHERE FIND_IN_SET('394',staff_ids) [ RunTime:0.0050s ]
SQL: SELECT 
                        rep_id,repertory_name 
                        FROM crm_repertorylist 
                        WHERE 
                          display_level <= 3 
                          or 
                          find_in_set(394, warehouse_manager_id) 
                          or
                          find_in_set(394, logistics_staff_id) [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_stock_audit` [ RunTime:0.0090s ]
SQL: SELECT COUNT(*) AS tp_count FROM `crm_stock_audit` WHERE `type` IN ('1') AND `is_del` = 0 AND `audit_status` IN ('1','2') AND `warehouse_number` IN ('BJFY001','C0001','C0002','FY001','FY002','K001','K002','K003','K004','K010','K015','K020','K20','K22','K23','SH001','XC005','XC006','YJ001','YS001','ZC001','ZC002','ZC003','ZC004','ZC005','ZZK001') LIMIT 1   [ RunTime:0.0850s ]
NOTIC: [8] Undefined index: vueData F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Controller\StockController.class.php 第 1646 行.
SQL: SELECT COUNT(*) AS tp_count FROM `crm_stock_audit` WHERE `type` IN ('1') AND `is_del` = 0 AND `audit_status` IN ('1','2') AND `warehouse_number` IN ('BJFY001','C0001','C0002','FY001','FY002','K001','K002','K003','K004','K010','K015','K020','K20','K22','K23','SH001','XC005','XC006','YJ001','YS001','ZC001','ZC002','ZC003','ZC004','ZC005','ZZK001') LIMIT 1   [ RunTime:0.0910s ]
SQL: SELECT audit.* FROM crm_stock_audit audit WHERE `type` IN ('1') AND `is_del` = 0 AND `audit_status` IN ('1','2') AND `warehouse_number` IN ('BJFY001','C0001','C0002','FY001','FY002','K001','K002','K003','K004','K010','K015','K020','K20','K22','K23','SH001','XC005','XC006','YJ001','YS001','ZC001','ZC002','ZC003','ZC004','ZC005','ZZK001') ORDER BY update_time desc LIMIT 0,10   [ RunTime:0.0980s ]

[ 2018-09-21T09:08:20+08:00 ] ::1 /Dwin/Stock/auditList
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0090s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0130s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%stock/auditlist%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0170s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('显示所有入库申请',NULL,'394','::1','stock/auditlist','1537492100','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"audit_order_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"warehouse_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"num\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"type\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"cate_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"audit_status\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"audit_tips\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"update_time\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"false\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"10\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"type\":\"1\",\"audit_status\":\"1\"}') [ RunTime:0.0910s ]
SQL: SHOW COLUMNS FROM `crm_stock_audit` [ RunTime:0.0110s ]
SQL: SELECT COUNT(*) AS tp_count FROM `crm_stock_audit` LIMIT 1   [ RunTime:0.0320s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_stock_audit audit left join crm_stock_io_cate as cate on audit.cate = cate.id left join crm_staff as proposer on audit.proposer = proposer.id left join crm_staff as auditor on audit.auditor = auditor.id  WHERE `auditor` = '394' AND audit.type = '1' AND `audit_status` = '1' AND `is_del` = 0 LIMIT 1   [ RunTime:0.0640s ]
SQL: SELECT audit.* FROM crm_stock_audit audit WHERE `auditor` = 394 AND audit.type = '1' AND `audit_status` = '1' AND `is_del` = 0 ORDER BY audit.update_time desc LIMIT 0,10   [ RunTime:0.0510s ]

[ 2018-09-21T09:08:24+08:00 ] ::1 /Dwin/Production/productionPlan
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.002000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.003000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0080s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0110s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionplan%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0150s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('展示生产计划',NULL,'394','::1','production/productionplan','1537492104','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_order\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"staff_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_cate_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"create_time\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"delivery_time\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"yqts\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_plan_rest_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"production_status\":\"\",\"production_line\":\"\"}') [ RunTime:0.0410s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_auth_role` [ RunTime:0.0090s ]
SQL: SELECT `role_id`,`staff_ids` FROM `crm_auth_role` WHERE `role_id` IN (50)  [ RunTime:0.0070s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0110s ]
SQL: SELECT COUNT(*) AS tp_count FROM `crm_production_plan` WHERE `production_status` IN ('1','2','3','4') AND `is_del` = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') LIMIT 1   [ RunTime:0.0210s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_plan plan WHERE `production_status` IN ('1','2','3','4') AND `is_del` = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') LIMIT 1   [ RunTime:0.0270s ]
SQL: SELECT plan.id,`production_order`,`staff_name`,`stock_cate_name`,plan.product_name,`production_line_name`,`production_plan_number`,plan.production_number,from_unixtime(create_time,'%y-%m-%d') create_time,from_unixtime(delivery_time,'%y-%m-%d') delivery_time,`production_status`,ifnull(plan.tips,'无') tips,delivery_time yqts,sum(stock.stock_number) stock_number,sum(stock.o_audit) o_audit,sum(product.production_number) product_num,sum(product.production_number) production_plan_rest_num FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id  WHERE `production_status` IN ('1','2','3','4') AND `is_del` = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') GROUP BY plan.id ORDER BY create_time desc,plan.id desc LIMIT 0,10   [ RunTime:0.0360s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0110s ]
SQL: SELECT SUM(production_plan_rest_number) AS tp_sum FROM `crm_production_plan` WHERE `product_name` = '10.4寸保护膜' AND `production_line_name` = 'SMT线' AND `production_status` = 3 LIMIT 1   [ RunTime:0.0170s ]

[ 2018-09-21T09:08:26+08:00 ] ::1 /Dwin/Production/productionIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0060s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0100s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0170s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionindex','1537492106','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"product_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"actual_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"create_time\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"delivery_time\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_order\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"staff_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_cate_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"production_line\":\"\"}') [ RunTime:0.0720s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0180s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0020s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0110s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_plan plan WHERE `production_line_name` IN ('生产线','SMT线','装配线','生产线') AND plan.is_del = 0 AND plan.production_status = 3 AND plan.scheduled_status IN ('0','1') LIMIT 1   [ RunTime:0.0180s ]
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE `production_line_name` IN ('生产线','SMT线','装配线','生产线') AND plan.is_del = 0 AND plan.production_status = 3 AND plan.scheduled_status IN ('0','1') GROUP BY plan.id ORDER BY staff_name desc LIMIT 0,10   [ RunTime:0.0770s ]
SQL: SHOW COLUMNS FROM `crm_material_bom` [ RunTime:0.0500s ]
SQL: SELECT `bom_type_name`,`product_no`,`bom_id`,`id` FROM `crm_material_bom` WHERE `product_id` = '10858' AND `bom_status` = 2 AND `is_del` = 0  [ RunTime:0.0030s ]
SQL: SELECT `bom_type_name`,`product_no`,`bom_id`,`id` FROM `crm_material_bom` WHERE `product_id` = '10612' AND `bom_status` = 2 AND `is_del` = 0  [ RunTime:0.0040s ]
SQL: SELECT `bom_type_name`,`product_no`,`bom_id`,`id` FROM `crm_material_bom` WHERE `product_id` = '10912' AND `bom_status` = 2 AND `is_del` = 0  [ RunTime:0.0130s ]
SQL: SELECT `bom_type_name`,`product_no`,`bom_id`,`id` FROM `crm_material_bom` WHERE `product_id` = '10709' AND `bom_status` = 2 AND `is_del` = 0  [ RunTime:0.0140s ]
SQL: SELECT `bom_type_name`,`product_no`,`bom_id`,`id` FROM `crm_material_bom` WHERE `product_id` = '10846' AND `bom_status` = 2 AND `is_del` = 0  [ RunTime:0.0040s ]
SQL: SELECT `bom_type_name`,`product_no`,`bom_id`,`id` FROM `crm_material_bom` WHERE `product_id` = '15077' AND `bom_status` = 2 AND `is_del` = 0  [ RunTime:0.0030s ]
SQL: SELECT `bom_type_name`,`product_no`,`bom_id`,`id` FROM `crm_material_bom` WHERE `product_id` = '15077' AND `bom_status` = 2 AND `is_del` = 0  [ RunTime:0.0110s ]
SQL: SELECT `bom_type_name`,`product_no`,`bom_id`,`id` FROM `crm_material_bom` WHERE `product_id` = '15414' AND `bom_status` = 2 AND `is_del` = 0  [ RunTime:0.0040s ]
SQL: SELECT `bom_type_name`,`product_no`,`bom_id`,`id` FROM `crm_material_bom` WHERE `product_id` = '617' AND `bom_status` = 2 AND `is_del` = 0  [ RunTime:0.0050s ]
SQL: SELECT `bom_type_name`,`product_no`,`bom_id`,`id` FROM `crm_material_bom` WHERE `product_id` = '1376' AND `bom_status` = 2 AND `is_del` = 0  [ RunTime:0.0030s ]

[ 2018-09-21T09:08:28+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.003000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.003000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0120s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0190s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537492108','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0680s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0080s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0100s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0030s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.1260s ]

[ 2018-09-21T09:08:39+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0100s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0100s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537492118','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"2\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"1\"}') [ RunTime:0.0850s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0080s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '1' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0030s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '1' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0210s ]

[ 2018-09-21T09:08:44+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0100s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0250s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537492123','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100240\"}') [ RunTime:0.0810s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0100s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0080s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0190s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100240'  [ RunTime:0.0060s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('109855') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0310s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100240'  [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0080s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100240 LIMIT 1   [ RunTime:0.0050s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0310s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0110s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100240'  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10036','10038','10042') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0040s ]

[ 2018-09-21T09:10:33+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0140s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0110s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0310s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0140s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537492232','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"3\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"asc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"1\"}') [ RunTime:0.5150s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0070s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '1' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0070s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '1' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num asc LIMIT 0,10   [ RunTime:0.0160s ]

[ 2018-09-21T09:10:34+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0090s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0120s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0290s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0120s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537492234','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"4\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"asc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"2\"}') [ RunTime:0.0380s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0090s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0090s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0130s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '2' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0060s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '2' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num asc LIMIT 0,10   [ RunTime:0.0200s ]

[ 2018-09-21T09:17:20+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0130s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0080s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0240s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0110s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537492640','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\"}') [ RunTime:0.0820s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0120s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0070s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0210s ]
NOTIC: [8] Undefined index: status F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Controller\ProductionController.class.php 第 1164 行.
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = null AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0060s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = null AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY start_t desc LIMIT 0,10   [ RunTime:0.0260s ]

[ 2018-09-21T09:17:38+08:00 ] ::1 /Dwin/Production/productionPlan
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0150s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0020s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0080s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0280s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionplan%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0150s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('展示生产计划',NULL,'394','::1','production/productionplan','1537492658','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_order\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"staff_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_cate_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"create_time\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"delivery_time\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"yqts\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_plan_rest_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"production_status\":\"\",\"production_line\":\"\"}') [ RunTime:0.0730s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0120s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_auth_role` [ RunTime:0.0110s ]
SQL: SELECT `role_id`,`staff_ids` FROM `crm_auth_role` WHERE `role_id` IN (50)  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0220s ]
SQL: SELECT COUNT(*) AS tp_count FROM `crm_production_plan` WHERE `production_status` IN ('1','2','3','4') AND `is_del` = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') LIMIT 1   [ RunTime:0.0230s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_plan plan WHERE `production_status` IN ('1','2','3','4') AND `is_del` = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') LIMIT 1   [ RunTime:0.0160s ]
SQL: SELECT plan.id,`production_order`,`staff_name`,`stock_cate_name`,plan.product_name,`production_line_name`,`production_plan_number`,plan.production_number,from_unixtime(create_time,'%y-%m-%d') create_time,from_unixtime(delivery_time,'%y-%m-%d') delivery_time,`production_status`,ifnull(plan.tips,'无') tips,delivery_time yqts,sum(stock.stock_number) stock_number,sum(stock.o_audit) o_audit,sum(product.production_number) product_num,sum(product.production_number) production_plan_rest_num FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id  WHERE `production_status` IN ('1','2','3','4') AND `is_del` = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') GROUP BY plan.id ORDER BY create_time desc,plan.id desc LIMIT 0,10   [ RunTime:0.0410s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0120s ]
SQL: SELECT SUM(production_plan_rest_number) AS tp_sum FROM `crm_production_plan` WHERE `product_name` = '10.4寸保护膜' AND `production_line_name` = 'SMT线' AND `production_status` = 3 LIMIT 1   [ RunTime:0.0370s ]

[ 2018-09-21T09:17:40+08:00 ] ::1 /Dwin/Production/productionTaskIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0120s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0100s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0150s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productiontaskindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0120s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productiontaskindex','1537492660','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"task_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"task_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"task_line_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"task_group_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"task_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"complete_quantity\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"actual_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"0,1,2\"}') [ RunTime:0.0510s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0170s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0060s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0080s ]
NOTIC: [8] Undefined index: a.pid F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\ProductionLineModel.class.php 第 69 行.
SQL: SELECT a.id,a.production_line group_name,a.pid,a.manufacturability group_ability,b.production_line line_name FROM crm_production_line a LEFT JOIN crm_production_line b ON b.id = a.pid  WHERE a.is_del = 0 AND a.pid <> 0 LIMIT 0,100   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0140s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT task.id,from_unixtime(task.create_time) create_time,task.task_id,task.product_no,task.product_id,material.warehouse_id default_rep_id,task.task_number,task.task_line,task.task_group,task.production_type,from_unixtime(task.task_start_time,'%y-%m-%d') start_t,from_unixtime(task.task_end_time,'%y-%m-%d') end_t,task.production_status,sum(ifnull(sip.in_num,0)) complete_quantity,ifnull(from_unixtime(task.actual_end_time,'%y-%m-%d'),' ') actual_t,task.tips,task.create_id,task.create_name,line1.production_line task_line_name,line2.production_line task_group_name,produce_order.production_code order_code FROM crm_production_task task LEFT JOIN crm_production_line line1 ON line1.id = task_line LEFT JOIN crm_production_line line2 ON line2.id = task_group LEFT JOIN crm_material material ON material.product_id = task.product_id LEFT JOIN crm_production_order produce_order ON task.order_pid = produce_order.id LEFT JOIN (select a.*,sum(ifnull(b.num,0)) in_num from crm_stock_in_production a left join crm_stock_in_record b on a.id = b.source_id group by a.id) sip ON task.id = sip.source_id and sip.is_del = 0  WHERE task.task_group IN ('100','101','102','103','104','105','106','107','108') AND task.production_status IN ('0','1','2') AND task.is_del = 0 GROUP BY task.id ORDER BY start_t desc LIMIT 0,10   [ RunTime:0.0120s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_task task WHERE task.task_group IN ('100','101','102','103','104','105','106','107','108') AND task.production_status IN ('0','1','2') LIMIT 1   [ RunTime:0.0090s ]

[ 2018-09-21T09:17:44+08:00 ] ::1 /Dwin/Production/productionTaskIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0130s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0090s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0170s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productiontaskindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0110s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productiontaskindex','1537492664','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"task_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"task_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"task_line_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"task_group_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"task_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"complete_quantity\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"actual_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"0,1,2\"}') [ RunTime:0.0750s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0090s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0120s ]
NOTIC: [8] Undefined index: a.pid F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\ProductionLineModel.class.php 第 69 行.
SQL: SELECT a.id,a.production_line group_name,a.pid,a.manufacturability group_ability,b.production_line line_name FROM crm_production_line a LEFT JOIN crm_production_line b ON b.id = a.pid  WHERE a.is_del = 0 AND a.pid <> 0 LIMIT 0,100   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0130s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT task.id,from_unixtime(task.create_time) create_time,task.task_id,task.product_no,task.product_id,material.warehouse_id default_rep_id,task.task_number,task.task_line,task.task_group,task.production_type,from_unixtime(task.task_start_time,'%y-%m-%d') start_t,from_unixtime(task.task_end_time,'%y-%m-%d') end_t,task.production_status,sum(ifnull(sip.in_num,0)) complete_quantity,ifnull(from_unixtime(task.actual_end_time,'%y-%m-%d'),' ') actual_t,task.tips,task.create_id,task.create_name,line1.production_line task_line_name,line2.production_line task_group_name,produce_order.production_code order_code FROM crm_production_task task LEFT JOIN crm_production_line line1 ON line1.id = task_line LEFT JOIN crm_production_line line2 ON line2.id = task_group LEFT JOIN crm_material material ON material.product_id = task.product_id LEFT JOIN crm_production_order produce_order ON task.order_pid = produce_order.id LEFT JOIN (select a.*,sum(ifnull(b.num,0)) in_num from crm_stock_in_production a left join crm_stock_in_record b on a.id = b.source_id group by a.id) sip ON task.id = sip.source_id and sip.is_del = 0  WHERE task.task_group IN ('100','101','102','103','104','105','106','107','108') AND task.production_status IN ('0','1','2') AND task.is_del = 0 GROUP BY task.id ORDER BY start_t desc LIMIT 0,10   [ RunTime:0.0050s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_task task WHERE task.task_group IN ('100','101','102','103','104','105','106','107','108') AND task.production_status IN ('0','1','2') LIMIT 1   [ RunTime:0.0090s ]

[ 2018-09-21T09:17:49+08:00 ] ::1 /Dwin/Production/productionPlan
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0090s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0180s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0240s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0210s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionplan%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0140s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('展示生产计划',NULL,'394','::1','production/productionplan','1537492668','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_order\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"staff_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_cate_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"create_time\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"delivery_time\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"yqts\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_plan_rest_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"production_status\":\"\",\"production_line\":\"\"}') [ RunTime:0.0660s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0330s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0130s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_auth_role` [ RunTime:0.0140s ]
SQL: SELECT `role_id`,`staff_ids` FROM `crm_auth_role` WHERE `role_id` IN (50)  [ RunTime:0.0140s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0100s ]
SQL: SELECT COUNT(*) AS tp_count FROM `crm_production_plan` WHERE `production_status` IN ('1','2','3','4') AND `is_del` = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') LIMIT 1   [ RunTime:0.0270s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_plan plan WHERE `production_status` IN ('1','2','3','4') AND `is_del` = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') LIMIT 1   [ RunTime:0.0200s ]
SQL: SELECT plan.id,`production_order`,`staff_name`,`stock_cate_name`,plan.product_name,`production_line_name`,`production_plan_number`,plan.production_number,from_unixtime(create_time,'%y-%m-%d') create_time,from_unixtime(delivery_time,'%y-%m-%d') delivery_time,`production_status`,ifnull(plan.tips,'无') tips,delivery_time yqts,sum(stock.stock_number) stock_number,sum(stock.o_audit) o_audit,sum(product.production_number) product_num,sum(product.production_number) production_plan_rest_num FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id  WHERE `production_status` IN ('1','2','3','4') AND `is_del` = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') GROUP BY plan.id ORDER BY create_time desc,plan.id desc LIMIT 0,10   [ RunTime:0.0970s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0110s ]
SQL: SELECT SUM(production_plan_rest_number) AS tp_sum FROM `crm_production_plan` WHERE `product_name` = '10.4寸保护膜' AND `production_line_name` = 'SMT线' AND `production_status` = 3 LIMIT 1   [ RunTime:0.0280s ]

[ 2018-09-21T09:17:53+08:00 ] ::1 /Dwin/Production/productionIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.003000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.004001s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0090s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0260s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0260s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0130s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionindex','1537492673','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"product_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"actual_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"create_time\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"delivery_time\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_order\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"staff_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_cate_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"production_line\":\"\"}') [ RunTime:0.1080s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0110s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0050s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0130s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_plan plan WHERE `production_line_name` IN ('生产线','SMT线','装配线','生产线') AND plan.is_del = 0 AND plan.production_status = 3 AND plan.scheduled_status IN ('0','1') LIMIT 1   [ RunTime:0.0190s ]
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE `production_line_name` IN ('生产线','SMT线','装配线','生产线') AND plan.is_del = 0 AND plan.production_status = 3 AND plan.scheduled_status IN ('0','1') GROUP BY plan.id ORDER BY staff_name desc LIMIT 0,10   [ RunTime:0.0680s ]
SQL: SHOW COLUMNS FROM `crm_material_bom` [ RunTime:0.0080s ]
SQL: SELECT `bom_type_name`,`product_no`,`bom_id`,`id` FROM `crm_material_bom` WHERE `product_id` = '10858' AND `bom_status` = 2 AND `is_del` = 0  [ RunTime:0.0070s ]
SQL: SELECT `bom_type_name`,`product_no`,`bom_id`,`id` FROM `crm_material_bom` WHERE `product_id` = '10612' AND `bom_status` = 2 AND `is_del` = 0  [ RunTime:0.0050s ]
SQL: SELECT `bom_type_name`,`product_no`,`bom_id`,`id` FROM `crm_material_bom` WHERE `product_id` = '10912' AND `bom_status` = 2 AND `is_del` = 0  [ RunTime:0.0050s ]
SQL: SELECT `bom_type_name`,`product_no`,`bom_id`,`id` FROM `crm_material_bom` WHERE `product_id` = '10709' AND `bom_status` = 2 AND `is_del` = 0  [ RunTime:0.0110s ]
SQL: SELECT `bom_type_name`,`product_no`,`bom_id`,`id` FROM `crm_material_bom` WHERE `product_id` = '10846' AND `bom_status` = 2 AND `is_del` = 0  [ RunTime:0.0060s ]
SQL: SELECT `bom_type_name`,`product_no`,`bom_id`,`id` FROM `crm_material_bom` WHERE `product_id` = '617' AND `bom_status` = 2 AND `is_del` = 0  [ RunTime:0.0120s ]
SQL: SELECT `bom_type_name`,`product_no`,`bom_id`,`id` FROM `crm_material_bom` WHERE `product_id` = '1376' AND `bom_status` = 2 AND `is_del` = 0  [ RunTime:0.0050s ]
SQL: SELECT `bom_type_name`,`product_no`,`bom_id`,`id` FROM `crm_material_bom` WHERE `product_id` = '15114' AND `bom_status` = 2 AND `is_del` = 0  [ RunTime:0.0100s ]
SQL: SELECT `bom_type_name`,`product_no`,`bom_id`,`id` FROM `crm_material_bom` WHERE `product_id` = '15077' AND `bom_status` = 2 AND `is_del` = 0  [ RunTime:0.0090s ]
SQL: SELECT `bom_type_name`,`product_no`,`bom_id`,`id` FROM `crm_material_bom` WHERE `product_id` = '15414' AND `bom_status` = 2 AND `is_del` = 0  [ RunTime:0.0040s ]

[ 2018-09-21T09:17:58+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.002000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.003000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0190s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0140s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0280s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0130s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0080s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537492678','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0650s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0120s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0050s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0080s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0040s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0210s ]

[ 2018-09-21T09:18:01+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001001s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001001s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0120s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0080s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537492681','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100236\"}') [ RunTime:0.0500s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0090s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0230s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0200s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0160s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0080s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100236'  [ RunTime:0.0130s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('109855') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0080s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100236'  [ RunTime:0.0140s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10130','10132','10266','10301','10302','10303','10307') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0080s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100236 LIMIT 1   [ RunTime:0.0170s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0130s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100236'  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10043') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0060s ]

[ 2018-09-21T09:21:55+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0160s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0080s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0270s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.3030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0080s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537492915','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"2\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.3320s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0190s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0070s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0140s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0030s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0220s ]

[ 2018-09-21T09:41:50+08:00 ] ::1 /Dwin/Public/loginOk
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_staff` [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_staff` [ RunTime:0.0080s ]
SQL: SELECT `id`,`name`,`pwd`,`errorcount`,`lastlogintime`,`loginaddr`,`loginstatus` FROM `crm_staff` WHERE `username` = 'zeng' ORDER BY id LIMIT 1   [ RunTime:0.0040s ]
SQL: SELECT `id`,`name`,`pwd`,`errorcount`,`lastlogintime`,`loginaddr`,`loginstatus` FROM `crm_staff` WHERE `id` = '394' ORDER BY id LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_staff` [ RunTime:0.0130s ]
SQL: SELECT * FROM `crm_staff` WHERE `id` = '394'  [ RunTime:0.0080s ]
SQL: UPDATE `crm_staff` SET `lastlogintime`='1537494110',`loginaddr`='::1',`errorcount`='0' WHERE `id` = '394' [ RunTime:0.0640s ]
SQL: show full fields from crm_staff [ RunTime:0.0160s ]
NOTIC: [8] Array to string conversion F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\ThinkPHP\Library\Think\Model.class.php 第 590 行.
NOTIC: [8] Array to string conversion F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\ThinkPHP\Library\Think\Model.class.php 第 590 行.
SQL: SELECT crm_staff.id user_id,name user_name,roleid role_id,rule_ids rules,deptid dept_id,post_id position FROM `crm_staff` WHERE `username` = 'zeng' ORDER BY id LIMIT 1   [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_auth_role` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_auth_role` WHERE ( FIND_IN_SET(394,staff_ids) )  [ RunTime:0.0050s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
NOTIC: [8] Undefined index: deptid F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Controller\PublicController.class.php 第 153 行.

[ 2018-09-21T09:41:51+08:00 ] ::1 /Dwin/Index/getOrderMsg
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0130s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0090s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0190s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%index/getordermsg%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0110s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('系统检测不合格订单',NULL,'394','::1','index/getordermsg','1537494111','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','[]') [ RunTime:0.0400s ]
SQL: SHOW COLUMNS FROM `crm_orderform` [ RunTime:0.0090s ]
SQL: SELECT `cus_name` FROM `crm_orderform` WHERE `picid` = '394' AND `check_status` = '2' AND `is_del` = 0  [ RunTime:0.0250s ]

[ 2018-09-21T09:41:52+08:00 ] ::1 /Dwin/Index/checkPostInfo
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0170s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0370s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0240s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%index/checkpostinfo%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0100s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('系统检测菜单权限',NULL,'394','::1','index/checkpostinfo','1537494112','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"flag\":\"1\"}') [ RunTime:0.0660s ]

[ 2018-09-21T09:42:23+08:00 ] ::1 /Dwin/Production/productionPlan
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0100s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0110s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0390s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionplan%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0250s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('展示生产计划',NULL,'394','::1','production/productionplan','1537494142','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_order\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"staff_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_cate_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"create_time\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"delivery_time\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"yqts\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_plan_rest_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"production_status\":\"\",\"production_line\":\"\"}') [ RunTime:0.6940s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0280s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0120s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_auth_role` [ RunTime:0.0170s ]
SQL: SELECT `role_id`,`staff_ids` FROM `crm_auth_role` WHERE `role_id` IN (50)  [ RunTime:0.0090s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0320s ]
SQL: SELECT COUNT(*) AS tp_count FROM `crm_production_plan` WHERE `production_status` IN ('1','2','3','4') AND `is_del` = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') LIMIT 1   [ RunTime:0.0200s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_plan plan WHERE `production_status` IN ('1','2','3','4') AND `is_del` = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') LIMIT 1   [ RunTime:0.0270s ]
SQL: SELECT plan.id,`production_order`,`staff_name`,`stock_cate_name`,plan.product_name,`production_line_name`,`production_plan_number`,plan.production_number,from_unixtime(create_time,'%y-%m-%d') create_time,from_unixtime(delivery_time,'%y-%m-%d') delivery_time,`production_status`,ifnull(plan.tips,'无') tips,delivery_time yqts,sum(stock.stock_number) stock_number,sum(stock.o_audit) o_audit,sum(product.production_number) product_num,sum(product.production_number) production_plan_rest_num FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id  WHERE `production_status` IN ('1','2','3','4') AND `is_del` = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') GROUP BY plan.id ORDER BY create_time desc,plan.id desc LIMIT 0,10   [ RunTime:0.1240s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.2740s ]
SQL: SELECT SUM(production_plan_rest_number) AS tp_sum FROM `crm_production_plan` WHERE `product_name` = '10.4寸保护膜' AND `production_line_name` = 'SMT线' AND `production_status` = 3 LIMIT 1   [ RunTime:0.0760s ]

[ 2018-09-21T09:42:25+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0120s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0090s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0400s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0170s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537494145','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.1600s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0250s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0140s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0180s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0070s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0220s ]

[ 2018-09-21T09:42:32+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0180s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0160s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0180s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0860s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0200s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0110s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537494151','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100241\"}') [ RunTime:0.0690s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0150s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.3110s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0170s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0220s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0100s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100241'  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0070s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100241'  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0400s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100241 LIMIT 1   [ RunTime:0.0130s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '10071' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0130s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100241'  [ RunTime:0.0130s ]

[ 2018-09-21T09:44:01+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.1500s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0320s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0220s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:1.7981s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.2950s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.2250s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537494237','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"2\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"1\"}') [ RunTime:2.9992s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0250s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0310s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0380s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '1' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0250s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '1' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.8791s ]

[ 2018-09-21T09:44:03+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0170s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0230s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:1.1811s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0780s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537494243','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"3\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"2\",\"statusLimit\":\"\",\"status\":\"1\"}') [ RunTime:0.1220s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0530s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0440s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0270s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '1' AND ord.production_line IN ('2') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0140s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '1' AND ord.production_line IN ('2') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0450s ]

[ 2018-09-21T09:44:04+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0110s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0170s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0120s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0360s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0160s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537494243','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"4\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"2\",\"statusLimit\":\"0,1\",\"status\":\"1\"}') [ RunTime:0.0810s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0170s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0200s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '1' AND ord.production_line IN ('2') AND ord.production_status IN ('0','1') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0040s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '1' AND ord.production_line IN ('2') AND ord.production_status IN ('0','1') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0170s ]

[ 2018-09-21T09:44:04+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0150s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0090s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0220s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0120s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537494244','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"5\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"2\",\"statusLimit\":\"0,1\",\"status\":\"2\"}') [ RunTime:0.0420s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0160s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0130s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '2' AND ord.production_line IN ('2') AND ord.production_status IN ('0','1') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0060s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '2' AND ord.production_line IN ('2') AND ord.production_status IN ('0','1') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0180s ]

[ 2018-09-21T09:44:04+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0080s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0110s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0310s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0150s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537494244','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"6\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"2\",\"statusLimit\":\"0,1\",\"status\":\"\"}') [ RunTime:0.0460s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0090s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0050s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0210s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('2') AND ord.production_status IN ('0','1') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0100s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('2') AND ord.production_status IN ('0','1') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0230s ]

[ 2018-09-21T09:44:04+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0090s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0160s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0100s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537494244','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"7\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"2\",\"statusLimit\":\"0,1\",\"status\":\"0\"}') [ RunTime:0.0460s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0100s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0090s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '0' AND ord.production_line IN ('2') AND ord.production_status IN ('0','1') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0050s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '0' AND ord.production_line IN ('2') AND ord.production_status IN ('0','1') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0170s ]

[ 2018-09-21T09:45:42+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.003000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0100s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0130s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0130s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0090s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537494342','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100214\"}') [ RunTime:0.0730s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0130s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0150s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0130s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0130s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100214'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('110312','109401') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0090s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100214'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10104','10105','10106','10107','10108','10109','10110','10111','10112','10126','10128','10129','10264','10265','10308','10309','10310') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0150s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100214 LIMIT 1   [ RunTime:0.0200s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0090s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100214'  [ RunTime:0.0080s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10051','10087') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0050s ]

[ 2018-09-21T09:48:39+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:1.0071s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.3940s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.8881s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:2.1011s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0160s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537494519','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"8\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"2\",\"statusLimit\":\"0,1\",\"status\":\"0\"}') [ RunTime:0.0700s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0090s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0130s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '0' AND ord.production_line IN ('2') AND ord.production_status IN ('0','1') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0080s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '0' AND ord.production_line IN ('2') AND ord.production_status IN ('0','1') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0160s ]

[ 2018-09-21T09:48:40+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0060s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0110s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0240s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0090s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537494520','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0710s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0100s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0100s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0080s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0060s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0140s ]

[ 2018-09-21T09:58:56+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:2.1381s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.3140s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.9431s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0260s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0360s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537495134','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.1090s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0510s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0580s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0690s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0460s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:1.0591s ]

[ 2018-09-21T09:59:21+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0750s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0300s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0250s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:1.2681s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.1200s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.1030s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537495142','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100236\"}') [ RunTime:0.0820s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0610s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0260s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0490s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.8650s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.4590s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.1630s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0790s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0620s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100236'  [ RunTime:0.0610s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('109855') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.4600s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:2.7152s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100236'  [ RunTime:0.0100s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10130','10132','10266','10301','10302','10303','10307') AND task.is_del = 0 GROUP BY task.id  [ RunTime:4.5153s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:9.3575s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100236 LIMIT 1   [ RunTime:0.1040s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0550s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0270s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100236'  [ RunTime:0.0140s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10043') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0200s ]

[ 2018-09-21T09:59:23+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0300s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0190s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.1550s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0470s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0500s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537495162','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100214\"}') [ RunTime:0.0720s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0160s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0140s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0370s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0190s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0210s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0220s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0110s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100214'  [ RunTime:0.0110s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('110312','109401') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0460s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0540s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100214'  [ RunTime:0.0080s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10104','10105','10106','10107','10108','10109','10110','10111','10112','10126','10128','10129','10264','10265','10308','10309','10310') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.6280s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0330s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100214 LIMIT 1   [ RunTime:0.0250s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0480s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0260s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100214'  [ RunTime:0.0100s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10051','10087') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0110s ]

[ 2018-09-21T10:01:05+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.2810s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0380s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0530s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.8791s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0670s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0530s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537495264','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.3430s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0300s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0210s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.3230s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0270s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.3640s ]

[ 2018-09-21T10:01:45+08:00 ] ::1 /Dwin/Production/productionOrderIndex
ERR: 2006:MySQL server has gone away
 [ SQL语句 ] : SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271') 

[ 2018-09-21T10:03:06+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0160s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0210s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0270s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0110s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537495386','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0660s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0130s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0030s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0290s ]

[ 2018-09-21T10:03:10+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0160s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0490s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0840s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0120s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537495390','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100236\"}') [ RunTime:0.0720s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0120s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0130s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0160s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0220s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0170s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0150s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0190s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0100s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100236'  [ RunTime:0.0090s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('109855') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0120s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100236'  [ RunTime:0.0050s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10130','10132','10266','10301','10302','10303','10307') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0200s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100236 LIMIT 1   [ RunTime:0.0340s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0180s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100236'  [ RunTime:0.0080s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10043') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0050s ]

[ 2018-09-21T10:04:45+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0480s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0270s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0320s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.1210s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0800s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0370s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537495485','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0900s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0430s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0290s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0510s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0200s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0740s ]

[ 2018-09-21T10:04:58+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0100s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0210s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0410s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0210s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537495498','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0620s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0060s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0100s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0110s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0090s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0480s ]

[ 2018-09-21T10:05:36+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.1220s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.1350s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:8.5265s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.2630s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0090s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537495536','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100236\"}') [ RunTime:0.1070s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0130s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0070s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0180s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100236'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('109855') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0160s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0140s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100236'  [ RunTime:0.0090s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10130','10132','10266','10301','10302','10303','10307') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0120s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100236 LIMIT 1   [ RunTime:0.0080s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0140s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100236'  [ RunTime:0.0100s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10043') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0080s ]

[ 2018-09-21T10:06:24+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0260s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0150s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.1220s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0180s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0130s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537495584','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0460s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0210s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0070s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0210s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0070s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0230s ]

[ 2018-09-21T10:10:25+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0120s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0100s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0290s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537495824','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100236\"}') [ RunTime:0.0910s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0260s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0100s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0370s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0200s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0230s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0090s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100236'  [ RunTime:0.0060s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('109855') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0160s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100236'  [ RunTime:0.0260s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10130','10132','10266','10301','10302','10303','10307') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0110s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100236 LIMIT 1   [ RunTime:0.0140s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0240s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100236'  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10043') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0070s ]

[ 2018-09-21T10:10:46+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0140s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0280s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0250s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0090s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537495846','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0490s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0340s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0170s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0200s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0160s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0270s ]

[ 2018-09-21T10:10:47+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001001s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001001s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0100s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0390s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0110s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537495847','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100236\"}') [ RunTime:0.0970s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0240s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0130s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0190s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0080s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100236'  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('109855') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0120s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100236'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10130','10132','10266','10301','10302','10303','10307') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0110s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100236 LIMIT 1   [ RunTime:0.0120s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0150s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100236'  [ RunTime:0.0090s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10043') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0040s ]

[ 2018-09-21T10:10:56+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0130s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0080s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0290s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0090s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537495856','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0870s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0090s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0100s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0040s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0240s ]

[ 2018-09-21T10:10:58+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0190s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0300s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0090s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537495857','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100236\"}') [ RunTime:0.0930s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0090s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0110s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0330s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0230s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0210s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0160s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0090s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100236'  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('109855') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0110s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100236'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10130','10132','10266','10301','10302','10303','10307') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100236 LIMIT 1   [ RunTime:0.0310s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0120s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100236'  [ RunTime:0.0180s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10043') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0190s ]

[ 2018-09-21T10:14:02+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.002000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.003000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0100s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0160s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0120s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537496042','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0690s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0080s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0060s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0110s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0190s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0240s ]

[ 2018-09-21T10:14:05+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0360s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0090s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537496045','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100236\"}') [ RunTime:0.0900s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0190s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0170s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0180s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0150s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0070s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100236'  [ RunTime:0.0060s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('109855') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0090s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100236'  [ RunTime:0.0050s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10130','10132','10266','10301','10302','10303','10307') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0120s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100236 LIMIT 1   [ RunTime:0.0090s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0090s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100236'  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10043') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0030s ]

[ 2018-09-21T10:17:09+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0140s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0090s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0290s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.3130s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0120s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537496228','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.3790s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0080s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0200s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0040s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0240s ]

[ 2018-09-21T10:17:10+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001001s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002001s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0120s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0330s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0310s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0110s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537496230','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100236\"}') [ RunTime:0.0410s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0080s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0160s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0220s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0100s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100236'  [ RunTime:0.0050s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('109855') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0070s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100236'  [ RunTime:0.0070s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10130','10132','10266','10301','10302','10303','10307') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0080s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100236 LIMIT 1   [ RunTime:0.0080s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0070s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100236'  [ RunTime:0.0290s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10043') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0040s ]

[ 2018-09-21T10:18:40+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0110s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0230s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0360s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0120s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537496319','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0840s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0090s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0070s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0140s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0070s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0170s ]

[ 2018-09-21T10:18:43+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0120s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0140s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537496322','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100236\"}') [ RunTime:0.0720s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0100s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100236'  [ RunTime:0.0050s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('109855') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0120s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100236'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10130','10132','10266','10301','10302','10303','10307') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.3210s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0130s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100236 LIMIT 1   [ RunTime:0.0140s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0170s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100236'  [ RunTime:0.0090s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10043') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0150s ]

[ 2018-09-21T10:25:30+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0150s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0130s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0300s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537496730','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100214\"}') [ RunTime:0.0340s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0120s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0110s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0140s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100214'  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('110312','109401') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0110s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100214'  [ RunTime:0.0060s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10104','10105','10106','10107','10108','10109','10110','10111','10112','10126','10128','10129','10264','10265','10308','10309','10310') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0230s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0140s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100214 LIMIT 1   [ RunTime:0.0060s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0110s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100214'  [ RunTime:0.0120s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10051','10087') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0120s ]

[ 2018-09-21T10:25:31+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0140s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0240s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0160s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0540s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0410s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537496730','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100214\"}') [ RunTime:0.1060s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0080s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0220s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0070s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100214'  [ RunTime:0.0060s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('110312','109401') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0160s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100214'  [ RunTime:0.0120s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10104','10105','10106','10107','10108','10109','10110','10111','10112','10126','10128','10129','10264','10265','10308','10309','10310') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0080s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100214 LIMIT 1   [ RunTime:0.0160s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0070s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100214'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10051','10087') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0050s ]

[ 2018-09-21T10:25:32+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0110s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0080s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0130s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0090s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537496731','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100236\"}') [ RunTime:0.0750s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0080s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0220s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0130s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0120s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100236'  [ RunTime:0.0060s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('109855') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0070s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100236'  [ RunTime:0.0060s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10130','10132','10266','10301','10302','10303','10307') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0080s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100236 LIMIT 1   [ RunTime:0.0070s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0090s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100236'  [ RunTime:0.0050s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10043') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0050s ]

[ 2018-09-21T10:25:32+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0060s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0090s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0320s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0210s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537496732','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100236\"}') [ RunTime:0.0570s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0140s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0060s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0130s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0180s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0080s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100236'  [ RunTime:0.0060s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('109855') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0070s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100236'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10130','10132','10266','10301','10302','10303','10307') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100236 LIMIT 1   [ RunTime:0.0070s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0090s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100236'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10043') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0050s ]

[ 2018-09-21T10:25:32+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0080s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0080s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0140s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0090s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537496732','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100236\"}') [ RunTime:0.0750s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0100s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0050s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0100s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100236'  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('109855') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0120s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100236'  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10130','10132','10266','10301','10302','10303','10307') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0100s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100236 LIMIT 1   [ RunTime:0.0060s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0130s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100236'  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10043') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0060s ]

[ 2018-09-21T10:25:33+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0090s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0110s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0170s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0150s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0080s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537496733','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100236\"}') [ RunTime:0.0820s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0060s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0070s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100236'  [ RunTime:0.0060s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('109855') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0070s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100236'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10130','10132','10266','10301','10302','10303','10307') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0090s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100236 LIMIT 1   [ RunTime:0.0070s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0110s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100236'  [ RunTime:0.0090s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10043') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0080s ]

[ 2018-09-21T10:25:33+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0080s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0130s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537496733','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100236\"}') [ RunTime:0.0890s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0140s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0070s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0180s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0100s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100236'  [ RunTime:0.0050s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('109855') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0070s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100236'  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10130','10132','10266','10301','10302','10303','10307') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100236 LIMIT 1   [ RunTime:0.0050s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0280s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100236'  [ RunTime:0.0050s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10043') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0070s ]

[ 2018-09-21T10:25:34+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0090s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0110s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0410s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0130s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537496733','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100236\"}') [ RunTime:0.0900s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0130s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0220s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0210s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0200s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0130s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0080s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100236'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('109855') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0080s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100236'  [ RunTime:0.0050s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10130','10132','10266','10301','10302','10303','10307') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0090s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100236 LIMIT 1   [ RunTime:0.0050s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0130s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100236'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10043') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0050s ]

[ 2018-09-21T10:25:35+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.002000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.003000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0200s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0200s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0160s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537496734','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100236\"}') [ RunTime:0.0660s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0190s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0060s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0130s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0130s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100236'  [ RunTime:0.0080s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('109855') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0110s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100236'  [ RunTime:0.0050s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10130','10132','10266','10301','10302','10303','10307') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0120s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100236 LIMIT 1   [ RunTime:0.0090s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0090s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100236'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10043') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0050s ]

[ 2018-09-21T10:31:41+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0190s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0220s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.6230s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.3150s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537497099','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:1.0761s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.3370s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0140s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0210s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0080s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.3050s ]

[ 2018-09-21T10:33:45+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0220s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0200s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0600s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.3070s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0170s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537497224','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.4020s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0240s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0210s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.2210s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.2760s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0740s ]

[ 2018-09-21T10:34:25+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0190s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0570s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.1280s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0180s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0410s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537497264','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0940s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0430s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0140s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0360s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0200s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0290s ]

[ 2018-09-21T10:34:40+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0060s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0270s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0380s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0620s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0090s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537497268','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100236\"}') [ RunTime:0.3650s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0130s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0460s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0150s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:1.2891s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.8150s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:2.7632s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.7370s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0820s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100236'  [ RunTime:2.3791s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('109855') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.4100s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.6870s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100236'  [ RunTime:1.1321s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10130','10132','10266','10301','10302','10303','10307') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.4030s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0260s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100236 LIMIT 1   [ RunTime:0.0340s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0230s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:1.5161s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100236'  [ RunTime:0.0490s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10043') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0250s ]

[ 2018-09-21T10:34:55+08:00 ] ::1 /Dwin/Index/checkPostInfo
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0090s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0140s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0740s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%index/checkpostinfo%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0820s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0230s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('系统检测菜单权限',NULL,'394','::1','index/checkpostinfo','1537497295','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"flag\":\"1\"}') [ RunTime:0.0830s ]

[ 2018-09-21T10:34:56+08:00 ] ::1 /Dwin/Index/getOrderMsg
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0140s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0120s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0560s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%index/getordermsg%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0280s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('系统检测不合格订单',NULL,'394','::1','index/getordermsg','1537497296','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','[]') [ RunTime:0.0470s ]
SQL: SHOW COLUMNS FROM `crm_orderform` [ RunTime:0.0230s ]
SQL: SELECT `cus_name` FROM `crm_orderform` WHERE `picid` = '394' AND `check_status` = '2' AND `is_del` = 0  [ RunTime:0.0470s ]

[ 2018-09-21T10:35:10+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0160s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0110s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0370s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0110s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537497309','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.2540s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.2440s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0180s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0150s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0200s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0300s ]

[ 2018-09-21T10:35:11+08:00 ] ::1 /Dwin/Production/productionPlan
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001001s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001001s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0100s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0150s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0340s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0420s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionplan%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0160s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('展示生产计划',NULL,'394','::1','production/productionplan','1537497310','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_order\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"staff_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_cate_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"create_time\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"delivery_time\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"yqts\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_plan_rest_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"production_status\":\"\",\"production_line\":\"\"}') [ RunTime:0.2690s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0210s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0090s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_auth_role` [ RunTime:0.0130s ]
SQL: SELECT `role_id`,`staff_ids` FROM `crm_auth_role` WHERE `role_id` IN (50)  [ RunTime:0.0070s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0170s ]
SQL: SELECT COUNT(*) AS tp_count FROM `crm_production_plan` WHERE `production_status` IN ('1','2','3','4') AND `is_del` = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') LIMIT 1   [ RunTime:0.0200s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_plan plan WHERE `production_status` IN ('1','2','3','4') AND `is_del` = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') LIMIT 1   [ RunTime:0.0240s ]
SQL: SELECT plan.id,`production_order`,`staff_name`,`stock_cate_name`,plan.product_name,`production_line_name`,`production_plan_number`,plan.production_number,from_unixtime(create_time,'%y-%m-%d') create_time,from_unixtime(delivery_time,'%y-%m-%d') delivery_time,`production_status`,ifnull(plan.tips,'无') tips,delivery_time yqts,sum(stock.stock_number) stock_number,sum(stock.o_audit) o_audit,sum(product.production_number) product_num,sum(product.production_number) production_plan_rest_num FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id  WHERE `production_status` IN ('1','2','3','4') AND `is_del` = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') GROUP BY plan.id ORDER BY create_time desc,plan.id desc LIMIT 0,10   [ RunTime:0.0420s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.3780s ]
SQL: SELECT SUM(production_plan_rest_number) AS tp_sum FROM `crm_production_plan` WHERE `product_name` = '10.4寸保护膜' AND `production_line_name` = 'SMT线' AND `production_status` = 3 LIMIT 1   [ RunTime:0.1820s ]

[ 2018-09-21T10:35:14+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0830s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0280s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.3010s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.1340s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0200s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0220s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537497313','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100236\"}') [ RunTime:0.0950s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0160s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0310s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0240s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0300s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0200s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0210s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100236'  [ RunTime:0.0090s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('109855') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0270s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0360s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100236'  [ RunTime:0.0060s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10130','10132','10266','10301','10302','10303','10307') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0290s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0180s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100236 LIMIT 1   [ RunTime:0.0170s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0170s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0130s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100236'  [ RunTime:0.0170s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10043') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0160s ]

[ 2018-09-21T10:36:50+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0120s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0150s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0650s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0410s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0410s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537497410','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0810s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0170s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0130s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0350s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0090s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0260s ]

[ 2018-09-21T10:36:52+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002001s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0110s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0120s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0480s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0240s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0260s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537497411','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100236\"}') [ RunTime:0.0450s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0200s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0220s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0170s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0260s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0150s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0150s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0130s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0100s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100236'  [ RunTime:0.0060s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('109855') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0160s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0210s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100236'  [ RunTime:0.0070s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10130','10132','10266','10301','10302','10303','10307') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0150s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0120s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100236 LIMIT 1   [ RunTime:0.0100s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0180s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100236'  [ RunTime:0.0320s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10043') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0180s ]

[ 2018-09-21T10:37:12+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0080s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0120s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0190s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0090s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537497432','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0760s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0060s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0080s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0030s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0140s ]

[ 2018-09-21T10:37:13+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0060s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0020s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0140s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537497433','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100236\"}') [ RunTime:0.0370s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0080s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0130s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0160s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0180s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100236'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('109855') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0120s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100236'  [ RunTime:0.0080s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10130','10132','10266','10301','10302','10303','10307') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0120s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100236 LIMIT 1   [ RunTime:0.0090s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0090s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100236'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10043') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0060s ]

[ 2018-09-21T10:40:52+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0090s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0100s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0390s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0280s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0170s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537497652','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0970s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0130s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0160s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0280s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0220s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0580s ]

[ 2018-09-21T10:41:04+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0120s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0770s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0480s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.1300s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0290s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0130s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537497663','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100236\"}') [ RunTime:0.0930s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0200s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0350s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0210s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0880s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0250s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0270s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0180s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100236'  [ RunTime:0.0120s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('109855') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0460s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0180s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100236'  [ RunTime:0.0100s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10130','10132','10266','10301','10302','10303','10307') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0130s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0260s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100236 LIMIT 1   [ RunTime:0.0200s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0090s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100236'  [ RunTime:0.0790s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10043') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0100s ]

[ 2018-09-21T10:42:21+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0080s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0100s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0180s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0110s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537497741','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0800s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0110s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0130s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0090s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0060s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0190s ]

[ 2018-09-21T10:42:22+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001001s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002001s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0250s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0130s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0200s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0140s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537497742','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100236\"}') [ RunTime:0.0740s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0110s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0060s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0160s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0310s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0200s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0210s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0180s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100236'  [ RunTime:0.0130s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('109855') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0150s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0120s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100236'  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10130','10132','10266','10301','10302','10303','10307') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0210s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100236 LIMIT 1   [ RunTime:0.0120s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0130s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100236'  [ RunTime:0.0070s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10043') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0070s ]

[ 2018-09-21T10:42:40+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0130s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0170s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0290s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0150s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537497760','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0780s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0150s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0110s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0120s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0410s ]

[ 2018-09-21T10:42:42+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0120s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0110s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0320s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0200s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0150s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537497761','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100236\"}') [ RunTime:0.0810s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0210s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0260s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0150s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0320s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0270s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0370s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100236'  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('109855') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0240s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0250s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100236'  [ RunTime:0.0130s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10130','10132','10266','10301','10302','10303','10307') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0180s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100236 LIMIT 1   [ RunTime:0.0070s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0210s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0130s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100236'  [ RunTime:0.0130s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10043') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0110s ]

[ 2018-09-21T10:42:56+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0090s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0330s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0260s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0250s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537497775','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0940s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0240s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0060s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0120s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0230s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0390s ]

[ 2018-09-21T10:42:57+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0150s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0150s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0580s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0330s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0190s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537497777','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100236\"}') [ RunTime:0.0860s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0080s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0190s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0150s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0220s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0440s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0520s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0680s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100236'  [ RunTime:0.0530s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('109855') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0520s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0400s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100236'  [ RunTime:0.0120s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10130','10132','10266','10301','10302','10303','10307') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0160s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0120s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100236 LIMIT 1   [ RunTime:0.0050s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0130s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100236'  [ RunTime:0.0050s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10043') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0050s ]

[ 2018-09-21T10:44:55+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001001s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002001s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0140s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0190s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.1070s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0130s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537497895','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0780s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.3130s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0070s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0200s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0050s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.2280s ]

[ 2018-09-21T10:44:58+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0110s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0130s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0090s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0220s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0110s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537497896','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100236\"}') [ RunTime:0.4190s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0080s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.3150s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0090s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100236'  [ RunTime:0.0140s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('109855') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0150s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0190s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100236'  [ RunTime:0.0060s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10130','10132','10266','10301','10302','10303','10307') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.3050s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0080s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100236 LIMIT 1   [ RunTime:0.0070s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0070s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100236'  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10043') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0040s ]

[ 2018-09-21T10:45:42+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0400s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0120s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0410s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0250s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537497942','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0880s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0150s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0190s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0150s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0080s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0240s ]

[ 2018-09-21T10:45:44+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0130s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0100s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0210s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0080s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537497943','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100236\"}') [ RunTime:0.1070s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0110s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0330s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0230s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0150s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.2800s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0170s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0090s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100236'  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('109855') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0150s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0090s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100236'  [ RunTime:0.0160s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10130','10132','10266','10301','10302','10303','10307') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0170s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0660s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100236 LIMIT 1   [ RunTime:0.0250s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0090s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100236'  [ RunTime:0.0060s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10043') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0180s ]

[ 2018-09-21T10:47:36+08:00 ] ::1 /Dwin/Production/productionOrderIndex
ERR: SQLSTATE[HY000] [2002] ӷһʱûȷ𸴻ӵûзӦӳʧܡ


[ 2018-09-21T10:47:50+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0130s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0140s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.1090s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0130s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537498070','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.2890s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0160s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0100s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0250s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0090s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0680s ]

[ 2018-09-21T10:48:11+08:00 ] ::1 /Dwin/Index/checkPostInfo
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.002000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.003000s ]

[ 2018-09-21T10:48:12+08:00 ] ::1 /Dwin/Production/productionPlan
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0100s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionplan%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0090s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('展示生产计划',NULL,'394','::1','production/productionplan','1537498092','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_order\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"staff_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_cate_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"create_time\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"delivery_time\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"yqts\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_plan_rest_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"production_status\":\"\",\"production_line\":\"\"}') [ RunTime:0.0820s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_auth_role` [ RunTime:0.0110s ]
SQL: SELECT `role_id`,`staff_ids` FROM `crm_auth_role` WHERE `role_id` IN (50)  [ RunTime:0.0110s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0080s ]
SQL: SELECT COUNT(*) AS tp_count FROM `crm_production_plan` WHERE `production_status` IN ('1','2','3','4') AND `is_del` = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') LIMIT 1   [ RunTime:0.0200s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_plan plan WHERE `production_status` IN ('1','2','3','4') AND `is_del` = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') LIMIT 1   [ RunTime:0.0160s ]
SQL: SELECT plan.id,`production_order`,`staff_name`,`stock_cate_name`,plan.product_name,`production_line_name`,`production_plan_number`,plan.production_number,from_unixtime(create_time,'%y-%m-%d') create_time,from_unixtime(delivery_time,'%y-%m-%d') delivery_time,`production_status`,ifnull(plan.tips,'无') tips,delivery_time yqts,sum(stock.stock_number) stock_number,sum(stock.o_audit) o_audit,sum(product.production_number) product_num,sum(product.production_number) production_plan_rest_num FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id  WHERE `production_status` IN ('1','2','3','4') AND `is_del` = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') GROUP BY plan.id ORDER BY create_time desc,plan.id desc LIMIT 0,10   [ RunTime:0.0370s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0230s ]
SQL: SELECT SUM(production_plan_rest_number) AS tp_sum FROM `crm_production_plan` WHERE `product_name` = '10.4寸保护膜' AND `production_line_name` = 'SMT线' AND `production_status` = 3 LIMIT 1   [ RunTime:0.0180s ]

[ 2018-09-21T10:48:13+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0120s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0080s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0170s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0100s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537498093','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0790s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0080s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0090s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0070s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0120s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0220s ]

[ 2018-09-21T10:48:14+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0100s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0120s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0150s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0130s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537498094','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100236\"}') [ RunTime:0.0680s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0050s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0290s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0150s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0350s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0080s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100236'  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('109855') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0080s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100236'  [ RunTime:0.0060s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10130','10132','10266','10301','10302','10303','10307') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0090s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100236 LIMIT 1   [ RunTime:0.0100s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0080s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100236'  [ RunTime:0.0080s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10043') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0080s ]

[ 2018-09-21T10:48:37+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0130s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0270s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0510s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0090s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537498116','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0730s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0120s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0070s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0250s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0350s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0330s ]

[ 2018-09-21T10:48:38+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0110s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0130s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0140s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0130s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537498118','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100236\"}') [ RunTime:0.0420s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0050s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0130s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0070s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100236'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('109855') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0110s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100236'  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10130','10132','10266','10301','10302','10303','10307') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0130s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100236 LIMIT 1   [ RunTime:0.0120s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0090s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100236'  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10043') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0090s ]

[ 2018-09-21T10:57:13+08:00 ] ::1 /Dwin/Index/checkPostInfo
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0140s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0080s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0140s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%index/checkpostinfo%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0110s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('系统检测菜单权限',NULL,'394','::1','index/checkpostinfo','1537498633','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"flag\":\"1\"}') [ RunTime:0.0680s ]

[ 2018-09-21T10:57:13+08:00 ] ::1 /Dwin/Index/getOrderMsg
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0770s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0200s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0160s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0340s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%index/getordermsg%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0090s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('系统检测不合格订单',NULL,'394','::1','index/getordermsg','1537498633','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','[]') [ RunTime:0.0760s ]
SQL: SHOW COLUMNS FROM `crm_orderform` [ RunTime:0.0090s ]
SQL: SELECT `cus_name` FROM `crm_orderform` WHERE `picid` = '394' AND `check_status` = '2' AND `is_del` = 0  [ RunTime:0.0250s ]

[ 2018-09-21T10:57:21+08:00 ] ::1 /Dwin/Production/productionPlan
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0090s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0160s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionplan%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0190s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('展示生产计划',NULL,'394','::1','production/productionplan','1537498640','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_order\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"staff_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_cate_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"create_time\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"delivery_time\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"yqts\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_plan_rest_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"production_status\":\"\",\"production_line\":\"\"}') [ RunTime:0.9731s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0100s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0050s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_auth_role` [ RunTime:0.0110s ]
SQL: SELECT `role_id`,`staff_ids` FROM `crm_auth_role` WHERE `role_id` IN (50)  [ RunTime:0.0340s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0400s ]
SQL: SELECT COUNT(*) AS tp_count FROM `crm_production_plan` WHERE `production_status` IN ('1','2','3','4') AND `is_del` = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') LIMIT 1   [ RunTime:0.0220s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_plan plan WHERE `production_status` IN ('1','2','3','4') AND `is_del` = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') LIMIT 1   [ RunTime:0.0320s ]
SQL: SELECT plan.id,`production_order`,`staff_name`,`stock_cate_name`,plan.product_name,`production_line_name`,`production_plan_number`,plan.production_number,from_unixtime(create_time,'%y-%m-%d') create_time,from_unixtime(delivery_time,'%y-%m-%d') delivery_time,`production_status`,ifnull(plan.tips,'无') tips,delivery_time yqts,sum(stock.stock_number) stock_number,sum(stock.o_audit) o_audit,sum(product.production_number) product_num,sum(product.production_number) production_plan_rest_num FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id  WHERE `production_status` IN ('1','2','3','4') AND `is_del` = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') GROUP BY plan.id ORDER BY create_time desc,plan.id desc LIMIT 0,10   [ RunTime:0.0370s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0310s ]
SQL: SELECT SUM(production_plan_rest_number) AS tp_sum FROM `crm_production_plan` WHERE `product_name` = '10.4寸保护膜' AND `production_line_name` = 'SMT线' AND `production_status` = 3 LIMIT 1   [ RunTime:0.0230s ]

[ 2018-09-21T10:57:22+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0100s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0110s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0200s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0170s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0170s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537498642','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.6750s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0190s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0070s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0420s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0280s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0370s ]

[ 2018-09-21T10:57:48+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0090s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0370s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0650s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0270s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0110s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537498667','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100214\"}') [ RunTime:0.0970s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0100s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0190s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0220s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0220s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.8340s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0100s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100214'  [ RunTime:0.0070s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('110312','109401') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0450s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0350s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100214'  [ RunTime:0.0060s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10104','10105','10106','10107','10108','10109','10110','10111','10112','10126','10128','10129','10264','10265','10308','10309','10310') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0100s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100214 LIMIT 1   [ RunTime:0.0290s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0080s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100214'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10051','10087') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0080s ]

[ 2018-09-21T10:58:27+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0080s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0420s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0480s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0090s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537498707','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0800s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0090s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0080s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0080s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0140s ]

[ 2018-09-21T10:58:29+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0090s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0090s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0830s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0170s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0170s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537498708','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100214\"}') [ RunTime:0.0450s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0090s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0260s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0210s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0100s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100214'  [ RunTime:0.0160s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('110312','109401') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0150s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0070s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100214'  [ RunTime:0.0080s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10104','10105','10106','10107','10108','10109','10110','10111','10112','10126','10128','10129','10264','10265','10308','10309','10310') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0080s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100214 LIMIT 1   [ RunTime:0.0060s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0080s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100214'  [ RunTime:0.0050s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10051','10087') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0030s ]

[ 2018-09-21T10:58:30+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0130s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0060s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0180s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0060s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537498710','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100241\"}') [ RunTime:0.0660s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0240s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0100s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0160s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0190s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0440s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0120s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100241'  [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0140s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100241'  [ RunTime:0.0310s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0090s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100241 LIMIT 1   [ RunTime:0.0040s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '10071' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0130s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100241'  [ RunTime:0.0050s ]

[ 2018-09-21T10:58:41+08:00 ] ::1 /Dwin/Production/delProductionTask
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0080s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0160s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.7180s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/delproductiontask%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0480s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.9151s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/delproductiontask','1537498716','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"100241\"}') [ RunTime:2.1121s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0150s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.2630s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.4010s ]
SQL: SHOW COLUMNS FROM `crm_stock_in_production` [ RunTime:0.0200s ]
SQL: SELECT * FROM `crm_stock_in_production` WHERE `source_id` = '100241' AND `is_del` = 0  [ RunTime:0.1050s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.3360s ]
SQL: SELECT * FROM `crm_production_task` WHERE `id` = 100241  [ RunTime:0.1160s ]
SQL: UPDATE `crm_production_task` SET `is_del`='1' WHERE `id` = 100241 [ RunTime:0.0610s ]

[ 2018-09-21T10:59:01+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0170s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0090s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0250s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.9011s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0170s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537498739','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.6890s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.8620s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0090s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0110s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0380s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0590s ]

[ 2018-09-21T11:03:11+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0090s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0160s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0320s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0160s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0090s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537498991','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.3570s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0120s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0090s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0090s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0190s ]

[ 2018-09-21T11:03:33+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001001s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001001s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.3200s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0150s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.3190s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0160s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537499013','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100241\"}') [ RunTime:0.0620s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0120s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0070s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0170s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0160s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0150s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0110s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100241'  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0140s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100241'  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0120s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100241 LIMIT 1   [ RunTime:0.0140s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '10071' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0110s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100241'  [ RunTime:0.0060s ]

[ 2018-09-21T11:03:40+08:00 ] ::1 /Dwin/Production/delProductionTask
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001001s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002001s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0060s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0230s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/delproductiontask%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0100s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/delproductiontask','1537499020','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"100241\"}') [ RunTime:0.0440s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.3090s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_stock_in_production` [ RunTime:0.0090s ]
SQL: SELECT * FROM `crm_stock_in_production` WHERE `source_id` = '100241' AND `is_del` = 0  [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0120s ]
SQL: SELECT * FROM `crm_production_task` WHERE `id` = 100241  [ RunTime:0.0050s ]
SQL: UPDATE `crm_production_task` SET `is_del`='1' WHERE `id` = 100241 [ RunTime:0.0050s ]

[ 2018-09-21T11:03:41+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001001s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001001s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0080s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0080s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0180s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0080s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537499020','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"2\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.3690s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0100s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0120s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0050s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0150s ]

[ 2018-09-21T11:03:51+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0080s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:1.3531s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0170s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537499029','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100214\"}') [ RunTime:0.0720s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0150s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0120s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0210s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0170s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0170s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0130s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0100s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100214'  [ RunTime:0.0090s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('110312','109401') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.9031s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0170s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100214'  [ RunTime:0.0080s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10104','10105','10106','10107','10108','10109','10110','10111','10112','10126','10128','10129','10264','10265','10308','10309','10310') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0310s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0200s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100214 LIMIT 1   [ RunTime:0.6770s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0190s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0230s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100214'  [ RunTime:0.0090s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10051','10087') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0170s ]

[ 2018-09-21T11:03:54+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0150s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.9161s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.3180s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0130s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537499032','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100241\"}') [ RunTime:0.0830s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0160s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0070s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.5250s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0130s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0180s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100241'  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.3080s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100241'  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0130s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100241 LIMIT 1   [ RunTime:0.0120s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '10071' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0160s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100241'  [ RunTime:0.0090s ]

[ 2018-09-21T11:04:58+08:00 ] ::1 /Dwin/Production/editProductionTask
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0100s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0090s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0350s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/editproductiontask%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0100s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/editproductiontask','1537499097','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"100241\",\"create_t\":\"2018-09-20 13:26:28\",\"production_code\":\"SCJH-0\",\"product_no\":\"00489\",\"product_id\":\"489\",\"bom_id\":\"DW2018092010071\",\"product_name\":\"DMT80480S050-01WN\",\"production_line\":\"\\u751f\\u4ea7\\u7ebf\",\"production_type\":\"\",\"start_t\":\"2018-05-07\",\"end_t\":\"2018-05-14\",\"production_status\":\"0\",\"plan_number\":\"200\",\"assign_number\":\"2\",\"actual_end_time\":\"0\",\"tips\":\"\",\"create_id\":\"394\",\"create_name\":\"\",\"stock_status\":\"0\",\"remaining_day\":\"-130\",\"assigned_number\":\"0\",\"need_assign_num\":\"200\",\"in_stock_num\":\"1\",\"production_progress\":\"0\",\"stock_out_num\":\"1\",\"bom_num\":\"3\",\"sum(produce_out_num)\":\"\",\"out_num\":\"\",\"group_concat(produce_source_id)\":\"\",\"group_concat(produce_out_num)\":\"\",\"audit_status\":\"0\"}') [ RunTime:0.3750s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0110s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0090s ]

[ 2018-09-21T11:06:54+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001001s ]
ERR: SQLSTATE[HY000] [2002] ӷһʱûȷ𸴻ӵûзӦӳʧܡ


[ 2018-09-21T11:07:02+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.002000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.003000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0100s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0140s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0220s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0150s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0120s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537499220','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.4140s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0080s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0080s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.1810s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0070s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.9221s ]

[ 2018-09-21T11:07:05+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0150s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0160s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.1030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0160s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537499224','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100236\"}') [ RunTime:0.1760s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0140s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0200s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0190s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0180s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.9031s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0270s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0220s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0150s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100236'  [ RunTime:0.0100s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('109855') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0260s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0160s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100236'  [ RunTime:0.0090s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10130','10132','10266','10301','10302','10303','10307') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0150s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0180s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100236 LIMIT 1   [ RunTime:0.0420s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0120s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100236'  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10043') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0130s ]

[ 2018-09-21T11:07:10+08:00 ] ::1 /Dwin/Production/delProductionTask
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002001s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0110s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0110s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.5450s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/delproductiontask%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0140s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/delproductiontask','1537499229','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"100236\"}') [ RunTime:0.3750s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0110s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0180s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0210s ]
SQL: SHOW COLUMNS FROM `crm_stock_in_production` [ RunTime:0.0100s ]
SQL: SELECT * FROM `crm_stock_in_production` WHERE `source_id` = '100236' AND `is_del` = 0  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0100s ]
SQL: SELECT * FROM `crm_production_task` WHERE `id` = 100236  [ RunTime:0.0140s ]
SQL: UPDATE `crm_production_task` SET `is_del`='1' WHERE `id` = 100236 [ RunTime:0.0030s ]

[ 2018-09-21T11:07:20+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0060s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0100s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:9.7846s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0130s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537499240','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"2\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0540s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0090s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0080s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0110s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0040s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0240s ]

[ 2018-09-21T11:07:37+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0080s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0100s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.3670s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0120s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537499240','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100214\"}') [ RunTime:0.1730s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.3370s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.1090s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.2650s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0190s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0170s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100214'  [ RunTime:0.0080s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('110312','109401') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0080s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100214'  [ RunTime:0.0050s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10104','10105','10106','10107','10108','10109','10110','10111','10112','10126','10128','10129','10264','10265','10308','10309','10310') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.2080s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100214 LIMIT 1   [ RunTime:0.5900s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:15.3159s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0270s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100214'  [ RunTime:0.0180s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10051','10087') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0210s ]

[ 2018-09-21T11:07:38+08:00 ] ::1 /Dwin/Production/editProductionTask
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.003000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0140s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0220s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0820s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/editproductiontask%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.2620s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0210s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/editproductiontask','1537499258','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"100214\",\"create_t\":\"2018-08-23 14:35:53\",\"production_code\":\"SCJH-100214\",\"product_no\":\"15154\",\"product_id\":\"15154\",\"bom_id\":\"DW2018082360001\",\"product_name\":\"K600+\",\"production_line\":\"SMT\\u7ebf\",\"production_type\":\"\",\"start_t\":\"2018-08-23\",\"end_t\":\"2018-09-16\",\"production_status\":\"1\",\"plan_number\":\"100000\",\"assign_number\":\"26845\",\"actual_end_time\":\"0\",\"tips\":\"\\u6d4b\\u8bd5\\u5408\\u5e76\\u4e24\\u4e2a\\u540c\\u578b\\u53f7\\u7684\\u5355\\u636e\",\"create_id\":\"1\",\"create_name\":\"\",\"stock_status\":\"1\",\"remaining_day\":\"-5\",\"assigned_number\":\"0\",\"need_assign_num\":\"73155\",\"in_stock_num\":\"3099\",\"production_progress\":\"1\",\"stock_out_num\":\"3\",\"bom_num\":\"12\",\"sum(produce_out_num)\":\"612\",\"out_num\":\"36\",\"group_concat(produce_source_id)\":\"100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214\",\"group_concat(produce_out_num)\":\"36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36\",\"audit_status\":\"0\"}') [ RunTime:0.0830s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0170s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0190s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.2790s ]

[ 2018-09-21T11:11:55+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0100s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0080s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0130s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0110s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537499515','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0570s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0110s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0050s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0070s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0060s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0330s ]

[ 2018-09-21T11:11:58+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0160s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0250s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0130s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537499518','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100236\"}') [ RunTime:0.0810s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0050s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0130s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0200s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0080s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100236'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('109855') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0200s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0080s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100236'  [ RunTime:0.0080s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10130','10132','10266','10301','10302','10303','10307') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0110s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100236 LIMIT 1   [ RunTime:0.0110s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0190s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100236'  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10043') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0100s ]

[ 2018-09-21T11:13:28+08:00 ] ::1 /Dwin/Index/checkPostInfo
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0130s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0150s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%index/checkpostinfo%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0150s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('系统检测菜单权限',NULL,'394','::1','index/checkpostinfo','1537499608','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"flag\":\"1\"}') [ RunTime:0.0460s ]

[ 2018-09-21T11:13:29+08:00 ] ::1 /Dwin/Index/getOrderMsg
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0100s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0120s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0240s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%index/getordermsg%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0100s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('系统检测不合格订单',NULL,'394','::1','index/getordermsg','1537499609','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','[]') [ RunTime:0.1360s ]
SQL: SHOW COLUMNS FROM `crm_orderform` [ RunTime:0.0720s ]
SQL: SELECT `cus_name` FROM `crm_orderform` WHERE `picid` = '394' AND `check_status` = '2' AND `is_del` = 0  [ RunTime:0.0260s ]

[ 2018-09-21T11:13:32+08:00 ] ::1 /Dwin/Production/productionPlan
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0180s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0090s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0550s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionplan%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0160s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('展示生产计划',NULL,'394','::1','production/productionplan','1537499612','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_order\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"staff_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_cate_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"create_time\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"delivery_time\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"yqts\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_plan_rest_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"production_status\":\"\",\"production_line\":\"\"}') [ RunTime:0.0780s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0080s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0080s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_auth_role` [ RunTime:0.0080s ]
SQL: SELECT `role_id`,`staff_ids` FROM `crm_auth_role` WHERE `role_id` IN (50)  [ RunTime:0.0140s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0130s ]
SQL: SELECT COUNT(*) AS tp_count FROM `crm_production_plan` WHERE `production_status` IN ('1','2','3','4') AND `is_del` = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') LIMIT 1   [ RunTime:0.0190s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_plan plan WHERE `production_status` IN ('1','2','3','4') AND `is_del` = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') LIMIT 1   [ RunTime:0.0220s ]
SQL: SELECT plan.id,`production_order`,`staff_name`,`stock_cate_name`,plan.product_name,`production_line_name`,`production_plan_number`,plan.production_number,from_unixtime(create_time,'%y-%m-%d') create_time,from_unixtime(delivery_time,'%y-%m-%d') delivery_time,`production_status`,ifnull(plan.tips,'无') tips,delivery_time yqts,sum(stock.stock_number) stock_number,sum(stock.o_audit) o_audit,sum(product.production_number) product_num,sum(product.production_number) production_plan_rest_num FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id  WHERE `production_status` IN ('1','2','3','4') AND `is_del` = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') GROUP BY plan.id ORDER BY create_time desc,plan.id desc LIMIT 0,10   [ RunTime:0.0560s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0090s ]
SQL: SELECT SUM(production_plan_rest_number) AS tp_sum FROM `crm_production_plan` WHERE `product_name` = '10.4寸保护膜' AND `production_line_name` = 'SMT线' AND `production_status` = 3 LIMIT 1   [ RunTime:0.0170s ]

[ 2018-09-21T11:13:35+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0100s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0090s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0360s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0130s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0120s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537499614','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0960s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0110s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0050s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0140s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0050s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0140s ]

[ 2018-09-21T11:13:41+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0210s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0130s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0300s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0120s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537499620','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0800s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0120s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0110s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0070s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0190s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0110s ]

[ 2018-09-21T11:13:42+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0120s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0110s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0830s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0190s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0100s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537499622','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100236\"}') [ RunTime:0.0470s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0280s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0140s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0420s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0200s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0300s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0190s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100236'  [ RunTime:0.0080s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('109855') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0160s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100236'  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10130','10132','10266','10301','10302','10303','10307') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0130s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100236 LIMIT 1   [ RunTime:0.0100s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0090s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100236'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10043') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0070s ]

[ 2018-09-21T11:15:53+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0110s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0130s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0210s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0090s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537499752','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0860s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0260s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0120s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0090s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0140s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0160s ]

[ 2018-09-21T11:15:58+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0080s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0140s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0170s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0130s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537499757','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100214\"}') [ RunTime:0.0730s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0130s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0080s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0130s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0080s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100214'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('110312','109401') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0100s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100214'  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10104','10105','10106','10107','10108','10109','10110','10111','10112','10126','10128','10129','10264','10265','10308','10309','10310') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0180s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100214 LIMIT 1   [ RunTime:0.0070s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0160s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100214'  [ RunTime:0.0050s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10051','10087') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0030s ]

[ 2018-09-21T11:16:26+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0090s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0120s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0230s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0110s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537499785','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.8070s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0090s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0100s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0120s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0090s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.2730s ]

[ 2018-09-21T11:19:10+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0080s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0210s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537499950','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0730s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0110s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0080s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0100s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0190s ]

[ 2018-09-21T11:19:13+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0350s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0020s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0060s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0220s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537499952','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100214\"}') [ RunTime:0.0670s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0130s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0290s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0310s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0110s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100214'  [ RunTime:0.0050s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('110312','109401') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0090s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100214'  [ RunTime:0.0100s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10104','10105','10106','10107','10108','10109','10110','10111','10112','10126','10128','10129','10264','10265','10308','10309','10310') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100214 LIMIT 1   [ RunTime:0.0040s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0130s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100214'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10051','10087') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0030s ]

[ 2018-09-21T11:19:43+08:00 ] ::1 /Dwin/Production/editProductionTask
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0090s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0090s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0330s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/editproductiontask%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/editproductiontask','1537499983','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"100214\",\"create_t\":\"2018-08-23 14:35:53\",\"production_code\":\"SCJH-100214\",\"product_no\":\"15154\",\"product_id\":\"15154\",\"bom_id\":\"DW2018082360001\",\"product_name\":\"K600+\",\"production_line\":\"SMT\\u7ebf\",\"production_type\":\"\",\"start_t\":\"NaN\",\"end_t\":\"1538064000\",\"production_status\":\"1\",\"plan_number\":\"100000\",\"assign_number\":\"26845\",\"actual_end_time\":\"0\",\"tips\":\"\\u6d4b\\u8bd5\\u5408\\u5e76\\u4e24\\u4e2a\\u540c\\u578b\\u53f7\\u7684\\u5355\\u636e\",\"create_id\":\"1\",\"create_name\":\"\",\"stock_status\":\"1\",\"remaining_day\":\"-5\",\"assigned_number\":\"0\",\"need_assign_num\":\"73155\",\"in_stock_num\":\"3091\",\"production_progress\":\"1\",\"stock_out_num\":\"3\",\"bom_num\":\"12\",\"sum(produce_out_num)\":\"612\",\"out_num\":\"36\",\"group_concat(produce_source_id)\":\"100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214\",\"group_concat(produce_out_num)\":\"36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36\",\"audit_status\":\"0\"}') [ RunTime:0.0730s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0100s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0070s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0080s ]

[ 2018-09-21T11:20:16+08:00 ] ::1 /Dwin/Index/getOrderMsg
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0080s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0120s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%index/getordermsg%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0100s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('系统检测不合格订单',NULL,'394','::1','index/getordermsg','1537500015','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','[]') [ RunTime:0.0800s ]
SQL: SHOW COLUMNS FROM `crm_orderform` [ RunTime:0.0090s ]
SQL: SELECT `cus_name` FROM `crm_orderform` WHERE `picid` = '394' AND `check_status` = '2' AND `is_del` = 0  [ RunTime:0.0240s ]

[ 2018-09-21T11:20:16+08:00 ] ::1 /Dwin/Index/checkPostInfo
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0100s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0150s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%index/checkpostinfo%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('系统检测菜单权限',NULL,'394','::1','index/checkpostinfo','1537500016','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"flag\":\"1\"}') [ RunTime:0.0700s ]

[ 2018-09-21T11:20:19+08:00 ] ::1 /Dwin/Production/productionPlan
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0060s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0120s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0150s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionplan%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0120s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('展示生产计划',NULL,'394','::1','production/productionplan','1537500019','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_order\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"staff_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_cate_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"create_time\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"delivery_time\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"yqts\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_plan_rest_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"production_status\":\"\",\"production_line\":\"\"}') [ RunTime:0.0850s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_auth_role` [ RunTime:0.0070s ]
SQL: SELECT `role_id`,`staff_ids` FROM `crm_auth_role` WHERE `role_id` IN (50)  [ RunTime:0.0020s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0160s ]
SQL: SELECT COUNT(*) AS tp_count FROM `crm_production_plan` WHERE `production_status` IN ('1','2','3','4') AND `is_del` = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') LIMIT 1   [ RunTime:0.0200s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_plan plan WHERE `production_status` IN ('1','2','3','4') AND `is_del` = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') LIMIT 1   [ RunTime:0.0170s ]
SQL: SELECT plan.id,`production_order`,`staff_name`,`stock_cate_name`,plan.product_name,`production_line_name`,`production_plan_number`,plan.production_number,from_unixtime(create_time,'%y-%m-%d') create_time,from_unixtime(delivery_time,'%y-%m-%d') delivery_time,`production_status`,ifnull(plan.tips,'无') tips,delivery_time yqts,sum(stock.stock_number) stock_number,sum(stock.o_audit) o_audit,sum(product.production_number) product_num,sum(product.production_number) production_plan_rest_num FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id  WHERE `production_status` IN ('1','2','3','4') AND `is_del` = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') GROUP BY plan.id ORDER BY create_time desc,plan.id desc LIMIT 0,10   [ RunTime:0.0580s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0150s ]
SQL: SELECT SUM(production_plan_rest_number) AS tp_sum FROM `crm_production_plan` WHERE `product_name` = '10.4寸保护膜' AND `production_line_name` = 'SMT线' AND `production_status` = 3 LIMIT 1   [ RunTime:0.0180s ]

[ 2018-09-21T11:20:22+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0100s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0180s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0350s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0110s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537500022','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0780s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0140s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0140s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0200s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0160s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0280s ]

[ 2018-09-21T11:20:23+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0170s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537500023','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100236\"}') [ RunTime:0.0800s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0050s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0090s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100236'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('109855') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0130s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0080s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100236'  [ RunTime:0.0070s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10130','10132','10266','10301','10302','10303','10307') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0160s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0080s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100236 LIMIT 1   [ RunTime:0.0150s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0230s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0360s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100236'  [ RunTime:0.0220s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10043') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0090s ]

[ 2018-09-21T11:20:25+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0060s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0130s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0120s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537500024','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100214\"}') [ RunTime:0.0530s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0130s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0100s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0070s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100214'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('110312','109401') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0150s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100214'  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10104','10105','10106','10107','10108','10109','10110','10111','10112','10126','10128','10129','10264','10265','10308','10309','10310') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0110s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100214 LIMIT 1   [ RunTime:0.0110s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0130s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100214'  [ RunTime:0.0060s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10051','10087') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0290s ]

[ 2018-09-21T11:20:57+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0080s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0100s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0400s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0090s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537500057','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0730s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0090s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0070s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0040s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0150s ]

[ 2018-09-21T11:20:58+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0080s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0090s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0130s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0080s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537500058','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100214\"}') [ RunTime:0.0720s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0160s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0130s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0130s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100214'  [ RunTime:0.0060s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('110312','109401') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0080s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100214'  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10104','10105','10106','10107','10108','10109','10110','10111','10112','10126','10128','10129','10264','10265','10308','10309','10310') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0090s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100214 LIMIT 1   [ RunTime:0.0060s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0060s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100214'  [ RunTime:0.0020s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10051','10087') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0040s ]

[ 2018-09-21T11:21:05+08:00 ] ::1 /Dwin/Production/editProductionTask
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001001s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001001s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0370s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0760s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0930s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/editproductiontask%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0130s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0160s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/editproductiontask','1537500065','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"100214\",\"create_t\":\"2018-08-23 14:35:53\",\"production_code\":\"SCJH-100214\",\"product_no\":\"15154\",\"product_id\":\"15154\",\"bom_id\":\"DW2018082360001\",\"product_name\":\"K600+\",\"production_line\":\"SMT\\u7ebf\",\"production_type\":\"\",\"start_t\":\"2018-08-23\",\"end_t\":\"Thu Sep 27 2018 00:00:00 GMT+0800 (\\u4e2d\\u56fd\\u6807\\u51c6\\u65f6\\u95f4)\",\"production_status\":\"1\",\"plan_number\":\"100000\",\"assign_number\":\"26845\",\"actual_end_time\":\"0\",\"tips\":\"\\u6d4b\\u8bd5\\u5408\\u5e76\\u4e24\\u4e2a\\u540c\\u578b\\u53f7\\u7684\\u5355\\u636e\",\"create_id\":\"1\",\"create_name\":\"\",\"stock_status\":\"1\",\"remaining_day\":\"-5\",\"assigned_number\":\"0\",\"need_assign_num\":\"73155\",\"in_stock_num\":\"3099\",\"production_progress\":\"1\",\"stock_out_num\":\"3\",\"bom_num\":\"12\",\"sum(produce_out_num)\":\"612\",\"out_num\":\"36\",\"group_concat(produce_source_id)\":\"100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214\",\"group_concat(produce_out_num)\":\"36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36\",\"audit_status\":\"0\"}') [ RunTime:0.0750s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0210s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0280s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0190s ]

[ 2018-09-21T11:21:55+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0090s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0230s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0180s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537500115','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0770s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0110s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0150s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0100s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0070s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0150s ]

[ 2018-09-21T11:23:16+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0110s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0180s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537500196','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0760s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0060s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0070s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0070s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0110s ]

[ 2018-09-21T11:23:21+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0080s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0150s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0140s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0150s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537500201','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100214\"}') [ RunTime:0.0670s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0080s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0070s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100214'  [ RunTime:0.0100s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('110312','109401') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0070s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100214'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10104','10105','10106','10107','10108','10109','10110','10111','10112','10126','10128','10129','10264','10265','10308','10309','10310') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100214 LIMIT 1   [ RunTime:0.0040s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0100s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100214'  [ RunTime:0.0050s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10051','10087') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0060s ]

[ 2018-09-21T11:23:33+08:00 ] ::1 /Dwin/Production/editProductionTask
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0060s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0080s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0490s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/editproductiontask%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0080s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/editproductiontask','1537500213','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"100214\",\"create_t\":\"2018-08-23 14:35:53\",\"production_code\":\"SCJH-100214\",\"product_no\":\"15154\",\"product_id\":\"15154\",\"bom_id\":\"DW2018082360001\",\"product_name\":\"K600+\",\"production_line\":\"SMT\\u7ebf\",\"production_type\":\"\",\"start_t\":\"2018-08-23\",\"end_t\":\"YYYY-08-04\",\"production_status\":\"1\",\"plan_number\":\"100000\",\"assign_number\":\"26845\",\"actual_end_time\":\"0\",\"tips\":\"\\u6d4b\\u8bd5\\u5408\\u5e76\\u4e24\\u4e2a\\u540c\\u578b\\u53f7\\u7684\\u5355\\u636e\",\"create_id\":\"1\",\"create_name\":\"\",\"stock_status\":\"1\",\"remaining_day\":\"-5\",\"assigned_number\":\"0\",\"need_assign_num\":\"73155\",\"in_stock_num\":\"3099\",\"production_progress\":\"1\",\"stock_out_num\":\"3\",\"bom_num\":\"12\",\"sum(produce_out_num)\":\"612\",\"out_num\":\"36\",\"group_concat(produce_source_id)\":\"100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214\",\"group_concat(produce_out_num)\":\"36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36\",\"audit_status\":\"0\"}') [ RunTime:0.0720s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0190s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0100s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0100s ]

[ 2018-09-21T11:24:02+08:00 ] ::1 /Dwin/Production/editProductionTask
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0090s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0110s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0350s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/editproductiontask%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0210s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/editproductiontask','1537500241','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"100214\",\"create_t\":\"2018-08-23 14:35:53\",\"production_code\":\"SCJH-100214\",\"product_no\":\"15154\",\"product_id\":\"15154\",\"bom_id\":\"DW2018082360001\",\"product_name\":\"K600+\",\"production_line\":\"SMT\\u7ebf\",\"production_type\":\"\",\"start_t\":\"2018-08-23\",\"end_t\":\"YYYY-09-04\",\"production_status\":\"1\",\"plan_number\":\"100000\",\"assign_number\":\"26845\",\"actual_end_time\":\"0\",\"tips\":\"\\u6d4b\\u8bd5\\u5408\\u5e76\\u4e24\\u4e2a\\u540c\\u578b\\u53f7\\u7684\\u5355\\u636e\",\"create_id\":\"1\",\"create_name\":\"\",\"stock_status\":\"1\",\"remaining_day\":\"-5\",\"assigned_number\":\"0\",\"need_assign_num\":\"73155\",\"in_stock_num\":\"3099\",\"production_progress\":\"1\",\"stock_out_num\":\"3\",\"bom_num\":\"12\",\"sum(produce_out_num)\":\"612\",\"out_num\":\"36\",\"group_concat(produce_source_id)\":\"100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214\",\"group_concat(produce_out_num)\":\"36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36\",\"audit_status\":\"0\"}') [ RunTime:0.0630s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0120s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0210s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0100s ]

[ 2018-09-21T11:25:06+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002001s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0110s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.9001s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0230s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.5120s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0270s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0290s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537500306','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0800s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0230s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0230s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0150s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0170s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0710s ]

[ 2018-09-21T11:25:10+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0090s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0120s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0320s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0100s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537500307','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100214\"}') [ RunTime:0.6150s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0700s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0160s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0160s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0150s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0150s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0200s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0100s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100214'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('110312','109401') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.9121s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100214'  [ RunTime:0.0150s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10104','10105','10106','10107','10108','10109','10110','10111','10112','10126','10128','10129','10264','10265','10308','10309','10310') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.2430s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0190s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100214 LIMIT 1   [ RunTime:0.7980s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.1430s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0210s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100214'  [ RunTime:0.0080s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10051','10087') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0100s ]

[ 2018-09-21T11:25:40+08:00 ] ::1 /Dwin/Production/editProductionTask
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
ERR: SQLSTATE[HY000] [2002] ӷһʱûȷ𸴻ӵûзӦӳʧܡ


[ 2018-09-21T11:25:53+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0130s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0150s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0280s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.2170s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0110s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537500349','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:4.6213s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0080s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0030s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0160s ]

[ 2018-09-21T11:25:56+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0080s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0080s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0220s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0110s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537500356','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100214\"}') [ RunTime:0.0680s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0060s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0070s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100214'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('110312','109401') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0140s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100214'  [ RunTime:0.0050s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10104','10105','10106','10107','10108','10109','10110','10111','10112','10126','10128','10129','10264','10265','10308','10309','10310') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0130s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0090s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100214 LIMIT 1   [ RunTime:0.0050s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0080s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100214'  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10051','10087') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0110s ]

[ 2018-09-21T11:26:06+08:00 ] ::1 /Dwin/Production/editProductionTask
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0060s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0150s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0220s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/editproductiontask%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0120s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/editproductiontask','1537500366','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"100214\",\"create_t\":\"2018-08-23 14:35:53\",\"production_code\":\"SCJH-100214\",\"product_no\":\"15154\",\"product_id\":\"15154\",\"bom_id\":\"DW2018082360001\",\"product_name\":\"K600+\",\"production_line\":\"SMT\\u7ebf\",\"production_type\":\"\",\"start_t\":\"2018-08-23\",\"end_t\":\"2018-09-17\",\"production_status\":\"1\",\"plan_number\":\"100000\",\"assign_number\":\"26845\",\"actual_end_time\":\"0\",\"tips\":\"\\u6d4b\\u8bd5\\u5408\\u5e76\\u4e24\\u4e2a\\u540c\\u578b\\u53f7\\u7684\\u5355\\u636e\",\"create_id\":\"1\",\"create_name\":\"\",\"stock_status\":\"1\",\"remaining_day\":\"-5\",\"assigned_number\":\"0\",\"need_assign_num\":\"73155\",\"in_stock_num\":\"3099\",\"production_progress\":\"1\",\"stock_out_num\":\"3\",\"bom_num\":\"12\",\"sum(produce_out_num)\":\"612\",\"out_num\":\"36\",\"group_concat(produce_source_id)\":\"100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214\",\"group_concat(produce_out_num)\":\"36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36\",\"audit_status\":\"0\"}') [ RunTime:0.0730s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0130s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0050s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0070s ]

[ 2018-09-21T11:28:04+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0060s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0260s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0110s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537500483','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.8510s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0300s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0050s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0080s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0070s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0150s ]

[ 2018-09-21T11:28:06+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0060s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0020s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0190s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537500485','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100214\"}') [ RunTime:0.0630s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0110s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0130s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0080s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100214'  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('110312','109401') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0070s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100214'  [ RunTime:0.0150s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10104','10105','10106','10107','10108','10109','10110','10111','10112','10126','10128','10129','10264','10265','10308','10309','10310') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0180s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0150s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100214 LIMIT 1   [ RunTime:0.0040s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0070s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100214'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10051','10087') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0060s ]

[ 2018-09-21T11:28:06+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0020s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0080s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0170s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537500486','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100241\"}') [ RunTime:0.0800s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0130s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0210s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0150s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0070s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100241'  [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0070s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100241'  [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0130s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100241 LIMIT 1   [ RunTime:0.0070s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '10071' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0070s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100241'  [ RunTime:0.0030s ]

[ 2018-09-21T11:28:10+08:00 ] ::1 /Dwin/Production/delProductionOrder
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0090s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:1.1611s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/delproductionorder%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0230s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/delproductionorder','1537500489','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"100241\"}') [ RunTime:0.1120s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0130s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0120s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0200s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0190s ]
SQL: SELECT * FROM `crm_production_task` WHERE `order_pid` = 100241 AND `is_del` = 0  [ RunTime:0.0260s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0220s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100241  [ RunTime:0.0340s ]
SQL: UPDATE `crm_production_order` SET `is_del`='1' WHERE `id` = 100241 [ RunTime:0.1040s ]
SQL: show full fields from crm_production_order [ RunTime:0.0340s ]
SQL: INSERT INTO `dwin`.`crm_table_log` (
                                `staff_id`,
                                `staff_name`,
                                `path`,
                                `table_name`,
                                `comment`,
                                `type`,
                                `major_key`,
                                `before_data`,
                                `now_data`,
                                `create_time`
                            )
                            VALUES
                                (
                                    394,
                                    'zengyongtai',
                                    'Production/delProductionOrder',
                                    'crm_production_order',
                                    '{"id":"","create_time":"计划创建时间","plan_pid":"源单编号","production_code":"生产单号","product_no":"产品编号","product_id":"产品id","bom_pid":"生产物料对应bom表主键","plan_number":"计划生产总量","production_line":"生产线","production_type":"生产计划类别：应收、标准、备库","plan_start_time":"计划开工时间","plan_end_time":"计划完工时间","assign_number":"已分配生产数量（中间状态已废弃）","actual_end_time":"实际完工时间","tips":"备注,特殊要求","create_id":"制单人id","create_name":"制单人名字","production_status":"生产计划下推生产任务状态：1 未处理 2 分配中 3 分配完毕","stock_status":"出库状态 0-未处理 1-出库中 2-出库完成","complete_time":"实际完成时间","audit_status":"审核状态 0-未审核 1-审核不合格 2-审核合格","is_del":"是否已被删除 0 未被删除 1 已被删除","production_progress":"order单据状态：0 为处理 1 下推中 2 完结"}',
                                    2,
                                    '100241',
                                    '[{"id":"100241","create_time":"1537421188","plan_pid":"110794","production_code":"SCJH-0","product_no":"00489","product_id":"489","bom_pid":"10071","plan_number":"200","production_line":"1","production_type":null,"plan_start_time":"1525622400","plan_end_time":"1526227200","assign_number":"0","actual_end_time":"0","tips":"","create_id":"394","create_name":null,"production_status":"0","stock_status":"0","complete_time":null,"audit_status":"0","is_del":"0","production_progress":"0"}]',
                                    '[{"is_del":1,"id":"100241","create_time":"1537421188","plan_pid":"110794","production_code":"SCJH-0","product_no":"00489","product_id":"489","bom_pid":"10071","plan_number":"200","production_line":"1","production_type":null,"plan_start_time":"1525622400","plan_end_time":"1526227200","assign_number":"0","actual_end_time":"0","tips":"","create_id":"394","create_name":null,"production_status":"0","stock_status":"0","complete_time":null,"audit_status":"0","production_progress":"0"}]',
                                    1537500490
                                ); [ RunTime:0.0590s ]

[ 2018-09-21T11:28:10+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0090s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0130s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0240s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0100s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537500490','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"2\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0660s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0090s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0030s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0220s ]

[ 2018-09-21T11:28:13+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0180s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0210s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0090s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537500493','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100214\"}') [ RunTime:0.0780s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0110s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0060s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0130s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0130s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0190s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0210s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0100s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100214'  [ RunTime:0.0090s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('110312','109401') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0160s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100214'  [ RunTime:0.0080s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10104','10105','10106','10107','10108','10109','10110','10111','10112','10126','10128','10129','10264','10265','10308','10309','10310') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0180s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0130s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100214 LIMIT 1   [ RunTime:0.0050s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0220s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0140s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100214'  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10051','10087') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0210s ]

[ 2018-09-21T11:28:22+08:00 ] ::1 /Dwin/Production/editProductionOrder
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.004000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.004000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0080s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0140s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0140s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/editproductionorder%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/editproductionorder','1537500502','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"100214\",\"create_t\":\"2018-08-23 14:35:53\",\"production_code\":\"SCJH-100214\",\"product_no\":\"15154\",\"product_id\":\"15154\",\"bom_id\":\"DW2018082360001\",\"product_name\":\"K600+\",\"production_line\":\"SMT\\u7ebf\",\"production_type\":\"\",\"start_t\":\"2018-08-23\",\"end_t\":\"2018-09-17\",\"production_status\":\"1\",\"plan_number\":\"100000\",\"assign_number\":\"26845\",\"actual_end_time\":\"0\",\"tips\":\"\\u6d4b\\u8bd5\\u5408\\u5e76\\u4e24\\u4e2a\\u540c\\u578b\\u53f7\\u7684\\u5355\\u636e\",\"create_id\":\"1\",\"create_name\":\"\",\"stock_status\":\"1\",\"remaining_day\":\"-5\",\"assigned_number\":\"0\",\"need_assign_num\":\"73155\",\"in_stock_num\":\"3099\",\"production_progress\":\"1\",\"stock_out_num\":\"3\",\"bom_num\":\"12\",\"sum(produce_out_num)\":\"612\",\"out_num\":\"36\",\"group_concat(produce_source_id)\":\"100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214\",\"group_concat(produce_out_num)\":\"36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36\",\"audit_status\":\"0\"}') [ RunTime:0.0770s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0090s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0100s ]

[ 2018-09-21T11:57:06+08:00 ] ::1 /Dwin/Index/checkPostInfo
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0490s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0180s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.1710s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%index/checkpostinfo%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0150s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('系统检测菜单权限',NULL,'394','::1','index/checkpostinfo','1537502226','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"flag\":\"1\"}') [ RunTime:0.1040s ]

[ 2018-09-21T11:57:06+08:00 ] ::1 /Dwin/Index/getOrderMsg
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0080s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0270s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%index/getordermsg%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0200s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0320s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('系统检测不合格订单',NULL,'394','::1','index/getordermsg','1537502226','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','[]') [ RunTime:0.0750s ]
SQL: SHOW COLUMNS FROM `crm_orderform` [ RunTime:0.0230s ]
SQL: SELECT `cus_name` FROM `crm_orderform` WHERE `picid` = '394' AND `check_status` = '2' AND `is_del` = 0  [ RunTime:0.0290s ]

[ 2018-09-21T11:57:08+08:00 ] ::1 /Dwin/Production/productionPlan
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0060s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0090s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0210s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionplan%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0100s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('展示生产计划',NULL,'394','::1','production/productionplan','1537502227','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_order\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"staff_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_cate_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"create_time\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"delivery_time\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"yqts\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_plan_rest_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"production_status\":\"\",\"production_line\":\"\"}') [ RunTime:0.0800s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0160s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0060s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_auth_role` [ RunTime:0.0090s ]
SQL: SELECT `role_id`,`staff_ids` FROM `crm_auth_role` WHERE `role_id` IN (50)  [ RunTime:0.0050s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0210s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_plan plan WHERE `production_status` IN ('1','2','3','4') AND plan.is_del = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') LIMIT 1   [ RunTime:0.0290s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_plan plan WHERE `production_status` IN ('1','2','3','4') AND plan.is_del = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') LIMIT 1   [ RunTime:0.0420s ]
SQL: SELECT plan.id,`production_order`,`staff_name`,`stock_cate_name`,plan.product_name,`production_line_name`,`production_plan_number`,plan.production_number,from_unixtime(create_time,'%y-%m-%d') create_time,from_unixtime(delivery_time,'%y-%m-%d') delivery_time,`production_status`,ifnull(plan.tips,'无') tips,delivery_time yqts,sum(stock.stock_number) stock_number,sum(stock.o_audit) o_audit,sum(product.production_number) product_num,sum(product.production_number) production_plan_rest_num FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id  WHERE `production_status` IN ('1','2','3','4') AND plan.is_del = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') GROUP BY plan.id ORDER BY create_time desc,plan.id desc LIMIT 0,10   [ RunTime:0.0520s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0980s ]
SQL: SELECT SUM(production_plan_rest_number) AS tp_sum FROM `crm_production_plan` WHERE `product_name` = '10.4寸保护膜' AND `production_line_name` = 'SMT线' AND `production_status` = 3 LIMIT 1   [ RunTime:0.0350s ]

[ 2018-09-21T11:57:11+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0200s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0200s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0080s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537502230','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0870s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0180s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0080s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0110s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0240s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0320s ]

[ 2018-09-21T11:57:12+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0060s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0200s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0080s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537502232','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100214\"}') [ RunTime:0.0710s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0080s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0080s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0260s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0150s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0310s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0260s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100214'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('110312','109401') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0300s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100214'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10104','10105','10106','10107','10108','10109','10110','10111','10112','10126','10128','10129','10264','10265','10308','10309','10310') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0140s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100214 LIMIT 1   [ RunTime:0.0080s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0200s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0250s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100214'  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10051','10087') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0980s ]

[ 2018-09-21T11:57:13+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0180s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0080s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0300s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0110s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537502233','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100236\"}') [ RunTime:0.0780s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0150s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0070s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100236'  [ RunTime:0.0100s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('109855') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0070s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100236'  [ RunTime:0.0060s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10130','10132','10266','10301','10302','10303','10307') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100236 LIMIT 1   [ RunTime:0.0070s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0110s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100236'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10043') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0070s ]

[ 2018-09-21T11:57:14+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0090s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0250s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537502234','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"2\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"4\",\"dir\":\"asc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0920s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0060s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0060s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0290s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0070s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY plan_number asc LIMIT 0,10   [ RunTime:0.0180s ]

[ 2018-09-21T11:57:15+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0080s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0140s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0300s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0150s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537502235','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100236\"}') [ RunTime:0.0860s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0090s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0060s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0150s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0070s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100236'  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('109855') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0080s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100236'  [ RunTime:0.0070s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10130','10132','10266','10301','10302','10303','10307') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0240s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0130s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100236 LIMIT 1   [ RunTime:0.0100s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0070s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100236'  [ RunTime:0.0060s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10043') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0060s ]

[ 2018-09-21T11:58:34+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0100s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0080s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0240s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0080s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537502314','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0790s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0080s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0070s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0160s ]

[ 2018-09-21T11:58:38+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0090s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0290s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0090s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537502318','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100214\"}') [ RunTime:0.0670s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0090s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100214'  [ RunTime:0.0120s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('110312','109401') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0090s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100214'  [ RunTime:0.0070s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10104','10105','10106','10107','10108','10109','10110','10111','10112','10126','10128','10129','10264','10265','10308','10309','10310') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0180s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100214 LIMIT 1   [ RunTime:0.0060s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0140s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100214'  [ RunTime:0.0060s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10051','10087') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0080s ]

[ 2018-09-21T12:00:16+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001001s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002001s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0500s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0300s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0420s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.3300s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.9041s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537502412','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:3.0532s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0100s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0050s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0250s ]

[ 2018-09-21T12:00:20+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001001s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001001s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0090s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0140s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0380s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0160s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537502420','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100214\"}') [ RunTime:0.0540s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0150s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0150s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0100s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100214'  [ RunTime:0.0080s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('110312','109401') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0170s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0140s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100214'  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10104','10105','10106','10107','10108','10109','10110','10111','10112','10126','10128','10129','10264','10265','10308','10309','10310') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0170s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0120s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100214 LIMIT 1   [ RunTime:0.0120s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0120s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100214'  [ RunTime:0.0090s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10051','10087') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0090s ]

[ 2018-09-21T12:00:55+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0200s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.3090s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0110s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.2430s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0130s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537502454','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0700s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0090s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0120s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0060s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0270s ]

[ 2018-09-21T12:00:56+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0080s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0110s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0330s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0090s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537502455','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100214\"}') [ RunTime:0.0780s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0310s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0150s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0100s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100214'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('110312','109401') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0090s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100214'  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10104','10105','10106','10107','10108','10109','10110','10111','10112','10126','10128','10129','10264','10265','10308','10309','10310') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0140s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100214 LIMIT 1   [ RunTime:0.0070s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0220s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100214'  [ RunTime:0.0080s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10051','10087') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0040s ]

[ 2018-09-21T12:01:33+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0220s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0080s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0230s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0100s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537502492','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.3740s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0110s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0080s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.5200s ]

[ 2018-09-21T12:04:47+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0410s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0160s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0160s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.2090s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0920s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0180s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537502686','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.9771s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0280s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0310s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0520s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0080s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0760s ]

[ 2018-09-21T12:04:53+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0270s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0200s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:1.2291s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0250s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0240s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537502689','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100214\"}') [ RunTime:0.1120s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0240s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.3210s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0710s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0590s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0270s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0190s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0280s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0210s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100214'  [ RunTime:0.0120s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('110312','109401') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:1.1531s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0250s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100214'  [ RunTime:0.0140s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10104','10105','10106','10107','10108','10109','10110','10111','10112','10126','10128','10129','10264','10265','10308','10309','10310') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0350s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.3370s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100214 LIMIT 1   [ RunTime:0.0730s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.9031s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0670s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100214'  [ RunTime:0.0070s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10051','10087') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0390s ]

[ 2018-09-21T12:05:22+08:00 ] ::1 /Dwin/Production/editProductionOrder
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0330s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0160s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:21.9513s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/editproductionorder%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0260s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0410s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/editproductionorder','1537502722','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"100214\",\"create_t\":\"2018-08-23 14:35:53\",\"production_code\":\"SCJH-100214\",\"product_no\":\"15154\",\"product_id\":\"15154\",\"bom_id\":\"DW2018082360001\",\"product_name\":\"K600+\",\"production_line\":\"SMT\\u7ebf\",\"production_type\":\"\",\"start_t\":\"2018-08-23\",\"end_t\":\"2018-09-12\",\"production_status\":\"1\",\"plan_number\":\"100000\",\"assign_number\":\"26845\",\"actual_end_time\":\"0\",\"tips\":\"\\u6d4b\\u8bd5\\u5408\\u5e76\\u4e24\\u4e2a\\u540c\\u578b\\u53f7\\u7684\\u5355\\u636e\",\"create_id\":\"1\",\"create_name\":\"\",\"stock_status\":\"1\",\"remaining_day\":\"-5\",\"assigned_number\":\"0\",\"need_assign_num\":\"73155\",\"in_stock_num\":\"3099\",\"production_progress\":\"1\",\"stock_out_num\":\"3\",\"bom_num\":\"12\",\"sum(produce_out_num)\":\"612\",\"out_num\":\"36\",\"group_concat(produce_source_id)\":\"100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214\",\"group_concat(produce_out_num)\":\"36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36\",\"audit_status\":\"0\"}') [ RunTime:0.1650s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0140s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0300s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0320s ]

[ 2018-09-21T13:04:44+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0080s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0060s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0120s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0090s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537506284','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0580s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0070s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0120s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0210s ]

[ 2018-09-21T13:06:35+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0130s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0140s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537506393','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100214\"}') [ RunTime:0.0790s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.9031s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0080s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0180s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0090s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100214'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('110312','109401') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0070s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100214'  [ RunTime:0.0080s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10104','10105','10106','10107','10108','10109','10110','10111','10112','10126','10128','10129','10264','10265','10308','10309','10310') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0150s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100214 LIMIT 1   [ RunTime:0.0220s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0100s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100214'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10051','10087') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0030s ]

[ 2018-09-21T13:06:47+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0280s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537506406','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100214\"}') [ RunTime:0.0770s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0080s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0060s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0090s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100214'  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('110312','109401') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0100s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100214'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10104','10105','10106','10107','10108','10109','10110','10111','10112','10126','10128','10129','10264','10265','10308','10309','10310') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.3070s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100214 LIMIT 1   [ RunTime:0.0100s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0070s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100214'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10051','10087') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0050s ]

[ 2018-09-21T13:06:51+08:00 ] ::1 /Dwin/Production/editProductionOrder
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0110s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0300s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/editproductionorder%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0290s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/editproductionorder','1537506410','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"100214\",\"create_t\":\"2018-08-23 14:35:53\",\"production_code\":\"SCJH-100214\",\"product_no\":\"15154\",\"product_id\":\"15154\",\"bom_id\":\"DW2018082360001\",\"product_name\":\"K600+\",\"production_line\":\"SMT\\u7ebf\",\"production_type\":\"\",\"start_t\":\"2018-08-23\",\"end_t\":\"2018-09-16\",\"production_status\":\"1\",\"plan_number\":\"100001\",\"assign_number\":\"26845\",\"actual_end_time\":\"0\",\"tips\":\"\\u6d4b\\u8bd5\\u5408\\u5e76\\u4e24\\u4e2a\\u540c\\u578b\\u53f7\\u7684\\u5355\\u636e\",\"create_id\":\"1\",\"create_name\":\"\",\"stock_status\":\"1\",\"remaining_day\":\"-5\",\"assigned_number\":\"0\",\"need_assign_num\":\"73155\",\"in_stock_num\":\"3099\",\"production_progress\":\"1\",\"stock_out_num\":\"3\",\"bom_num\":\"12\",\"sum(produce_out_num)\":\"612\",\"out_num\":\"36\",\"group_concat(produce_source_id)\":\"100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214\",\"group_concat(produce_out_num)\":\"36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36\",\"audit_status\":\"0\"}') [ RunTime:0.0800s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0070s ]

[ 2018-09-21T13:08:58+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0090s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0100s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0190s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0120s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537506538','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.1170s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0090s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0060s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0100s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0030s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0180s ]

[ 2018-09-21T13:09:00+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0080s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0150s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.3090s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.2440s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0080s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537506540','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100214\"}') [ RunTime:0.1010s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0110s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0170s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0130s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0150s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0070s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100214'  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('110312','109401') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0130s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100214'  [ RunTime:0.0050s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10104','10105','10106','10107','10108','10109','10110','10111','10112','10126','10128','10129','10264','10265','10308','10309','10310') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0130s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100214 LIMIT 1   [ RunTime:0.0080s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0150s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100214'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10051','10087') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0060s ]

[ 2018-09-21T13:09:27+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0060s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0210s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0100s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537506567','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0870s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0150s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0070s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0040s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0180s ]

[ 2018-09-21T13:09:28+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0080s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0110s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0130s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0120s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537506568','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100214\"}') [ RunTime:0.0470s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0160s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0060s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100214'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('110312','109401') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0090s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100214'  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10104','10105','10106','10107','10108','10109','10110','10111','10112','10126','10128','10129','10264','10265','10308','10309','10310') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0100s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100214 LIMIT 1   [ RunTime:0.0040s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0070s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100214'  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10051','10087') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0030s ]

[ 2018-09-21T13:10:10+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.002000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.003000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0060s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0100s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0210s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537506610','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0880s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0090s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0070s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0070s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0220s ]

[ 2018-09-21T13:10:11+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0260s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0120s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0220s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537506611','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100214\"}') [ RunTime:0.0440s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0250s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0060s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0100s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100214'  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('110312','109401') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0160s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0100s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100214'  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10104','10105','10106','10107','10108','10109','10110','10111','10112','10126','10128','10129','10264','10265','10308','10309','10310') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0160s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100214 LIMIT 1   [ RunTime:0.0120s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0170s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100214'  [ RunTime:0.0050s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10051','10087') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0040s ]

[ 2018-09-21T13:12:21+08:00 ] ::1 /Dwin/Production/editProductionOrder
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0100s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0120s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0500s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/editproductionorder%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0100s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/editproductionorder','1537506741','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"100214\",\"create_t\":\"2018-08-23 14:35:53\",\"production_code\":\"SCJH-100214\",\"product_no\":\"15154\",\"product_id\":\"15154\",\"bom_id\":\"DW2018082360001\",\"product_name\":\"K600+\",\"production_line\":\"SMT\\u7ebf\",\"production_type\":\"\",\"start_t\":\"2018-08-23\",\"end_t\":\"2018-09-16\",\"production_status\":\"1\",\"plan_number\":\"100001\",\"assign_number\":\"26845\",\"actual_end_time\":\"0\",\"tips\":\"\\u6d4b\\u8bd5\\u5408\\u5e76\\u4e24\\u4e2a\\u540c\\u578b\\u53f7\\u7684\\u5355\\u636e\",\"create_id\":\"1\",\"create_name\":\"\",\"stock_status\":\"1\",\"remaining_day\":\"-5\",\"assigned_number\":\"0\",\"need_assign_num\":\"73155\",\"in_stock_num\":\"3099\",\"production_progress\":\"1\",\"stock_out_num\":\"3\",\"bom_num\":\"12\",\"sum(produce_out_num)\":\"612\",\"out_num\":\"36\",\"group_concat(produce_source_id)\":\"100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214\",\"group_concat(produce_out_num)\":\"36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36\",\"audit_status\":\"0\"}') [ RunTime:0.0840s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0170s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0170s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0080s ]

[ 2018-09-21T13:13:30+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0180s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0190s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0490s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0160s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537506810','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"2\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"asc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.3810s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0080s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0070s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0090s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0100s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num asc LIMIT 0,10   [ RunTime:0.0150s ]

[ 2018-09-21T13:13:35+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0140s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0100s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0490s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537506815','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"3\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0740s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0200s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0140s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0250s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0140s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0180s ]

[ 2018-09-21T13:13:40+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0110s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0130s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0170s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0580s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0190s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537506820','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"4\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"8\",\"dir\":\"asc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0610s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0240s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0050s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0200s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0040s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY start_t asc LIMIT 0,10   [ RunTime:0.0340s ]

[ 2018-09-21T13:13:42+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0190s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0100s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0420s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0130s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537506822','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"5\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"8\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0600s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0100s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0080s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0210s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0040s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY start_t desc LIMIT 0,10   [ RunTime:0.0210s ]

[ 2018-09-21T13:13:57+08:00 ] ::1 /Dwin/Production/showCompleteProductionPlan
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0080s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0130s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0180s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0550s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/showcompleteproductionplan%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0140s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('显示所有完工的生产计划',NULL,'394','::1','production/showcompleteproductionplan','1537506837','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_order\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"staff_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_cate_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_plan_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"create_time\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"delivery_time\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"complete_time\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"null\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"8\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}') [ RunTime:0.0800s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0130s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0140s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_auth_role` [ RunTime:0.0140s ]
SQL: SELECT `role_id`,`staff_ids` FROM `crm_auth_role` WHERE `role_id` IN (50)  [ RunTime:0.0050s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0170s ]
SQL: SELECT COUNT(plan.id) AS tp_count FROM crm_production_plan plan LEFT JOIN crm_industrial_seral_screen as product on plan.product_id = product.product_id  WHERE `production_status` = 5 AND `complete_time` > 1493568000 LIMIT 1   [ RunTime:0.0480s ]
SQL: SELECT COUNT(plan.id) AS tp_count FROM crm_production_plan plan LEFT JOIN crm_industrial_seral_screen as product on plan.product_id = product.product_id  WHERE `is_del` = 0 AND `production_status` = 5 AND `complete_time` > 1493568000 LIMIT 1   [ RunTime:0.0500s ]
SQL: SELECT plan.id,`production_order`,`staff_name`,`stock_cate_name`,plan.product_name,`production_line_name`,`production_plan_number`,plan.production_number,from_unixtime(create_time,'%y-%m-%d') create_time,from_unixtime(delivery_time,'%y-%m-%d') delivery_time,from_unixtime(complete_time) complete_time,`production_status`,ifnull(plan.tips,'无') tips FROM crm_production_plan plan WHERE `is_del` = 0 AND `production_status` = 5 AND `complete_time` > 1493568000 ORDER BY complete_time desc LIMIT 0,10   [ RunTime:0.0300s ]

[ 2018-09-21T13:14:08+08:00 ] ::1 /Dwin/Production/productionPlan
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0060s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0430s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionplan%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0150s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('展示生产计划',NULL,'394','::1','production/productionplan','1537506848','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_order\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"staff_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_cate_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"create_time\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"delivery_time\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"yqts\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_plan_rest_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"production_status\":\"\",\"production_line\":\"\"}') [ RunTime:0.0570s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0060s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_auth_role` [ RunTime:0.0120s ]
SQL: SELECT `role_id`,`staff_ids` FROM `crm_auth_role` WHERE `role_id` IN (50)  [ RunTime:0.0170s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0120s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_plan plan WHERE `production_status` IN ('1','2','3','4') AND plan.is_del = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') LIMIT 1   [ RunTime:0.0230s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_plan plan WHERE `production_status` IN ('1','2','3','4') AND plan.is_del = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') LIMIT 1   [ RunTime:0.0170s ]
SQL: SELECT plan.id,`production_order`,`staff_name`,`stock_cate_name`,plan.product_name,`production_line_name`,`production_plan_number`,plan.production_number,from_unixtime(create_time,'%y-%m-%d') create_time,from_unixtime(delivery_time,'%y-%m-%d') delivery_time,`production_status`,ifnull(plan.tips,'无') tips,delivery_time yqts,sum(stock.stock_number) stock_number,sum(stock.o_audit) o_audit,sum(product.production_number) product_num,sum(product.production_number) production_plan_rest_num FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id  WHERE `production_status` IN ('1','2','3','4') AND plan.is_del = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') GROUP BY plan.id ORDER BY create_time desc,plan.id desc LIMIT 0,10   [ RunTime:0.0480s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0110s ]
SQL: SELECT SUM(production_plan_rest_number) AS tp_sum FROM `crm_production_plan` WHERE `product_name` = '10.4寸保护膜' AND `production_line_name` = 'SMT线' AND `production_status` = 3 LIMIT 1   [ RunTime:0.0190s ]

[ 2018-09-21T13:14:09+08:00 ] ::1 /Dwin/Stock/showWarehouse
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0060s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0100s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0170s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%stock/showwarehouse%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('库房信息',NULL,'394','::1','stock/showwarehouse','1537506849','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"rep_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"repertory_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"manager_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"logistics_staff_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"display_level\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"0\",\"dir\":\"asc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}') [ RunTime:0.0710s ]
SQL: SHOW COLUMNS FROM `crm_repertorylist` [ RunTime:0.0110s ]
SQL: SELECT COUNT(rep_id) AS tp_count FROM `crm_repertorylist` LIMIT 1   [ RunTime:0.0040s ]
SQL: SELECT COUNT(distinct rep_id) AS tp_count FROM crm_repertorylist repertory LEFT JOIN crm_staff manager ON FIND_IN_SET(manager.id,repertory.warehouse_manager_id) LEFT JOIN crm_staff logistics_staff ON FIND_IN_SET(logistics_staff.id,repertory.logistics_staff_id)  WHERE `is_del` = 0 LIMIT 1   [ RunTime:0.0060s ]
SQL: SELECT repertory.*,group_concat(DISTINCT logistics_staff.name) logistics_staff_name,group_concat(DISTINCT manager.name) manager_name FROM crm_repertorylist repertory LEFT JOIN crm_staff manager ON FIND_IN_SET(manager.id,repertory.warehouse_manager_id) LEFT JOIN crm_staff logistics_staff ON FIND_IN_SET(logistics_staff.id,repertory.logistics_staff_id)  WHERE `is_del` = 0 GROUP BY rep_id ORDER BY rep_id asc LIMIT 0,10   [ RunTime:0.0110s ]

[ 2018-09-21T13:14:11+08:00 ] ::1 /Dwin/Stock/index
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0060s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0090s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0220s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%stock/index%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0140s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('显示所有库存数量',NULL,'394','::1','stock/index','1537506851','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"all_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"o_audit\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"out_processing\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"i_audit\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"rework_number\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"mouth_i_stock\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"mouth_o_stock\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"update_time\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"11\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"repoID\":\"\"}') [ RunTime:0.0780s ]
SQL: SHOW COLUMNS FROM `crm_material` [ RunTime:0.0140s ]
SQL: SELECT COUNT(*) AS tp_count FROM `crm_material` LIMIT 1   [ RunTime:0.0040s ]
SQL: SELECT COUNT(*) AS tp_count FROM `crm_material` LIMIT 1   [ RunTime:0.0080s ]
SQL: SELECT material.product_id,material.product_no,material.product_name,material.product_number,material.material_type,material.rework_number,material.production_number,material.safety_number,sum(stock_number) + sum(o_audit) all_number,sum(stock_number) stock_number,sum(o_audit) o_audit,sum(i_audit) i_audit,sum(out_processing) out_processing,material.safety_number - stock_number warning_number,from_unixtime(max(stock.update_time)) update_time FROM crm_material material LEFT JOIN crm_stock stock ON stock.product_id = material.product_id  WHERE `warehouse_number` IN ('K003','K004') GROUP BY material.product_id ORDER BY update_time desc LIMIT 0,10   [ RunTime:0.0230s ]

[ 2018-09-21T13:14:19+08:00 ] ::1 /Dwin/Production/productionPlan
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.002000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.003000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0060s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0090s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0260s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionplan%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`auth_rule_name`,`level`,`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('展示生产计划',NULL,'394','::1','production/productionplan','1537506858','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_order\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"staff_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_cate_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"create_time\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"delivery_time\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"yqts\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_plan_rest_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"production_status\":\"\",\"production_line\":\"\"}') [ RunTime:0.1050s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_auth_role` [ RunTime:0.0070s ]
SQL: SELECT `role_id`,`staff_ids` FROM `crm_auth_role` WHERE `role_id` IN (50)  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0120s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_plan plan WHERE `production_status` IN ('1','2','3','4') AND plan.is_del = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') LIMIT 1   [ RunTime:0.0190s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_plan plan WHERE `production_status` IN ('1','2','3','4') AND plan.is_del = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') LIMIT 1   [ RunTime:0.0370s ]
SQL: SELECT plan.id,`production_order`,`staff_name`,`stock_cate_name`,plan.product_name,`production_line_name`,`production_plan_number`,plan.production_number,from_unixtime(create_time,'%y-%m-%d') create_time,from_unixtime(delivery_time,'%y-%m-%d') delivery_time,`production_status`,ifnull(plan.tips,'无') tips,delivery_time yqts,sum(stock.stock_number) stock_number,sum(stock.o_audit) o_audit,sum(product.production_number) product_num,sum(product.production_number) production_plan_rest_num FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id  WHERE `production_status` IN ('1','2','3','4') AND plan.is_del = 0 AND `production_line_name` IN ('生产线','SMT线','装配线','生产线') GROUP BY plan.id ORDER BY create_time desc,plan.id desc LIMIT 0,10   [ RunTime:0.0340s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0140s ]
SQL: SELECT SUM(production_plan_rest_number) AS tp_sum FROM `crm_production_plan` WHERE `product_name` = '10.4寸保护膜' AND `production_line_name` = 'SMT线' AND `production_status` = 3 LIMIT 1   [ RunTime:0.0180s ]

[ 2018-09-21T13:14:20+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0110s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0340s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0140s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537506860','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0750s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0390s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0120s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0060s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0130s ]

[ 2018-09-21T13:14:28+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0100s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0080s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0220s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0150s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537506868','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100214\"}') [ RunTime:0.3330s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0130s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0070s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100214'  [ RunTime:0.0050s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('110312','109401') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0100s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100214'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10104','10105','10106','10107','10108','10109','10110','10111','10112','10126','10128','10129','10264','10265','10308','10309','10310') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0090s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100214 LIMIT 1   [ RunTime:0.0070s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0070s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100214'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10051','10087') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0100s ]

[ 2018-09-21T13:19:44+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0100s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0140s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0140s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537507183','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0810s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0090s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0090s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0070s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0040s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0170s ]

[ 2018-09-21T13:19:46+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.002000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.005001s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0110s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0110s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0180s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0080s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537507186','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100214\"}') [ RunTime:0.1080s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0090s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0090s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0080s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100214'  [ RunTime:0.0060s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('110312','109401') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0090s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100214'  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10104','10105','10106','10107','10108','10109','10110','10111','10112','10126','10128','10129','10264','10265','10308','10309','10310') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100214 LIMIT 1   [ RunTime:0.0050s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0110s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100214'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10051','10087') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0040s ]

[ 2018-09-21T13:19:56+08:00 ] ::1 /Dwin/Production/editProductionOrder
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0060s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0190s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/editproductionorder%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0120s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/editproductionorder','1537507196','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"100214\",\"create_t\":\"2018-08-23 14:35:53\",\"production_code\":\"SCJH-100214\",\"product_no\":\"15154\",\"product_id\":\"15154\",\"bom_id\":\"DW2018082360001\",\"product_name\":\"K600+\",\"production_line\":\"SMT\\u7ebf\",\"production_type\":\"\",\"start_t\":\"2018-08-23\",\"end_t\":\"2018-09-16\",\"production_status\":\"1\",\"plan_number\":\"100001\",\"assign_number\":\"26845\",\"actual_end_time\":\"0\",\"tips\":\"\\u6d4b\\u8bd5\\u5408\\u5e76\\u4e24\\u4e2a\\u540c\\u578b\\u53f7\\u7684\\u5355\\u636e\",\"create_id\":\"1\",\"create_name\":\"\",\"stock_status\":\"1\",\"remaining_day\":\"-5\",\"assigned_number\":\"0\",\"need_assign_num\":\"73155\",\"in_stock_num\":\"3099\",\"production_progress\":\"1\",\"stock_out_num\":\"3\",\"bom_num\":\"12\",\"sum(produce_out_num)\":\"612\",\"out_num\":\"36\",\"group_concat(produce_source_id)\":\"100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214,100214\",\"group_concat(produce_out_num)\":\"36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36\",\"audit_status\":\"0\"}') [ RunTime:0.0750s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0120s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0080s ]
SQL: SELECT * FROM `crm_production_task` WHERE `order_pid` = 100214 AND `is_del` = 0  [ RunTime:0.0050s ]

[ 2018-09-21T13:20:02+08:00 ] ::1 /Dwin/Production/getRelationDataWithOrderId
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.003000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0060s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0090s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0270s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/getrelationdatawithorderid%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/getrelationdatawithorderid','1537507201','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"productionOrderId\":\"100236\"}') [ RunTime:0.0750s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0240s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0130s ]
SQL: SHOW COLUMNS FROM `crm_production_plan` [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_material_bom_sub` [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_record` [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_production_relation` [ RunTime:0.0070s ]
SQL: SELECT production_plan_id plan_id FROM `crm_production_relation` WHERE `production_order_id` = '100236'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT plan.id,plan.production_order,plan.staff_name,plan.stock_cate,plan.stock_cate_name,plan.product_id,product.product_no,plan.product_name,plan.production_line_name,plan.production_plan_number,plan.production_line,plan.production_number,from_unixtime(plan.create_time,'%y-%m-%d') create_time,from_unixtime(plan.delivery_time,'%y-%m-%d') delivery_time,plan.production_status,ifnull(plan.tips,'无') tips,plan.delivery_time yqts,if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) actual_number,production_plan_number - if(sum(ifnull(ord.plan_number,0))>production_plan_number,`production_plan_number`,sum(ifnull(ord.plan_number,0))) rest_num,plan.scheduled_status FROM crm_production_plan plan LEFT JOIN crm_stock as stock on plan.product_id = stock.product_id LEFT JOIN crm_material as product on plan.product_id = product.product_id LEFT JOIN crm_production_relation rel ON rel.production_plan_id = plan.id LEFT JOIN crm_production_order ord ON ord.id = rel.production_order_id and ord.is_del = 0  WHERE plan.id IN ('109855') AND plan.is_del = 0 GROUP BY plan.id ORDER BY plan.id desc LIMIT 0,100   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_production_task_relation` [ RunTime:0.0140s ]
SQL: SELECT `task_id` FROM `crm_production_task_relation` WHERE `order_id` = '100236'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT order.production_code,task.product_id,task.product_no,line.production_line group_name,task.task_id,task.task_number,from_unixtime(task.task_start_time) start_t,from_unixtime(task.task_end_time) end_t,sum(ifnull(rec.num,0)) complete_quantity,from_unixtime(task.actual_end_time) actual_t FROM crm_production_task task LEFT JOIN crm_production_line line ON line.id = task.task_group LEFT JOIN crm_production_order `order` ON `order`.id = task.order_pid LEFT JOIN crm_stock_in_production sip ON sip.source_id = task.id LEFT JOIN crm_stock_in_record rec ON (rec.source_id = sip.id AND rec.product_id = task.product_id)  WHERE task.id IN ('10130','10132','10266','10301','10302','10303','10307') AND task.is_del = 0 GROUP BY task.id  [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0120s ]
SQL: SELECT * FROM `crm_production_order` WHERE `id` = 100236 LIMIT 1   [ RunTime:0.0090s ]
SQL: SELECT a.*,bom.bom_id,bom.bom_type_name bom_cate,bom.product_no production_product,group_concat(sub.substituted_no) substituted_no,if (count(sub.id),1,0) has_sub FROM crm_material_bom_sub a LEFT JOIN crm_material_bom bom ON bom.id = a.bom_pid LEFT JOIN (SELECT a.*,b.product_no substituted_no from crm_material_substitute a LEFT JOIN crm_material b ON a.substituted_id = b.product_id) sub ON sub.product_id = a.product_id and sub.is_del = 0  WHERE a.bom_pid = '60001' AND a.is_del = 0 GROUP BY a.id  [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_stock_out_produce` [ RunTime:0.0100s ]
SQL: SELECT `id` FROM `crm_stock_out_produce` WHERE `source_id` = '100236'  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT a.product_id,a.product_no,c.product_name,a.repertory_id rep_id_out,'K20' rep_id_in,d.stock_number stock_total_number,sum(a.num) num_all,count(distinct b.id) times FROM crm_stock_out_record a LEFT JOIN crm_stock_out_produce b ON a.source_id = b.id LEFT JOIN crm_material c ON a.product_id = c.product_id LEFT JOIN crm_stock d ON d.product_id = a.product_id and d.warehouse_number = a.repertory_id  WHERE a.source_id IN ('10043') AND a.is_del = 0 GROUP BY a.product_id,a.repertory_id  [ RunTime:0.0040s ]

[ 2018-09-21T13:20:08+08:00 ] ::1 /Dwin/Production/editProductionOrder
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0060s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0110s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/editproductionorder%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0080s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/editproductionorder','1537507208','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"100236\",\"create_t\":\"2018-08-23 15:13:19\",\"production_code\":\"SCJH-100236\",\"product_no\":\"15154\",\"product_id\":\"15154\",\"bom_id\":\"DW2018082360001\",\"product_name\":\"K600+\",\"production_line\":\"SMT\\u7ebf\",\"production_type\":\"\",\"start_t\":\"2018-03-28\",\"end_t\":\"2018-04-11\",\"production_status\":\"2\",\"plan_number\":\"30001\",\"assign_number\":\"30000\",\"actual_end_time\":\"0\",\"tips\":\"\\u6d4b\\u8bd5BOMId\\u548c\\u4e0a\\u4f20\\u6570\\u91cf\\u62c6\\u5355\",\"create_id\":\"1\",\"create_name\":\"\",\"stock_status\":\"1\",\"remaining_day\":\"-163\",\"assigned_number\":\"0\",\"need_assign_num\":\"0\",\"in_stock_num\":\"\",\"production_progress\":\"2\",\"stock_out_num\":\"1\",\"bom_num\":\"12\",\"sum(produce_out_num)\":\"84\",\"out_num\":\"12\",\"group_concat(produce_source_id)\":\"100236,100236,100236,100236,100236,100236,100236\",\"group_concat(produce_out_num)\":\"12,12,12,12,12,12,12\",\"audit_status\":\"0\"}') [ RunTime:0.0520s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0080s ]
SQL: SELECT * FROM `crm_production_task` WHERE `order_pid` = 100236 AND `is_del` = 0  [ RunTime:0.0050s ]

[ 2018-09-21T13:20:36+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0080s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0080s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0190s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0060s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537507236','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0960s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0130s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0090s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0140s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0030s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0140s ]

[ 2018-09-21T13:20:42+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0130s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0160s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0130s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0250s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537507242','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0850s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0030s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0090s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0050s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0120s ]

[ 2018-09-21T13:20:42+08:00 ] ::1 /Dwin/Production/productionTaskIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0060s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0060s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0130s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productiontaskindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0110s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productiontaskindex','1537507242','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"task_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"task_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"task_line_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"task_group_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"task_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"complete_quantity\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"actual_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"0,1,2\"}') [ RunTime:0.0480s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0090s ]
NOTIC: [8] Undefined index: a.pid F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\ProductionLineModel.class.php 第 69 行.
SQL: SELECT a.id,a.production_line group_name,a.pid,a.manufacturability group_ability,b.production_line line_name FROM crm_production_line a LEFT JOIN crm_production_line b ON b.id = a.pid  WHERE a.is_del = 0 AND a.pid <> 0 LIMIT 0,100   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_production_task` [ RunTime:0.0070s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT task.id,from_unixtime(task.create_time) create_time,task.task_id,task.product_no,task.product_id,material.warehouse_id default_rep_id,task.task_number,task.task_line,task.task_group,task.production_type,from_unixtime(task.task_start_time,'%y-%m-%d') start_t,from_unixtime(task.task_end_time,'%y-%m-%d') end_t,task.production_status,sum(ifnull(sip.in_num,0)) complete_quantity,ifnull(from_unixtime(task.actual_end_time,'%y-%m-%d'),' ') actual_t,task.tips,task.create_id,task.create_name,line1.production_line task_line_name,line2.production_line task_group_name,produce_order.production_code order_code FROM crm_production_task task LEFT JOIN crm_production_line line1 ON line1.id = task_line LEFT JOIN crm_production_line line2 ON line2.id = task_group LEFT JOIN crm_material material ON material.product_id = task.product_id LEFT JOIN crm_production_order produce_order ON task.order_pid = produce_order.id LEFT JOIN (select a.*,sum(ifnull(b.num,0)) in_num from crm_stock_in_production a left join crm_stock_in_record b on a.id = b.source_id group by a.id) sip ON task.id = sip.source_id and sip.is_del = 0  WHERE task.task_group IN ('100','101','102','103','104','105','106','107','108') AND task.production_status IN ('0','1','2') AND task.is_del = 0 GROUP BY task.id ORDER BY start_t desc LIMIT 0,10   [ RunTime:0.0050s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_task task WHERE task.task_group IN ('100','101','102','103','104','105','106','107','108') AND task.production_status IN ('0','1','2') LIMIT 1   [ RunTime:0.0120s ]

[ 2018-09-21T13:20:56+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0140s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0210s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0400s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0530s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537507256','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"2\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"25\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0840s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0110s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0040s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0130s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0130s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,25   [ RunTime:0.0590s ]

[ 2018-09-21T13:20:58+08:00 ] ::1 /Dwin/Production/productionOrderIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.002000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.003000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0100s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0310s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0330s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%production/productionorderindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0270s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','production/productionorderindex','1537507258','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"3\",\"columns\":[{\"data\":\"production_code\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_line\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"product_no\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"bom_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"plan_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_out_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assign_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"in_stock_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"start_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"end_t\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"remaining_day\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"assigned_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"need_assign_num\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"stock_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_progress\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"tips\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"7\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"lineLimit\":\"\",\"statusLimit\":\"\",\"status\":\"\"}') [ RunTime:0.0840s ]
SQL: SHOW COLUMNS FROM `crm_production_line` [ RunTime:0.0130s ]
SQL: SELECT * FROM `crm_production_line` WHERE ( pid = 0 and is_del = 0 )  [ RunTime:0.0020s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SHOW COLUMNS FROM `crm_production_order` [ RunTime:0.0130s ]
SQL: SELECT COUNT(*) AS tp_count FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN crm_material_bom bom ON bom.id = ord.bom_pid  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 LIMIT 1   [ RunTime:0.0110s ]
SQL: SELECT ord.id,from_unixtime(ord.create_time) create_t,ord.production_code,material.product_no,material.product_id,bom.bom_id,material.product_name,line.production_line,ord.production_type,from_unixtime(ord.plan_start_time,'%Y-%m-%d') start_t,from_unixtime(ord.plan_end_time,'%Y-%m-%d') end_t,ord.production_status,ord.plan_number,sum(ifnull(task.task_number,0)) assign_number,ord.actual_end_time,ifnull(ord.tips,'无') tips,ord.create_id,ord.create_name,ord.stock_status,(round((ord.plan_end_time - 1537459200) /86400)) remaining_day,sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end) assigned_number,round((case when ord.plan_end_time < 1537459200 then round(ord.plan_number - sum(ifnull(task.task_number,0))) when ord.plan_start_time > 1537459200 then 0 else (case when (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end))) > (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end)) then (ord.plan_number/((case when (ord.plan_end_time - 1537459200) > 0 then (ord.plan_end_time - 1537459200)/86400 else 1 end)) - (sum(case when task.task_start_time = 1537459200 then task.task_number else 0 end))) else 0 end) end)) need_assign_num,sum(task.nums) in_stock_num,`production_progress`,round((ifnull(produce.out_num,0))/(bom.bom_num)) stock_out_num,bom.bom_num,sum(produce.out_num),produce.out_num,group_concat(produce.source_id),group_concat(produce.out_num),ord.audit_status FROM crm_production_order ord LEFT JOIN crm_material material on material.product_id  = ord.product_id LEFT JOIN crm_production_line line ON line.id = ord.production_line LEFT JOIN  
                        (select mb.*,sum(mbs.num) bom_num 
                            from crm_material_bom mb 
                            LEFT JOIN crm_material_bom_sub mbs 
                                ON (mbs.bom_pid = mb.id and mbs.is_del = 0)
                            group by mb.id) 
                            bom 
                        ON bom.id = ord.bom_pid LEFT JOIN 
                        (select t.*,sum(sip.num_s) nums
                            from crm_production_task t
                         left join 
                            (select a.is_del,a.source_id,sum(ifnull(b.num,0)) num_s 
                                 from crm_stock_in_production a
                             left join crm_stock_in_record b 
                                 on (b.source_id = a.id and b.is_del = 0)
                             group by a.id) sip on sip.source_id = t.id and sip.is_del = 0 group by t.id)  task ON (task.order_pid = ord.id and task.is_del = 0) LEFT JOIN 
                        (select sop.source_id,sop.is_del,sum(ifnull(sor.num,0)) out_num 
                            from crm_stock_out_produce sop 
                            left join crm_stock_out_record sor 
                                on (sop.id = sor.source_id and sor.is_del = 0)
                            where sop.is_del = 0 
                            group by sop.source_id,sop.is_del)
                         produce ON produce.source_id = ord.id and produce.is_del = 0  WHERE ord.audit_status = '' AND ord.production_line IN ('1','2','3') AND ord.production_status IN ('0','1','2') AND ord.is_del = 0 GROUP BY ord.id ORDER BY in_stock_num desc LIMIT 0,10   [ RunTime:0.0170s ]

[ 2018-09-21T13:22:50+08:00 ] ::1 /Dwin/Office/productionDelayComplain
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0120s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0100s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0370s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%office/productiondelaycomplain%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','office/productiondelaycomplain','1537507370','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"create_time\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"complain_reason\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"proposer_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"status_str\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"false\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"research\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"processes\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"handler\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"processes_validity\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"liable\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"false\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"auditor\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"production_order\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"1\",\"dir\":\"desc\"}],\"start\":\"0\",\"length\":\"10\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}') [ RunTime:0.0720s ]
SQL: SHOW COLUMNS FROM `crm_staff_info` [ RunTime:0.0180s ]
SQL: SHOW COLUMNS FROM `crm_production_delay_complain` [ RunTime:0.0120s ]
SQL: SELECT COUNT(*) AS tp_count FROM `crm_production_delay_complain` LIMIT 1   [ RunTime:0.0300s ]
SQL: SELECT COUNT(*) AS tp_count FROM `crm_production_delay_complain` WHERE `is_del` = 0 LIMIT 1   [ RunTime:0.0080s ]
SQL: SELECT * FROM `crm_production_delay_complain` WHERE `is_del` = 0 ORDER BY create_time desc LIMIT 0,10   [ RunTime:0.0140s ]
SQL: SELECT `id`,concat(name,'-',department) as name FROM `crm_staff_info` WHERE `on_job` = 1  [ RunTime:0.1470s ]
NOTIC: [8] Undefined index:  F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Controller\OfficeController.class.php 第 73 行.
NOTIC: [8] Undefined index:  F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Controller\OfficeController.class.php 第 73 行.
NOTIC: [8] Undefined index:  F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Controller\OfficeController.class.php 第 73 行.
NOTIC: [8] Undefined index:  F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Controller\OfficeController.class.php 第 73 行.
NOTIC: [8] Undefined index:  F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Controller\OfficeController.class.php 第 73 行.
NOTIC: [8] Undefined index:  F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Controller\OfficeController.class.php 第 73 行.
NOTIC: [8] Undefined index:  F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Controller\OfficeController.class.php 第 73 行.
NOTIC: [8] Undefined index:  F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Controller\OfficeController.class.php 第 73 行.
NOTIC: [8] Undefined index:  F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Controller\OfficeController.class.php 第 73 行.
NOTIC: [8] Undefined index:  F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Controller\OfficeController.class.php 第 73 行.

[ 2018-09-21T13:23:15+08:00 ] ::1 /Dwin/Purchase/supplierIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0140s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0100s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0490s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/supplierindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0120s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/supplierindex','1537507394','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"1\",\"columns\":[{\"data\":\"supplier_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"charge_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"supplier_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"business_licence\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"enterprise_cate\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"legal_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_bank\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"audit_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"second_audit\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"0\",\"dir\":\"asc\"}],\"start\":\"0\",\"length\":\"25\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"function\":\"undefined\",\"staffLimit\":\"1\",\"audit_status\":\"1\"}') [ RunTime:0.0810s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0110s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 785 行.
SQL: SELECT p.*,crm_staff.name,(
                    CASE
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '0' THEN 0 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '2' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '20' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '02' THEN 2 
                    ELSE 1
                    END 
                  ) AS second_audit,group_concat(DISTINCT(a.status)) FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid ORDER BY supplier_id asc LIMIT 0,25   [ RunTime:0.0150s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 796 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0170s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 803 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0190s ]

[ 2018-09-21T13:23:19+08:00 ] ::1 /Dwin/Purchase/getSupplierAllMsg
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0140s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0230s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getsupplierallmsg%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0090s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getsupplierallmsg','1537507398','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"68\"}') [ RunTime:0.0770s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_address` [ RunTime:0.0110s ]
SQL: SELECT crm_purchase_supplier_address.*,crm_staff.name FROM `crm_purchase_supplier_address` left join crm_staff on crm_staff.id = crm_purchase_supplier_address.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '68'  [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_contact` [ RunTime:0.0110s ]
SQL: SELECT crm_purchase_supplier_contact.*,crm_staff.name FROM `crm_purchase_supplier_contact` left join crm_staff on crm_staff.id = crm_purchase_supplier_contact.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '68'  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_certification` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_certification.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_certification` left join crm_staff on crm_staff.id = crm_purchase_supplier_certification.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_certification.file_id  WHERE `is_del` = 0 AND `supplier_pid` = '68'  [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_awards` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_awards.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_awards` left join crm_staff on crm_staff.id = crm_purchase_supplier_awards.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_awards.file_id  WHERE `is_del` = 0 AND `supplier_pid` = '68'  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_customer` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_customer.*,crm_staff.name FROM `crm_purchase_supplier_customer` left join crm_staff on crm_staff.id = crm_purchase_supplier_customer.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '68'  [ RunTime:0.0220s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_equity` [ RunTime:0.0060s ]
SQL: SELECT crm_purchase_supplier_equity.*,crm_staff.name FROM `crm_purchase_supplier_equity` left join crm_staff on crm_staff.id = crm_purchase_supplier_equity.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '68'  [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_finance` [ RunTime:0.0120s ]
SQL: SELECT * FROM `crm_purchase_supplier_finance` WHERE `supplier_pid` = '68' AND `is_del` = 0  [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_team` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_team.*,crm_staff.name FROM `crm_purchase_supplier_team` left join crm_staff on crm_staff.id = crm_purchase_supplier_team.create_id  WHERE `supplier_pid` = '68' AND `is_del` = 0  [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_cooperation` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_cooperation.*,crm_staff.name FROM `crm_purchase_supplier_cooperation` left join crm_staff on crm_staff.id = crm_purchase_supplier_cooperation.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '68'  [ RunTime:0.0350s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_audit` [ RunTime:0.0110s ]
SQL: SELECT crm_purchase_supplier_audit.*,crm_variable_type.name as type_name,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_audit` INNER JOIN crm_variable_type on crm_variable_type.id = crm_purchase_supplier_audit.audit_id left join crm_staff on crm_staff.id = crm_purchase_supplier_audit.staff_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_audit.file_id  WHERE crm_purchase_supplier_audit.supplier_pid = '68' AND crm_variable_type.status = 1  [ RunTime:0.0050s ]

[ 2018-09-21T13:24:06+08:00 ] ::1 /Dwin/Purchase/supplierIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0100s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0190s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0140s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/supplierindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/supplierindex','1537507446','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"2\",\"columns\":[{\"data\":\"supplier_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"charge_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"supplier_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"business_licence\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"enterprise_cate\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"legal_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_bank\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"audit_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"second_audit\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"0\",\"dir\":\"asc\"}],\"start\":\"0\",\"length\":\"25\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"function\":\"undefined\",\"staffLimit\":\"1\",\"audit_status\":\"1\"}') [ RunTime:0.0730s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0080s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 785 行.
SQL: SELECT p.*,crm_staff.name,(
                    CASE
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '0' THEN 0 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '2' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '20' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '02' THEN 2 
                    ELSE 1
                    END 
                  ) AS second_audit,group_concat(DISTINCT(a.status)) FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid ORDER BY supplier_id asc LIMIT 0,25   [ RunTime:0.0200s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 796 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0180s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 803 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0110s ]

[ 2018-09-21T13:24:08+08:00 ] ::1 /Dwin/Purchase/getSupplierAllMsg
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0080s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0120s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0120s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getsupplierallmsg%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0020s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0090s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getsupplierallmsg','1537507448','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"10327\"}') [ RunTime:0.0650s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_address` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_address.*,crm_staff.name FROM `crm_purchase_supplier_address` left join crm_staff on crm_staff.id = crm_purchase_supplier_address.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10327'  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_contact` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_contact.*,crm_staff.name FROM `crm_purchase_supplier_contact` left join crm_staff on crm_staff.id = crm_purchase_supplier_contact.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10327'  [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_certification` [ RunTime:0.0130s ]
SQL: SELECT crm_purchase_supplier_certification.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_certification` left join crm_staff on crm_staff.id = crm_purchase_supplier_certification.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_certification.file_id  WHERE `is_del` = 0 AND `supplier_pid` = '10327'  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_awards` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_awards.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_awards` left join crm_staff on crm_staff.id = crm_purchase_supplier_awards.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_awards.file_id  WHERE `is_del` = 0 AND `supplier_pid` = '10327'  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_customer` [ RunTime:0.0100s ]
SQL: SELECT crm_purchase_supplier_customer.*,crm_staff.name FROM `crm_purchase_supplier_customer` left join crm_staff on crm_staff.id = crm_purchase_supplier_customer.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10327'  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_equity` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_equity.*,crm_staff.name FROM `crm_purchase_supplier_equity` left join crm_staff on crm_staff.id = crm_purchase_supplier_equity.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10327'  [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_finance` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_purchase_supplier_finance` WHERE `supplier_pid` = '10327' AND `is_del` = 0  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_team` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_team.*,crm_staff.name FROM `crm_purchase_supplier_team` left join crm_staff on crm_staff.id = crm_purchase_supplier_team.create_id  WHERE `supplier_pid` = '10327' AND `is_del` = 0  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_cooperation` [ RunTime:0.0090s ]
SQL: SELECT crm_purchase_supplier_cooperation.*,crm_staff.name FROM `crm_purchase_supplier_cooperation` left join crm_staff on crm_staff.id = crm_purchase_supplier_cooperation.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10327'  [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_audit` [ RunTime:0.0060s ]
SQL: SELECT crm_purchase_supplier_audit.*,crm_variable_type.name as type_name,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_audit` INNER JOIN crm_variable_type on crm_variable_type.id = crm_purchase_supplier_audit.audit_id left join crm_staff on crm_staff.id = crm_purchase_supplier_audit.staff_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_audit.file_id  WHERE crm_purchase_supplier_audit.supplier_pid = '10327' AND crm_variable_type.status = 1  [ RunTime:0.0040s ]

[ 2018-09-21T13:24:09+08:00 ] ::1 /Dwin/Purchase/getSupplierAllMsg
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0060s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0060s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0190s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getsupplierallmsg%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0120s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getsupplierallmsg','1537507449','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"10350\"}') [ RunTime:0.0480s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_address` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_address.*,crm_staff.name FROM `crm_purchase_supplier_address` left join crm_staff on crm_staff.id = crm_purchase_supplier_address.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10350'  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_contact` [ RunTime:0.0090s ]
SQL: SELECT crm_purchase_supplier_contact.*,crm_staff.name FROM `crm_purchase_supplier_contact` left join crm_staff on crm_staff.id = crm_purchase_supplier_contact.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10350'  [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_certification` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_certification.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_certification` left join crm_staff on crm_staff.id = crm_purchase_supplier_certification.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_certification.file_id  WHERE `is_del` = 0 AND `supplier_pid` = '10350'  [ RunTime:0.0280s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_awards` [ RunTime:0.0150s ]
SQL: SELECT crm_purchase_supplier_awards.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_awards` left join crm_staff on crm_staff.id = crm_purchase_supplier_awards.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_awards.file_id  WHERE `is_del` = 0 AND `supplier_pid` = '10350'  [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_customer` [ RunTime:0.0100s ]
SQL: SELECT crm_purchase_supplier_customer.*,crm_staff.name FROM `crm_purchase_supplier_customer` left join crm_staff on crm_staff.id = crm_purchase_supplier_customer.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10350'  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_equity` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_equity.*,crm_staff.name FROM `crm_purchase_supplier_equity` left join crm_staff on crm_staff.id = crm_purchase_supplier_equity.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10350'  [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_finance` [ RunTime:0.0130s ]
SQL: SELECT * FROM `crm_purchase_supplier_finance` WHERE `supplier_pid` = '10350' AND `is_del` = 0  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_team` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_team.*,crm_staff.name FROM `crm_purchase_supplier_team` left join crm_staff on crm_staff.id = crm_purchase_supplier_team.create_id  WHERE `supplier_pid` = '10350' AND `is_del` = 0  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_cooperation` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_cooperation.*,crm_staff.name FROM `crm_purchase_supplier_cooperation` left join crm_staff on crm_staff.id = crm_purchase_supplier_cooperation.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10350'  [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_audit` [ RunTime:0.0090s ]
SQL: SELECT crm_purchase_supplier_audit.*,crm_variable_type.name as type_name,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_audit` INNER JOIN crm_variable_type on crm_variable_type.id = crm_purchase_supplier_audit.audit_id left join crm_staff on crm_staff.id = crm_purchase_supplier_audit.staff_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_audit.file_id  WHERE crm_purchase_supplier_audit.supplier_pid = '10350' AND crm_variable_type.status = 1  [ RunTime:0.0060s ]

[ 2018-09-21T13:24:12+08:00 ] ::1 /Dwin/Purchase/getSupplier.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0080s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0150s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getsupplier%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getsupplier','1537507452','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"10350\"}') [ RunTime:0.0650s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0100s ]
SQL: SELECT * FROM `crm_purchase_supplier` WHERE `is_del` = 0 AND `id` = '10350' LIMIT 1   [ RunTime:0.0080s ]

[ 2018-09-21T13:24:21+08:00 ] ::1 /Dwin/Purchase/getSupplierAllMsg
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.002000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.003000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0080s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.2170s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getsupplierallmsg%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0080s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getsupplierallmsg','1537507460','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"\"}') [ RunTime:0.0770s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_address` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_address.*,crm_staff.name FROM `crm_purchase_supplier_address` left join crm_staff on crm_staff.id = crm_purchase_supplier_address.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_contact` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_contact.*,crm_staff.name FROM `crm_purchase_supplier_contact` left join crm_staff on crm_staff.id = crm_purchase_supplier_contact.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_certification` [ RunTime:0.0140s ]
SQL: SELECT crm_purchase_supplier_certification.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_certification` left join crm_staff on crm_staff.id = crm_purchase_supplier_certification.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_certification.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_awards` [ RunTime:0.0100s ]
SQL: SELECT crm_purchase_supplier_awards.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_awards` left join crm_staff on crm_staff.id = crm_purchase_supplier_awards.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_awards.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_customer` [ RunTime:0.0210s ]
SQL: SELECT crm_purchase_supplier_customer.*,crm_staff.name FROM `crm_purchase_supplier_customer` left join crm_staff on crm_staff.id = crm_purchase_supplier_customer.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_equity` [ RunTime:0.0100s ]
SQL: SELECT crm_purchase_supplier_equity.*,crm_staff.name FROM `crm_purchase_supplier_equity` left join crm_staff on crm_staff.id = crm_purchase_supplier_equity.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_finance` [ RunTime:0.0100s ]
SQL: SELECT * FROM `crm_purchase_supplier_finance` WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_team` [ RunTime:0.0130s ]
SQL: SELECT crm_purchase_supplier_team.*,crm_staff.name FROM `crm_purchase_supplier_team` left join crm_staff on crm_staff.id = crm_purchase_supplier_team.create_id  WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0020s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_cooperation` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_cooperation.*,crm_staff.name FROM `crm_purchase_supplier_cooperation` left join crm_staff on crm_staff.id = crm_purchase_supplier_cooperation.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.5130s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_audit` [ RunTime:0.0140s ]
SQL: SELECT crm_purchase_supplier_audit.*,crm_variable_type.name as type_name,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_audit` INNER JOIN crm_variable_type on crm_variable_type.id = crm_purchase_supplier_audit.audit_id left join crm_staff on crm_staff.id = crm_purchase_supplier_audit.staff_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_audit.file_id  WHERE crm_purchase_supplier_audit.supplier_pid = '' AND crm_variable_type.status = 1  [ RunTime:0.0050s ]

[ 2018-09-21T13:24:21+08:00 ] ::1 /Dwin/Purchase/supplierIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.003000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0080s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0080s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0190s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/supplierindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0120s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/supplierindex','1537507461','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"3\",\"columns\":[{\"data\":\"supplier_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"charge_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"supplier_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"business_licence\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"enterprise_cate\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"legal_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_bank\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"audit_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"second_audit\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"0\",\"dir\":\"asc\"}],\"start\":\"0\",\"length\":\"25\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"function\":\"undefined\",\"staffLimit\":\"1\",\"audit_status\":\"1\"}') [ RunTime:0.0900s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0090s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 785 行.
SQL: SELECT p.*,crm_staff.name,(
                    CASE
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '0' THEN 0 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '2' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '20' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '02' THEN 2 
                    ELSE 1
                    END 
                  ) AS second_audit,group_concat(DISTINCT(a.status)) FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid ORDER BY supplier_id asc LIMIT 0,25   [ RunTime:0.0110s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 796 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0170s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 803 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0320s ]

[ 2018-09-21T13:24:22+08:00 ] ::1 /Dwin/Purchase/getSupplier.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0080s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0210s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getsupplier%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getsupplier','1537507462','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"\"}') [ RunTime:0.0780s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0100s ]
SQL: SELECT * FROM `crm_purchase_supplier` WHERE `is_del` = 0 AND `id` = '' LIMIT 1   [ RunTime:0.0080s ]

[ 2018-09-21T13:24:32+08:00 ] ::1 /Dwin/Purchase/supplierIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0080s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0120s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0180s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/supplierindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0110s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/supplierindex','1537507472','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"4\",\"columns\":[{\"data\":\"supplier_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"charge_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"supplier_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"business_licence\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"enterprise_cate\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"legal_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_bank\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"audit_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"second_audit\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"0\",\"dir\":\"asc\"}],\"start\":\"0\",\"length\":\"25\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"function\":\"undefined\",\"staffLimit\":\"1\",\"audit_status\":\"1\"}') [ RunTime:0.1380s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0080s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 785 行.
SQL: SELECT p.*,crm_staff.name,(
                    CASE
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '0' THEN 0 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '2' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '20' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '02' THEN 2 
                    ELSE 1
                    END 
                  ) AS second_audit,group_concat(DISTINCT(a.status)) FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid ORDER BY supplier_id asc LIMIT 0,25   [ RunTime:0.0170s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 796 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0090s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 803 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0180s ]

[ 2018-09-21T13:24:33+08:00 ] ::1 /Dwin/Purchase/getSupplierAllMsg
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.003000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0140s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0140s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getsupplierallmsg%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0080s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getsupplierallmsg','1537507472','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"\"}') [ RunTime:0.8140s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_address` [ RunTime:0.0100s ]
SQL: SELECT crm_purchase_supplier_address.*,crm_staff.name FROM `crm_purchase_supplier_address` left join crm_staff on crm_staff.id = crm_purchase_supplier_address.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_contact` [ RunTime:0.0090s ]
SQL: SELECT crm_purchase_supplier_contact.*,crm_staff.name FROM `crm_purchase_supplier_contact` left join crm_staff on crm_staff.id = crm_purchase_supplier_contact.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_certification` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_certification.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_certification` left join crm_staff on crm_staff.id = crm_purchase_supplier_certification.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_certification.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_awards` [ RunTime:0.0110s ]
SQL: SELECT crm_purchase_supplier_awards.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_awards` left join crm_staff on crm_staff.id = crm_purchase_supplier_awards.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_awards.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_customer` [ RunTime:0.0110s ]
SQL: SELECT crm_purchase_supplier_customer.*,crm_staff.name FROM `crm_purchase_supplier_customer` left join crm_staff on crm_staff.id = crm_purchase_supplier_customer.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_equity` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_equity.*,crm_staff.name FROM `crm_purchase_supplier_equity` left join crm_staff on crm_staff.id = crm_purchase_supplier_equity.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_finance` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_purchase_supplier_finance` WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_team` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_team.*,crm_staff.name FROM `crm_purchase_supplier_team` left join crm_staff on crm_staff.id = crm_purchase_supplier_team.create_id  WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_cooperation` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_cooperation.*,crm_staff.name FROM `crm_purchase_supplier_cooperation` left join crm_staff on crm_staff.id = crm_purchase_supplier_cooperation.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_audit` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_audit.*,crm_variable_type.name as type_name,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_audit` INNER JOIN crm_variable_type on crm_variable_type.id = crm_purchase_supplier_audit.audit_id left join crm_staff on crm_staff.id = crm_purchase_supplier_audit.staff_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_audit.file_id  WHERE crm_purchase_supplier_audit.supplier_pid = '' AND crm_variable_type.status = 1  [ RunTime:0.0080s ]

[ 2018-09-21T13:24:34+08:00 ] ::1 /Dwin/Purchase/getSupplierAllMsg
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001001s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001001s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0060s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0190s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getsupplierallmsg%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0080s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getsupplierallmsg','1537507474','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"10327\"}') [ RunTime:0.1370s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_address` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_address.*,crm_staff.name FROM `crm_purchase_supplier_address` left join crm_staff on crm_staff.id = crm_purchase_supplier_address.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10327'  [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_contact` [ RunTime:0.0110s ]
SQL: SELECT crm_purchase_supplier_contact.*,crm_staff.name FROM `crm_purchase_supplier_contact` left join crm_staff on crm_staff.id = crm_purchase_supplier_contact.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10327'  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_certification` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_certification.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_certification` left join crm_staff on crm_staff.id = crm_purchase_supplier_certification.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_certification.file_id  WHERE `is_del` = 0 AND `supplier_pid` = '10327'  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_awards` [ RunTime:0.0090s ]
SQL: SELECT crm_purchase_supplier_awards.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_awards` left join crm_staff on crm_staff.id = crm_purchase_supplier_awards.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_awards.file_id  WHERE `is_del` = 0 AND `supplier_pid` = '10327'  [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_customer` [ RunTime:0.0110s ]
SQL: SELECT crm_purchase_supplier_customer.*,crm_staff.name FROM `crm_purchase_supplier_customer` left join crm_staff on crm_staff.id = crm_purchase_supplier_customer.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10327'  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_equity` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_equity.*,crm_staff.name FROM `crm_purchase_supplier_equity` left join crm_staff on crm_staff.id = crm_purchase_supplier_equity.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10327'  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_finance` [ RunTime:0.0080s ]
SQL: SELECT * FROM `crm_purchase_supplier_finance` WHERE `supplier_pid` = '10327' AND `is_del` = 0  [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_team` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_team.*,crm_staff.name FROM `crm_purchase_supplier_team` left join crm_staff on crm_staff.id = crm_purchase_supplier_team.create_id  WHERE `supplier_pid` = '10327' AND `is_del` = 0  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_cooperation` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_cooperation.*,crm_staff.name FROM `crm_purchase_supplier_cooperation` left join crm_staff on crm_staff.id = crm_purchase_supplier_cooperation.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10327'  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_audit` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_audit.*,crm_variable_type.name as type_name,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_audit` INNER JOIN crm_variable_type on crm_variable_type.id = crm_purchase_supplier_audit.audit_id left join crm_staff on crm_staff.id = crm_purchase_supplier_audit.staff_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_audit.file_id  WHERE crm_purchase_supplier_audit.supplier_pid = '10327' AND crm_variable_type.status = 1  [ RunTime:0.0040s ]

[ 2018-09-21T13:24:37+08:00 ] ::1 /Dwin/Purchase/getSupplier.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0060s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0290s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getsupplier%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getsupplier','1537507477','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"10327\"}') [ RunTime:0.0620s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_purchase_supplier` WHERE `is_del` = 0 AND `id` = '10327' LIMIT 1   [ RunTime:0.0040s ]

[ 2018-09-21T13:41:43+08:00 ] ::1 /Dwin/Purchase/supplierIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002001s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0090s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0110s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0200s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/supplierindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/supplierindex','1537508503','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"5\",\"columns\":[{\"data\":\"supplier_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"charge_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"supplier_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"business_licence\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"enterprise_cate\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"legal_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_bank\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"audit_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"second_audit\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"0\",\"dir\":\"asc\"}],\"start\":\"0\",\"length\":\"25\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"function\":\"undefined\",\"staffLimit\":\"1\",\"audit_status\":\"1\"}') [ RunTime:0.0850s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0150s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 785 行.
SQL: SELECT p.*,crm_staff.name,(
                    CASE
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '0' THEN 0 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '2' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '20' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '02' THEN 2 
                    ELSE 1
                    END 
                  ) AS second_audit,group_concat(DISTINCT(a.status)) FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid ORDER BY supplier_id asc LIMIT 0,25   [ RunTime:0.0200s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 796 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0250s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 803 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0210s ]

[ 2018-09-21T13:41:44+08:00 ] ::1 /Dwin/Purchase/getSupplierAllMsg
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0060s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0180s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getsupplierallmsg%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getsupplierallmsg','1537508504','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"\"}') [ RunTime:0.0390s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_address` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_address.*,crm_staff.name FROM `crm_purchase_supplier_address` left join crm_staff on crm_staff.id = crm_purchase_supplier_address.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_contact` [ RunTime:0.0100s ]
SQL: SELECT crm_purchase_supplier_contact.*,crm_staff.name FROM `crm_purchase_supplier_contact` left join crm_staff on crm_staff.id = crm_purchase_supplier_contact.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_certification` [ RunTime:0.0090s ]
SQL: SELECT crm_purchase_supplier_certification.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_certification` left join crm_staff on crm_staff.id = crm_purchase_supplier_certification.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_certification.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_awards` [ RunTime:0.0350s ]
SQL: SELECT crm_purchase_supplier_awards.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_awards` left join crm_staff on crm_staff.id = crm_purchase_supplier_awards.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_awards.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0150s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_customer` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_customer.*,crm_staff.name FROM `crm_purchase_supplier_customer` left join crm_staff on crm_staff.id = crm_purchase_supplier_customer.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_equity` [ RunTime:0.0100s ]
SQL: SELECT crm_purchase_supplier_equity.*,crm_staff.name FROM `crm_purchase_supplier_equity` left join crm_staff on crm_staff.id = crm_purchase_supplier_equity.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_finance` [ RunTime:0.0080s ]
SQL: SELECT * FROM `crm_purchase_supplier_finance` WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_team` [ RunTime:0.0120s ]
SQL: SELECT crm_purchase_supplier_team.*,crm_staff.name FROM `crm_purchase_supplier_team` left join crm_staff on crm_staff.id = crm_purchase_supplier_team.create_id  WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_cooperation` [ RunTime:0.0150s ]
SQL: SELECT crm_purchase_supplier_cooperation.*,crm_staff.name FROM `crm_purchase_supplier_cooperation` left join crm_staff on crm_staff.id = crm_purchase_supplier_cooperation.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0150s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_audit` [ RunTime:0.0090s ]
SQL: SELECT crm_purchase_supplier_audit.*,crm_variable_type.name as type_name,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_audit` INNER JOIN crm_variable_type on crm_variable_type.id = crm_purchase_supplier_audit.audit_id left join crm_staff on crm_staff.id = crm_purchase_supplier_audit.staff_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_audit.file_id  WHERE crm_purchase_supplier_audit.supplier_pid = '' AND crm_variable_type.status = 1  [ RunTime:0.0070s ]

[ 2018-09-21T13:41:45+08:00 ] ::1 /Dwin/Purchase/getContact.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0160s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0320s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getcontact%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0090s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getcontact','1537508505','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"\"}') [ RunTime:0.0720s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_contact` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_contact.*,crm_staff.name FROM `crm_purchase_supplier_contact` left join crm_staff on crm_staff.id = crm_purchase_supplier_contact.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0040s ]

[ 2018-09-21T13:41:49+08:00 ] ::1 /Dwin/Purchase/supplierIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0110s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0080s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0190s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/supplierindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0170s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/supplierindex','1537508509','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"6\",\"columns\":[{\"data\":\"supplier_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"charge_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"supplier_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"business_licence\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"enterprise_cate\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"legal_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_bank\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"audit_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"second_audit\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"0\",\"dir\":\"asc\"}],\"start\":\"0\",\"length\":\"25\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"function\":\"undefined\",\"staffLimit\":\"1\",\"audit_status\":\"1\"}') [ RunTime:0.0710s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0080s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 785 行.
SQL: SELECT p.*,crm_staff.name,(
                    CASE
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '0' THEN 0 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '2' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '20' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '02' THEN 2 
                    ELSE 1
                    END 
                  ) AS second_audit,group_concat(DISTINCT(a.status)) FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid ORDER BY supplier_id asc LIMIT 0,25   [ RunTime:0.0140s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 796 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0350s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 803 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0150s ]

[ 2018-09-21T13:41:50+08:00 ] ::1 /Dwin/Purchase/getSupplierAllMsg
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0130s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0210s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getsupplierallmsg%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0110s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getsupplierallmsg','1537508510','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"\"}') [ RunTime:0.0380s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0220s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_address` [ RunTime:0.0240s ]
SQL: SELECT crm_purchase_supplier_address.*,crm_staff.name FROM `crm_purchase_supplier_address` left join crm_staff on crm_staff.id = crm_purchase_supplier_address.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_contact` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_contact.*,crm_staff.name FROM `crm_purchase_supplier_contact` left join crm_staff on crm_staff.id = crm_purchase_supplier_contact.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_certification` [ RunTime:0.0200s ]
SQL: SELECT crm_purchase_supplier_certification.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_certification` left join crm_staff on crm_staff.id = crm_purchase_supplier_certification.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_certification.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0130s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_awards` [ RunTime:0.0090s ]
SQL: SELECT crm_purchase_supplier_awards.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_awards` left join crm_staff on crm_staff.id = crm_purchase_supplier_awards.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_awards.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0190s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_customer` [ RunTime:0.0090s ]
SQL: SELECT crm_purchase_supplier_customer.*,crm_staff.name FROM `crm_purchase_supplier_customer` left join crm_staff on crm_staff.id = crm_purchase_supplier_customer.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_equity` [ RunTime:0.0090s ]
SQL: SELECT crm_purchase_supplier_equity.*,crm_staff.name FROM `crm_purchase_supplier_equity` left join crm_staff on crm_staff.id = crm_purchase_supplier_equity.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_finance` [ RunTime:0.0140s ]
SQL: SELECT * FROM `crm_purchase_supplier_finance` WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_team` [ RunTime:0.0110s ]
SQL: SELECT crm_purchase_supplier_team.*,crm_staff.name FROM `crm_purchase_supplier_team` left join crm_staff on crm_staff.id = crm_purchase_supplier_team.create_id  WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_cooperation` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_cooperation.*,crm_staff.name FROM `crm_purchase_supplier_cooperation` left join crm_staff on crm_staff.id = crm_purchase_supplier_cooperation.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_audit` [ RunTime:0.0100s ]
SQL: SELECT crm_purchase_supplier_audit.*,crm_variable_type.name as type_name,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_audit` INNER JOIN crm_variable_type on crm_variable_type.id = crm_purchase_supplier_audit.audit_id left join crm_staff on crm_staff.id = crm_purchase_supplier_audit.staff_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_audit.file_id  WHERE crm_purchase_supplier_audit.supplier_pid = '' AND crm_variable_type.status = 1  [ RunTime:0.0060s ]

[ 2018-09-21T13:41:51+08:00 ] ::1 /Dwin/Purchase/getTeam.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0140s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0220s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getteam%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0140s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getteam','1537508511','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"\"}') [ RunTime:0.0790s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_team` [ RunTime:0.0100s ]
SQL: SELECT crm_purchase_supplier_team.*,crm_staff.name FROM `crm_purchase_supplier_team` left join crm_staff on crm_staff.id = crm_purchase_supplier_team.create_id  WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0080s ]

[ 2018-09-21T13:41:56+08:00 ] ::1 /Dwin/Purchase/getSupplierAllMsg
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0080s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0300s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0510s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getsupplierallmsg%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0170s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getsupplierallmsg','1537508516','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"\"}') [ RunTime:0.0970s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_address` [ RunTime:0.0190s ]
SQL: SELECT crm_purchase_supplier_address.*,crm_staff.name FROM `crm_purchase_supplier_address` left join crm_staff on crm_staff.id = crm_purchase_supplier_address.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_contact` [ RunTime:0.0120s ]
SQL: SELECT crm_purchase_supplier_contact.*,crm_staff.name FROM `crm_purchase_supplier_contact` left join crm_staff on crm_staff.id = crm_purchase_supplier_contact.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0280s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_certification` [ RunTime:0.0160s ]
SQL: SELECT crm_purchase_supplier_certification.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_certification` left join crm_staff on crm_staff.id = crm_purchase_supplier_certification.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_certification.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0240s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_awards` [ RunTime:0.0200s ]
SQL: SELECT crm_purchase_supplier_awards.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_awards` left join crm_staff on crm_staff.id = crm_purchase_supplier_awards.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_awards.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_customer` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_customer.*,crm_staff.name FROM `crm_purchase_supplier_customer` left join crm_staff on crm_staff.id = crm_purchase_supplier_customer.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_equity` [ RunTime:0.0390s ]
SQL: SELECT crm_purchase_supplier_equity.*,crm_staff.name FROM `crm_purchase_supplier_equity` left join crm_staff on crm_staff.id = crm_purchase_supplier_equity.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0170s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_finance` [ RunTime:0.0170s ]
SQL: SELECT * FROM `crm_purchase_supplier_finance` WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_team` [ RunTime:0.0130s ]
SQL: SELECT crm_purchase_supplier_team.*,crm_staff.name FROM `crm_purchase_supplier_team` left join crm_staff on crm_staff.id = crm_purchase_supplier_team.create_id  WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_cooperation` [ RunTime:0.0100s ]
SQL: SELECT crm_purchase_supplier_cooperation.*,crm_staff.name FROM `crm_purchase_supplier_cooperation` left join crm_staff on crm_staff.id = crm_purchase_supplier_cooperation.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_audit` [ RunTime:0.0140s ]
SQL: SELECT crm_purchase_supplier_audit.*,crm_variable_type.name as type_name,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_audit` INNER JOIN crm_variable_type on crm_variable_type.id = crm_purchase_supplier_audit.audit_id left join crm_staff on crm_staff.id = crm_purchase_supplier_audit.staff_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_audit.file_id  WHERE crm_purchase_supplier_audit.supplier_pid = '' AND crm_variable_type.status = 1  [ RunTime:0.0070s ]

[ 2018-09-21T13:41:57+08:00 ] ::1 /Dwin/Purchase/supplierIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.002001s ]
INFO: [ app_begin ] --END-- [ RunTime:0.003001s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0130s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0160s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0300s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/supplierindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0120s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/supplierindex','1537508516','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"7\",\"columns\":[{\"data\":\"supplier_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"charge_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"supplier_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"business_licence\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"enterprise_cate\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"legal_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_bank\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"audit_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"second_audit\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"0\",\"dir\":\"asc\"}],\"start\":\"0\",\"length\":\"25\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"function\":\"undefined\",\"staffLimit\":\"1\",\"audit_status\":\"1\"}') [ RunTime:0.0690s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0130s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 785 行.
SQL: SELECT p.*,crm_staff.name,(
                    CASE
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '0' THEN 0 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '2' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '20' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '02' THEN 2 
                    ELSE 1
                    END 
                  ) AS second_audit,group_concat(DISTINCT(a.status)) FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid ORDER BY supplier_id asc LIMIT 0,25   [ RunTime:0.0360s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 796 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0150s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 803 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0140s ]

[ 2018-09-21T13:41:58+08:00 ] ::1 /Dwin/Purchase/getSupplierAllMsg
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0100s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0170s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0240s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getsupplierallmsg%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0090s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getsupplierallmsg','1537508518','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"10327\"}') [ RunTime:0.0720s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_address` [ RunTime:0.0090s ]
SQL: SELECT crm_purchase_supplier_address.*,crm_staff.name FROM `crm_purchase_supplier_address` left join crm_staff on crm_staff.id = crm_purchase_supplier_address.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10327'  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_contact` [ RunTime:0.0210s ]
SQL: SELECT crm_purchase_supplier_contact.*,crm_staff.name FROM `crm_purchase_supplier_contact` left join crm_staff on crm_staff.id = crm_purchase_supplier_contact.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10327'  [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_certification` [ RunTime:0.0100s ]
SQL: SELECT crm_purchase_supplier_certification.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_certification` left join crm_staff on crm_staff.id = crm_purchase_supplier_certification.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_certification.file_id  WHERE `is_del` = 0 AND `supplier_pid` = '10327'  [ RunTime:0.0180s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_awards` [ RunTime:0.0100s ]
SQL: SELECT crm_purchase_supplier_awards.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_awards` left join crm_staff on crm_staff.id = crm_purchase_supplier_awards.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_awards.file_id  WHERE `is_del` = 0 AND `supplier_pid` = '10327'  [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_customer` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_customer.*,crm_staff.name FROM `crm_purchase_supplier_customer` left join crm_staff on crm_staff.id = crm_purchase_supplier_customer.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10327'  [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_equity` [ RunTime:0.0180s ]
SQL: SELECT crm_purchase_supplier_equity.*,crm_staff.name FROM `crm_purchase_supplier_equity` left join crm_staff on crm_staff.id = crm_purchase_supplier_equity.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10327'  [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_finance` [ RunTime:0.0100s ]
SQL: SELECT * FROM `crm_purchase_supplier_finance` WHERE `supplier_pid` = '10327' AND `is_del` = 0  [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_team` [ RunTime:0.0120s ]
SQL: SELECT crm_purchase_supplier_team.*,crm_staff.name FROM `crm_purchase_supplier_team` left join crm_staff on crm_staff.id = crm_purchase_supplier_team.create_id  WHERE `supplier_pid` = '10327' AND `is_del` = 0  [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_cooperation` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_cooperation.*,crm_staff.name FROM `crm_purchase_supplier_cooperation` left join crm_staff on crm_staff.id = crm_purchase_supplier_cooperation.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10327'  [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_audit` [ RunTime:0.0190s ]
SQL: SELECT crm_purchase_supplier_audit.*,crm_variable_type.name as type_name,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_audit` INNER JOIN crm_variable_type on crm_variable_type.id = crm_purchase_supplier_audit.audit_id left join crm_staff on crm_staff.id = crm_purchase_supplier_audit.staff_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_audit.file_id  WHERE crm_purchase_supplier_audit.supplier_pid = '10327' AND crm_variable_type.status = 1  [ RunTime:0.0060s ]

[ 2018-09-21T13:41:59+08:00 ] ::1 /Dwin/Purchase/getSupplierAllMsg
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0130s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0170s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getsupplierallmsg%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0200s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0220s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getsupplierallmsg','1537508518','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"10326\"}') [ RunTime:0.0900s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_address` [ RunTime:0.0100s ]
SQL: SELECT crm_purchase_supplier_address.*,crm_staff.name FROM `crm_purchase_supplier_address` left join crm_staff on crm_staff.id = crm_purchase_supplier_address.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10326'  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_contact` [ RunTime:0.0220s ]
SQL: SELECT crm_purchase_supplier_contact.*,crm_staff.name FROM `crm_purchase_supplier_contact` left join crm_staff on crm_staff.id = crm_purchase_supplier_contact.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10326'  [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_certification` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_certification.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_certification` left join crm_staff on crm_staff.id = crm_purchase_supplier_certification.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_certification.file_id  WHERE `is_del` = 0 AND `supplier_pid` = '10326'  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_awards` [ RunTime:0.0170s ]
SQL: SELECT crm_purchase_supplier_awards.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_awards` left join crm_staff on crm_staff.id = crm_purchase_supplier_awards.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_awards.file_id  WHERE `is_del` = 0 AND `supplier_pid` = '10326'  [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_customer` [ RunTime:0.0160s ]
SQL: SELECT crm_purchase_supplier_customer.*,crm_staff.name FROM `crm_purchase_supplier_customer` left join crm_staff on crm_staff.id = crm_purchase_supplier_customer.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10326'  [ RunTime:0.0300s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_equity` [ RunTime:0.0110s ]
SQL: SELECT crm_purchase_supplier_equity.*,crm_staff.name FROM `crm_purchase_supplier_equity` left join crm_staff on crm_staff.id = crm_purchase_supplier_equity.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10326'  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_finance` [ RunTime:0.0130s ]
SQL: SELECT * FROM `crm_purchase_supplier_finance` WHERE `supplier_pid` = '10326' AND `is_del` = 0  [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_team` [ RunTime:0.0210s ]
SQL: SELECT crm_purchase_supplier_team.*,crm_staff.name FROM `crm_purchase_supplier_team` left join crm_staff on crm_staff.id = crm_purchase_supplier_team.create_id  WHERE `supplier_pid` = '10326' AND `is_del` = 0  [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_cooperation` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_cooperation.*,crm_staff.name FROM `crm_purchase_supplier_cooperation` left join crm_staff on crm_staff.id = crm_purchase_supplier_cooperation.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10326'  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_audit` [ RunTime:0.0150s ]
SQL: SELECT crm_purchase_supplier_audit.*,crm_variable_type.name as type_name,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_audit` INNER JOIN crm_variable_type on crm_variable_type.id = crm_purchase_supplier_audit.audit_id left join crm_staff on crm_staff.id = crm_purchase_supplier_audit.staff_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_audit.file_id  WHERE crm_purchase_supplier_audit.supplier_pid = '10326' AND crm_variable_type.status = 1  [ RunTime:0.0030s ]

[ 2018-09-21T13:42:02+08:00 ] ::1 /Dwin/Purchase/getFinance.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0130s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0100s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0300s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getfinance%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getfinance','1537508522','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\" 10326\"}') [ RunTime:0.0680s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0160s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_finance` [ RunTime:0.0150s ]
SQL: SELECT * FROM `crm_purchase_supplier_finance` WHERE `supplier_pid` = ' 10326' AND `is_del` = 0  [ RunTime:0.0240s ]

[ 2018-09-21T13:42:08+08:00 ] ::1 /Dwin/Purchase/supplierIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002001s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0170s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0130s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0260s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/supplierindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0130s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0190s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/supplierindex','1537508528','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"8\",\"columns\":[{\"data\":\"supplier_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"charge_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"supplier_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"business_licence\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"enterprise_cate\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"legal_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_bank\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"audit_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"second_audit\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"0\",\"dir\":\"asc\"}],\"start\":\"0\",\"length\":\"25\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"function\":\"undefined\",\"staffLimit\":\"1\",\"audit_status\":\"1\"}') [ RunTime:0.0720s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0150s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 785 行.
SQL: SELECT p.*,crm_staff.name,(
                    CASE
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '0' THEN 0 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '2' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '20' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '02' THEN 2 
                    ELSE 1
                    END 
                  ) AS second_audit,group_concat(DISTINCT(a.status)) FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid ORDER BY supplier_id asc LIMIT 0,25   [ RunTime:0.0180s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 796 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0330s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 803 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0410s ]

[ 2018-09-21T13:42:09+08:00 ] ::1 /Dwin/Purchase/getSupplierAllMsg
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.004001s ]
INFO: [ app_begin ] --END-- [ RunTime:0.005001s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0080s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0080s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0490s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getsupplierallmsg%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0130s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0110s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getsupplierallmsg','1537508529','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"\"}') [ RunTime:0.0490s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0200s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_address` [ RunTime:0.0120s ]
SQL: SELECT crm_purchase_supplier_address.*,crm_staff.name FROM `crm_purchase_supplier_address` left join crm_staff on crm_staff.id = crm_purchase_supplier_address.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_contact` [ RunTime:0.0120s ]
SQL: SELECT crm_purchase_supplier_contact.*,crm_staff.name FROM `crm_purchase_supplier_contact` left join crm_staff on crm_staff.id = crm_purchase_supplier_contact.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_certification` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_certification.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_certification` left join crm_staff on crm_staff.id = crm_purchase_supplier_certification.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_certification.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_awards` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_awards.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_awards` left join crm_staff on crm_staff.id = crm_purchase_supplier_awards.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_awards.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0150s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_customer` [ RunTime:0.0090s ]
SQL: SELECT crm_purchase_supplier_customer.*,crm_staff.name FROM `crm_purchase_supplier_customer` left join crm_staff on crm_staff.id = crm_purchase_supplier_customer.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_equity` [ RunTime:0.0090s ]
SQL: SELECT crm_purchase_supplier_equity.*,crm_staff.name FROM `crm_purchase_supplier_equity` left join crm_staff on crm_staff.id = crm_purchase_supplier_equity.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_finance` [ RunTime:0.0130s ]
SQL: SELECT * FROM `crm_purchase_supplier_finance` WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_team` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_team.*,crm_staff.name FROM `crm_purchase_supplier_team` left join crm_staff on crm_staff.id = crm_purchase_supplier_team.create_id  WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0180s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_cooperation` [ RunTime:0.0110s ]
SQL: SELECT crm_purchase_supplier_cooperation.*,crm_staff.name FROM `crm_purchase_supplier_cooperation` left join crm_staff on crm_staff.id = crm_purchase_supplier_cooperation.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0160s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_audit` [ RunTime:0.0180s ]
SQL: SELECT crm_purchase_supplier_audit.*,crm_variable_type.name as type_name,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_audit` INNER JOIN crm_variable_type on crm_variable_type.id = crm_purchase_supplier_audit.audit_id left join crm_staff on crm_staff.id = crm_purchase_supplier_audit.staff_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_audit.file_id  WHERE crm_purchase_supplier_audit.supplier_pid = '' AND crm_variable_type.status = 1  [ RunTime:0.0030s ]

[ 2018-09-21T13:42:10+08:00 ] ::1 /Dwin/Purchase/getAwards.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0100s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0190s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getawards%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0410s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0130s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getawards','1537508530','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"\"}') [ RunTime:0.0580s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_awards` [ RunTime:0.0060s ]
SQL: SELECT crm_purchase_supplier_awards.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_awards` left join crm_staff on crm_staff.id = crm_purchase_supplier_awards.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_awards.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0110s ]

[ 2018-09-21T13:42:12+08:00 ] ::1 /Dwin/Purchase/getSupplierAllMsg
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0110s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0100s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0260s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getsupplierallmsg%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0090s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getsupplierallmsg','1537508532','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"\"}') [ RunTime:0.0820s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_address` [ RunTime:0.0170s ]
SQL: SELECT crm_purchase_supplier_address.*,crm_staff.name FROM `crm_purchase_supplier_address` left join crm_staff on crm_staff.id = crm_purchase_supplier_address.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_contact` [ RunTime:0.0160s ]
SQL: SELECT crm_purchase_supplier_contact.*,crm_staff.name FROM `crm_purchase_supplier_contact` left join crm_staff on crm_staff.id = crm_purchase_supplier_contact.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_certification` [ RunTime:0.0120s ]
SQL: SELECT crm_purchase_supplier_certification.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_certification` left join crm_staff on crm_staff.id = crm_purchase_supplier_certification.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_certification.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0160s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_awards` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_awards.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_awards` left join crm_staff on crm_staff.id = crm_purchase_supplier_awards.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_awards.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_customer` [ RunTime:0.0090s ]
SQL: SELECT crm_purchase_supplier_customer.*,crm_staff.name FROM `crm_purchase_supplier_customer` left join crm_staff on crm_staff.id = crm_purchase_supplier_customer.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0130s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_equity` [ RunTime:0.0130s ]
SQL: SELECT crm_purchase_supplier_equity.*,crm_staff.name FROM `crm_purchase_supplier_equity` left join crm_staff on crm_staff.id = crm_purchase_supplier_equity.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_finance` [ RunTime:0.0080s ]
SQL: SELECT * FROM `crm_purchase_supplier_finance` WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_team` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_team.*,crm_staff.name FROM `crm_purchase_supplier_team` left join crm_staff on crm_staff.id = crm_purchase_supplier_team.create_id  WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_cooperation` [ RunTime:0.0130s ]
SQL: SELECT crm_purchase_supplier_cooperation.*,crm_staff.name FROM `crm_purchase_supplier_cooperation` left join crm_staff on crm_staff.id = crm_purchase_supplier_cooperation.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_audit` [ RunTime:0.0090s ]
SQL: SELECT crm_purchase_supplier_audit.*,crm_variable_type.name as type_name,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_audit` INNER JOIN crm_variable_type on crm_variable_type.id = crm_purchase_supplier_audit.audit_id left join crm_staff on crm_staff.id = crm_purchase_supplier_audit.staff_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_audit.file_id  WHERE crm_purchase_supplier_audit.supplier_pid = '' AND crm_variable_type.status = 1  [ RunTime:0.0060s ]

[ 2018-09-21T13:42:12+08:00 ] ::1 /Dwin/Purchase/supplierIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0060s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0170s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/supplierindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/supplierindex','1537508532','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"9\",\"columns\":[{\"data\":\"supplier_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"charge_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"supplier_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"business_licence\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"enterprise_cate\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"legal_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_bank\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"audit_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"second_audit\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"0\",\"dir\":\"asc\"}],\"start\":\"0\",\"length\":\"25\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"function\":\"undefined\",\"staffLimit\":\"1\",\"audit_status\":\"1\"}') [ RunTime:0.0840s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0080s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 785 行.
SQL: SELECT p.*,crm_staff.name,(
                    CASE
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '0' THEN 0 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '2' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '20' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '02' THEN 2 
                    ELSE 1
                    END 
                  ) AS second_audit,group_concat(DISTINCT(a.status)) FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid ORDER BY supplier_id asc LIMIT 0,25   [ RunTime:0.0130s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 796 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0240s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 803 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0150s ]

[ 2018-09-21T13:42:14+08:00 ] ::1 /Dwin/Purchase/getCooperation.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0250s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0090s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0400s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getcooperation%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0190s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getcooperation','1537508533','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"\"}') [ RunTime:0.0720s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_cooperation` [ RunTime:0.0550s ]
SQL: SELECT crm_purchase_supplier_cooperation.*,crm_staff.name FROM `crm_purchase_supplier_cooperation` left join crm_staff on crm_staff.id = crm_purchase_supplier_cooperation.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0200s ]

[ 2018-09-21T13:42:15+08:00 ] ::1 /Dwin/Purchase/supplierIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0090s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0260s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/supplierindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0110s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/supplierindex','1537508535','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"10\",\"columns\":[{\"data\":\"supplier_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"charge_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"supplier_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"business_licence\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"enterprise_cate\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"legal_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_bank\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"audit_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"second_audit\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"0\",\"dir\":\"asc\"}],\"start\":\"0\",\"length\":\"25\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"function\":\"undefined\",\"staffLimit\":\"1\",\"audit_status\":\"1\"}') [ RunTime:0.0750s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0140s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 785 行.
SQL: SELECT p.*,crm_staff.name,(
                    CASE
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '0' THEN 0 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '2' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '20' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '02' THEN 2 
                    ELSE 1
                    END 
                  ) AS second_audit,group_concat(DISTINCT(a.status)) FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid ORDER BY supplier_id asc LIMIT 0,25   [ RunTime:0.0220s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 796 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0130s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 803 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0210s ]

[ 2018-09-21T13:42:15+08:00 ] ::1 /Dwin/Purchase/getSupplierAllMsg
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0060s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0110s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getsupplierallmsg%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0130s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getsupplierallmsg','1537508535','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"\"}') [ RunTime:0.0820s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_address` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_address.*,crm_staff.name FROM `crm_purchase_supplier_address` left join crm_staff on crm_staff.id = crm_purchase_supplier_address.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.3230s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_contact` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_contact.*,crm_staff.name FROM `crm_purchase_supplier_contact` left join crm_staff on crm_staff.id = crm_purchase_supplier_contact.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_certification` [ RunTime:0.0130s ]
SQL: SELECT crm_purchase_supplier_certification.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_certification` left join crm_staff on crm_staff.id = crm_purchase_supplier_certification.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_certification.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_awards` [ RunTime:0.0100s ]
SQL: SELECT crm_purchase_supplier_awards.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_awards` left join crm_staff on crm_staff.id = crm_purchase_supplier_awards.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_awards.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0180s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_customer` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_customer.*,crm_staff.name FROM `crm_purchase_supplier_customer` left join crm_staff on crm_staff.id = crm_purchase_supplier_customer.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_equity` [ RunTime:0.0160s ]
SQL: SELECT crm_purchase_supplier_equity.*,crm_staff.name FROM `crm_purchase_supplier_equity` left join crm_staff on crm_staff.id = crm_purchase_supplier_equity.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_finance` [ RunTime:0.0090s ]
SQL: SELECT * FROM `crm_purchase_supplier_finance` WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_team` [ RunTime:0.0090s ]
SQL: SELECT crm_purchase_supplier_team.*,crm_staff.name FROM `crm_purchase_supplier_team` left join crm_staff on crm_staff.id = crm_purchase_supplier_team.create_id  WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_cooperation` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_cooperation.*,crm_staff.name FROM `crm_purchase_supplier_cooperation` left join crm_staff on crm_staff.id = crm_purchase_supplier_cooperation.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_audit` [ RunTime:0.0100s ]
SQL: SELECT crm_purchase_supplier_audit.*,crm_variable_type.name as type_name,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_audit` INNER JOIN crm_variable_type on crm_variable_type.id = crm_purchase_supplier_audit.audit_id left join crm_staff on crm_staff.id = crm_purchase_supplier_audit.staff_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_audit.file_id  WHERE crm_purchase_supplier_audit.supplier_pid = '' AND crm_variable_type.status = 1  [ RunTime:0.0140s ]

[ 2018-09-21T13:42:17+08:00 ] ::1 /Dwin/Purchase/getSupplierAllMsg
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.3370s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0090s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.2290s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getsupplierallmsg%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0100s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getsupplierallmsg','1537508537','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"10323\"}') [ RunTime:0.0530s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_address` [ RunTime:0.0120s ]
SQL: SELECT crm_purchase_supplier_address.*,crm_staff.name FROM `crm_purchase_supplier_address` left join crm_staff on crm_staff.id = crm_purchase_supplier_address.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10323'  [ RunTime:0.0130s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_contact` [ RunTime:0.0200s ]
SQL: SELECT crm_purchase_supplier_contact.*,crm_staff.name FROM `crm_purchase_supplier_contact` left join crm_staff on crm_staff.id = crm_purchase_supplier_contact.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10323'  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_certification` [ RunTime:0.0090s ]
SQL: SELECT crm_purchase_supplier_certification.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_certification` left join crm_staff on crm_staff.id = crm_purchase_supplier_certification.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_certification.file_id  WHERE `is_del` = 0 AND `supplier_pid` = '10323'  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_awards` [ RunTime:0.0090s ]
SQL: SELECT crm_purchase_supplier_awards.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_awards` left join crm_staff on crm_staff.id = crm_purchase_supplier_awards.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_awards.file_id  WHERE `is_del` = 0 AND `supplier_pid` = '10323'  [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_customer` [ RunTime:0.0100s ]
SQL: SELECT crm_purchase_supplier_customer.*,crm_staff.name FROM `crm_purchase_supplier_customer` left join crm_staff on crm_staff.id = crm_purchase_supplier_customer.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10323'  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_equity` [ RunTime:0.0140s ]
SQL: SELECT crm_purchase_supplier_equity.*,crm_staff.name FROM `crm_purchase_supplier_equity` left join crm_staff on crm_staff.id = crm_purchase_supplier_equity.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10323'  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_finance` [ RunTime:0.0080s ]
SQL: SELECT * FROM `crm_purchase_supplier_finance` WHERE `supplier_pid` = '10323' AND `is_del` = 0  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_team` [ RunTime:0.0150s ]
SQL: SELECT crm_purchase_supplier_team.*,crm_staff.name FROM `crm_purchase_supplier_team` left join crm_staff on crm_staff.id = crm_purchase_supplier_team.create_id  WHERE `supplier_pid` = '10323' AND `is_del` = 0  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_cooperation` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_cooperation.*,crm_staff.name FROM `crm_purchase_supplier_cooperation` left join crm_staff on crm_staff.id = crm_purchase_supplier_cooperation.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10323'  [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_audit` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_audit.*,crm_variable_type.name as type_name,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_audit` INNER JOIN crm_variable_type on crm_variable_type.id = crm_purchase_supplier_audit.audit_id left join crm_staff on crm_staff.id = crm_purchase_supplier_audit.staff_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_audit.file_id  WHERE crm_purchase_supplier_audit.supplier_pid = '10323' AND crm_variable_type.status = 1  [ RunTime:0.0080s ]

[ 2018-09-21T13:42:20+08:00 ] ::1 /Dwin/Purchase/getCertification.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0160s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0080s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0470s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getcertification%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0140s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getcertification','1537508540','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\" 10323\"}') [ RunTime:0.0430s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_certification` [ RunTime:0.0090s ]
SQL: SELECT crm_purchase_supplier_certification.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_certification` left join crm_staff on crm_staff.id = crm_purchase_supplier_certification.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_certification.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ' 10323'  [ RunTime:0.0110s ]

[ 2018-09-21T13:42:23+08:00 ] ::1 /Dwin/Purchase/supplierIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0400s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0100s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0250s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/supplierindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0170s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/supplierindex','1537508543','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"11\",\"columns\":[{\"data\":\"supplier_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"charge_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"supplier_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"business_licence\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"enterprise_cate\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"legal_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_bank\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"audit_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"second_audit\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"0\",\"dir\":\"asc\"}],\"start\":\"0\",\"length\":\"25\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"function\":\"undefined\",\"staffLimit\":\"1\",\"audit_status\":\"1\"}') [ RunTime:0.0870s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0170s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 785 行.
SQL: SELECT p.*,crm_staff.name,(
                    CASE
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '0' THEN 0 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '2' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '20' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '02' THEN 2 
                    ELSE 1
                    END 
                  ) AS second_audit,group_concat(DISTINCT(a.status)) FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid ORDER BY supplier_id asc LIMIT 0,25   [ RunTime:0.0160s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 796 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0130s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 803 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0200s ]

[ 2018-09-21T13:42:24+08:00 ] ::1 /Dwin/Purchase/getSupplierAllMsg
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0090s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0200s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getsupplierallmsg%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0230s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getsupplierallmsg','1537508543','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"\"}') [ RunTime:0.0470s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_address` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_address.*,crm_staff.name FROM `crm_purchase_supplier_address` left join crm_staff on crm_staff.id = crm_purchase_supplier_address.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_contact` [ RunTime:0.0130s ]
SQL: SELECT crm_purchase_supplier_contact.*,crm_staff.name FROM `crm_purchase_supplier_contact` left join crm_staff on crm_staff.id = crm_purchase_supplier_contact.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_certification` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_certification.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_certification` left join crm_staff on crm_staff.id = crm_purchase_supplier_certification.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_certification.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_awards` [ RunTime:0.0140s ]
SQL: SELECT crm_purchase_supplier_awards.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_awards` left join crm_staff on crm_staff.id = crm_purchase_supplier_awards.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_awards.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0160s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_customer` [ RunTime:0.0250s ]
SQL: SELECT crm_purchase_supplier_customer.*,crm_staff.name FROM `crm_purchase_supplier_customer` left join crm_staff on crm_staff.id = crm_purchase_supplier_customer.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0250s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_equity` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_equity.*,crm_staff.name FROM `crm_purchase_supplier_equity` left join crm_staff on crm_staff.id = crm_purchase_supplier_equity.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0250s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_finance` [ RunTime:0.0100s ]
SQL: SELECT * FROM `crm_purchase_supplier_finance` WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0130s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_team` [ RunTime:0.0240s ]
SQL: SELECT crm_purchase_supplier_team.*,crm_staff.name FROM `crm_purchase_supplier_team` left join crm_staff on crm_staff.id = crm_purchase_supplier_team.create_id  WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_cooperation` [ RunTime:0.0110s ]
SQL: SELECT crm_purchase_supplier_cooperation.*,crm_staff.name FROM `crm_purchase_supplier_cooperation` left join crm_staff on crm_staff.id = crm_purchase_supplier_cooperation.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0210s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_audit` [ RunTime:0.0120s ]
SQL: SELECT crm_purchase_supplier_audit.*,crm_variable_type.name as type_name,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_audit` INNER JOIN crm_variable_type on crm_variable_type.id = crm_purchase_supplier_audit.audit_id left join crm_staff on crm_staff.id = crm_purchase_supplier_audit.staff_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_audit.file_id  WHERE crm_purchase_supplier_audit.supplier_pid = '' AND crm_variable_type.status = 1  [ RunTime:0.0060s ]

[ 2018-09-21T13:42:24+08:00 ] ::1 /Dwin/Purchase/getTeam.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002001s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0090s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0290s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getteam%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0090s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getteam','1537508544','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"\"}') [ RunTime:0.0790s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0130s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_team` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_team.*,crm_staff.name FROM `crm_purchase_supplier_team` left join crm_staff on crm_staff.id = crm_purchase_supplier_team.create_id  WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0260s ]

[ 2018-09-21T13:42:26+08:00 ] ::1 /Dwin/Purchase/getSupplierAllMsg
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0080s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0300s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getsupplierallmsg%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0170s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0120s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getsupplierallmsg','1537508546','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"\"}') [ RunTime:0.0550s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_address` [ RunTime:0.0060s ]
SQL: SELECT crm_purchase_supplier_address.*,crm_staff.name FROM `crm_purchase_supplier_address` left join crm_staff on crm_staff.id = crm_purchase_supplier_address.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_contact` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_contact.*,crm_staff.name FROM `crm_purchase_supplier_contact` left join crm_staff on crm_staff.id = crm_purchase_supplier_contact.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_certification` [ RunTime:0.0100s ]
SQL: SELECT crm_purchase_supplier_certification.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_certification` left join crm_staff on crm_staff.id = crm_purchase_supplier_certification.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_certification.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_awards` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_awards.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_awards` left join crm_staff on crm_staff.id = crm_purchase_supplier_awards.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_awards.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0280s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_customer` [ RunTime:0.0100s ]
SQL: SELECT crm_purchase_supplier_customer.*,crm_staff.name FROM `crm_purchase_supplier_customer` left join crm_staff on crm_staff.id = crm_purchase_supplier_customer.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_equity` [ RunTime:0.0090s ]
SQL: SELECT crm_purchase_supplier_equity.*,crm_staff.name FROM `crm_purchase_supplier_equity` left join crm_staff on crm_staff.id = crm_purchase_supplier_equity.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_finance` [ RunTime:0.0080s ]
SQL: SELECT * FROM `crm_purchase_supplier_finance` WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_team` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_team.*,crm_staff.name FROM `crm_purchase_supplier_team` left join crm_staff on crm_staff.id = crm_purchase_supplier_team.create_id  WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_cooperation` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_cooperation.*,crm_staff.name FROM `crm_purchase_supplier_cooperation` left join crm_staff on crm_staff.id = crm_purchase_supplier_cooperation.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_audit` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_audit.*,crm_variable_type.name as type_name,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_audit` INNER JOIN crm_variable_type on crm_variable_type.id = crm_purchase_supplier_audit.audit_id left join crm_staff on crm_staff.id = crm_purchase_supplier_audit.staff_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_audit.file_id  WHERE crm_purchase_supplier_audit.supplier_pid = '' AND crm_variable_type.status = 1  [ RunTime:0.0040s ]

[ 2018-09-21T13:42:27+08:00 ] ::1 /Dwin/Purchase/supplierIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0110s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0130s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0220s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/supplierindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0130s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0180s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/supplierindex','1537508546','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"12\",\"columns\":[{\"data\":\"supplier_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"charge_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"supplier_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"business_licence\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"enterprise_cate\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"legal_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_bank\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"audit_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"second_audit\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"0\",\"dir\":\"asc\"}],\"start\":\"0\",\"length\":\"25\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"function\":\"undefined\",\"staffLimit\":\"1\",\"audit_status\":\"1\"}') [ RunTime:0.0830s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0140s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 785 行.
SQL: SELECT p.*,crm_staff.name,(
                    CASE
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '0' THEN 0 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '2' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '20' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '02' THEN 2 
                    ELSE 1
                    END 
                  ) AS second_audit,group_concat(DISTINCT(a.status)) FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid ORDER BY supplier_id asc LIMIT 0,25   [ RunTime:0.0130s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 796 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0080s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 803 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0090s ]

[ 2018-09-21T13:42:27+08:00 ] ::1 /Dwin/Purchase/getCooperation.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0090s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0130s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0110s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getcooperation%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0120s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getcooperation','1537508547','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"\"}') [ RunTime:0.0680s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_cooperation` [ RunTime:0.0180s ]
SQL: SELECT crm_purchase_supplier_cooperation.*,crm_staff.name FROM `crm_purchase_supplier_cooperation` left join crm_staff on crm_staff.id = crm_purchase_supplier_cooperation.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0060s ]

[ 2018-09-21T13:42:29+08:00 ] ::1 /Dwin/Purchase/supplierIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0090s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0090s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0200s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/supplierindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/supplierindex','1537508549','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"13\",\"columns\":[{\"data\":\"supplier_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"charge_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"supplier_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"business_licence\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"enterprise_cate\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"legal_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_bank\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"audit_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"second_audit\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"0\",\"dir\":\"asc\"}],\"start\":\"0\",\"length\":\"25\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"function\":\"undefined\",\"staffLimit\":\"1\",\"audit_status\":\"1\"}') [ RunTime:0.0540s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0120s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 785 行.
SQL: SELECT p.*,crm_staff.name,(
                    CASE
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '0' THEN 0 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '2' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '20' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '02' THEN 2 
                    ELSE 1
                    END 
                  ) AS second_audit,group_concat(DISTINCT(a.status)) FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid ORDER BY supplier_id asc LIMIT 0,25   [ RunTime:0.0140s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 796 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0130s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 803 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0110s ]

[ 2018-09-21T13:42:29+08:00 ] ::1 /Dwin/Purchase/getSupplierAllMsg
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0100s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0120s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0130s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getsupplierallmsg%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0170s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0090s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getsupplierallmsg','1537508549','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"\"}') [ RunTime:0.0570s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_address` [ RunTime:0.0130s ]
SQL: SELECT crm_purchase_supplier_address.*,crm_staff.name FROM `crm_purchase_supplier_address` left join crm_staff on crm_staff.id = crm_purchase_supplier_address.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_contact` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_contact.*,crm_staff.name FROM `crm_purchase_supplier_contact` left join crm_staff on crm_staff.id = crm_purchase_supplier_contact.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_certification` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_certification.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_certification` left join crm_staff on crm_staff.id = crm_purchase_supplier_certification.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_certification.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_awards` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_awards.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_awards` left join crm_staff on crm_staff.id = crm_purchase_supplier_awards.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_awards.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0160s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_customer` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_customer.*,crm_staff.name FROM `crm_purchase_supplier_customer` left join crm_staff on crm_staff.id = crm_purchase_supplier_customer.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_equity` [ RunTime:0.0210s ]
SQL: SELECT crm_purchase_supplier_equity.*,crm_staff.name FROM `crm_purchase_supplier_equity` left join crm_staff on crm_staff.id = crm_purchase_supplier_equity.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_finance` [ RunTime:0.0080s ]
SQL: SELECT * FROM `crm_purchase_supplier_finance` WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_team` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_team.*,crm_staff.name FROM `crm_purchase_supplier_team` left join crm_staff on crm_staff.id = crm_purchase_supplier_team.create_id  WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_cooperation` [ RunTime:0.0120s ]
SQL: SELECT crm_purchase_supplier_cooperation.*,crm_staff.name FROM `crm_purchase_supplier_cooperation` left join crm_staff on crm_staff.id = crm_purchase_supplier_cooperation.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_audit` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_audit.*,crm_variable_type.name as type_name,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_audit` INNER JOIN crm_variable_type on crm_variable_type.id = crm_purchase_supplier_audit.audit_id left join crm_staff on crm_staff.id = crm_purchase_supplier_audit.staff_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_audit.file_id  WHERE crm_purchase_supplier_audit.supplier_pid = '' AND crm_variable_type.status = 1  [ RunTime:0.0110s ]

[ 2018-09-21T13:42:30+08:00 ] ::1 /Dwin/Purchase/getCustomer.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0100s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0100s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0210s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getcustomer%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0080s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getcustomer','1537508550','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"\"}') [ RunTime:0.0710s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_customer` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_customer.*,crm_staff.name FROM `crm_purchase_supplier_customer` left join crm_staff on crm_staff.id = crm_purchase_supplier_customer.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0060s ]

[ 2018-09-21T13:42:32+08:00 ] ::1 /Dwin/Purchase/supplierIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0100s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0120s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0300s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/supplierindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0190s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/supplierindex','1537508552','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"14\",\"columns\":[{\"data\":\"supplier_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"charge_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"supplier_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"business_licence\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"enterprise_cate\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"legal_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_bank\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"audit_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"second_audit\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"0\",\"dir\":\"asc\"}],\"start\":\"0\",\"length\":\"25\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"function\":\"undefined\",\"staffLimit\":\"1\",\"audit_status\":\"1\"}') [ RunTime:0.1090s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0210s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 785 行.
SQL: SELECT p.*,crm_staff.name,(
                    CASE
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '0' THEN 0 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '2' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '20' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '02' THEN 2 
                    ELSE 1
                    END 
                  ) AS second_audit,group_concat(DISTINCT(a.status)) FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid ORDER BY supplier_id asc LIMIT 0,25   [ RunTime:0.0180s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 796 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0300s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 803 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0290s ]

[ 2018-09-21T13:42:33+08:00 ] ::1 /Dwin/Purchase/getSupplierAllMsg
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0210s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0060s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0230s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getsupplierallmsg%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0080s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getsupplierallmsg','1537508552','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"\"}') [ RunTime:0.1000s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_address` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_address.*,crm_staff.name FROM `crm_purchase_supplier_address` left join crm_staff on crm_staff.id = crm_purchase_supplier_address.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_contact` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_contact.*,crm_staff.name FROM `crm_purchase_supplier_contact` left join crm_staff on crm_staff.id = crm_purchase_supplier_contact.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_certification` [ RunTime:0.0100s ]
SQL: SELECT crm_purchase_supplier_certification.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_certification` left join crm_staff on crm_staff.id = crm_purchase_supplier_certification.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_certification.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_awards` [ RunTime:0.0120s ]
SQL: SELECT crm_purchase_supplier_awards.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_awards` left join crm_staff on crm_staff.id = crm_purchase_supplier_awards.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_awards.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_customer` [ RunTime:0.0140s ]
SQL: SELECT crm_purchase_supplier_customer.*,crm_staff.name FROM `crm_purchase_supplier_customer` left join crm_staff on crm_staff.id = crm_purchase_supplier_customer.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_equity` [ RunTime:0.0120s ]
SQL: SELECT crm_purchase_supplier_equity.*,crm_staff.name FROM `crm_purchase_supplier_equity` left join crm_staff on crm_staff.id = crm_purchase_supplier_equity.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0170s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_finance` [ RunTime:0.0120s ]
SQL: SELECT * FROM `crm_purchase_supplier_finance` WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_team` [ RunTime:0.0100s ]
SQL: SELECT crm_purchase_supplier_team.*,crm_staff.name FROM `crm_purchase_supplier_team` left join crm_staff on crm_staff.id = crm_purchase_supplier_team.create_id  WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_cooperation` [ RunTime:0.0140s ]
SQL: SELECT crm_purchase_supplier_cooperation.*,crm_staff.name FROM `crm_purchase_supplier_cooperation` left join crm_staff on crm_staff.id = crm_purchase_supplier_cooperation.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_audit` [ RunTime:0.0180s ]
SQL: SELECT crm_purchase_supplier_audit.*,crm_variable_type.name as type_name,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_audit` INNER JOIN crm_variable_type on crm_variable_type.id = crm_purchase_supplier_audit.audit_id left join crm_staff on crm_staff.id = crm_purchase_supplier_audit.staff_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_audit.file_id  WHERE crm_purchase_supplier_audit.supplier_pid = '' AND crm_variable_type.status = 1  [ RunTime:0.0400s ]

[ 2018-09-21T13:42:34+08:00 ] ::1 /Dwin/Purchase/getSupplierAllMsg
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0110s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0020s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0180s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0550s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getsupplierallmsg%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.1070s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0220s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getsupplierallmsg','1537508554','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"68\"}') [ RunTime:0.0960s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_address` [ RunTime:0.0140s ]
SQL: SELECT crm_purchase_supplier_address.*,crm_staff.name FROM `crm_purchase_supplier_address` left join crm_staff on crm_staff.id = crm_purchase_supplier_address.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '68'  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_contact` [ RunTime:0.0090s ]
SQL: SELECT crm_purchase_supplier_contact.*,crm_staff.name FROM `crm_purchase_supplier_contact` left join crm_staff on crm_staff.id = crm_purchase_supplier_contact.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '68'  [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_certification` [ RunTime:0.0130s ]
SQL: SELECT crm_purchase_supplier_certification.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_certification` left join crm_staff on crm_staff.id = crm_purchase_supplier_certification.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_certification.file_id  WHERE `is_del` = 0 AND `supplier_pid` = '68'  [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_awards` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_awards.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_awards` left join crm_staff on crm_staff.id = crm_purchase_supplier_awards.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_awards.file_id  WHERE `is_del` = 0 AND `supplier_pid` = '68'  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_customer` [ RunTime:0.0150s ]
SQL: SELECT crm_purchase_supplier_customer.*,crm_staff.name FROM `crm_purchase_supplier_customer` left join crm_staff on crm_staff.id = crm_purchase_supplier_customer.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '68'  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_equity` [ RunTime:0.0140s ]
SQL: SELECT crm_purchase_supplier_equity.*,crm_staff.name FROM `crm_purchase_supplier_equity` left join crm_staff on crm_staff.id = crm_purchase_supplier_equity.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '68'  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_finance` [ RunTime:0.0090s ]
SQL: SELECT * FROM `crm_purchase_supplier_finance` WHERE `supplier_pid` = '68' AND `is_del` = 0  [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_team` [ RunTime:0.0060s ]
SQL: SELECT crm_purchase_supplier_team.*,crm_staff.name FROM `crm_purchase_supplier_team` left join crm_staff on crm_staff.id = crm_purchase_supplier_team.create_id  WHERE `supplier_pid` = '68' AND `is_del` = 0  [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_cooperation` [ RunTime:0.0100s ]
SQL: SELECT crm_purchase_supplier_cooperation.*,crm_staff.name FROM `crm_purchase_supplier_cooperation` left join crm_staff on crm_staff.id = crm_purchase_supplier_cooperation.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '68'  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_audit` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_audit.*,crm_variable_type.name as type_name,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_audit` INNER JOIN crm_variable_type on crm_variable_type.id = crm_purchase_supplier_audit.audit_id left join crm_staff on crm_staff.id = crm_purchase_supplier_audit.staff_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_audit.file_id  WHERE crm_purchase_supplier_audit.supplier_pid = '68' AND crm_variable_type.status = 1  [ RunTime:0.0060s ]

[ 2018-09-21T13:42:35+08:00 ] ::1 /Dwin/Purchase/getSupplierAllMsg
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0130s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0020s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0090s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0180s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getsupplierallmsg%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getsupplierallmsg','1537508554','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"10350\"}') [ RunTime:0.0880s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0130s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_address` [ RunTime:0.0160s ]
SQL: SELECT crm_purchase_supplier_address.*,crm_staff.name FROM `crm_purchase_supplier_address` left join crm_staff on crm_staff.id = crm_purchase_supplier_address.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10350'  [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_contact` [ RunTime:0.0120s ]
SQL: SELECT crm_purchase_supplier_contact.*,crm_staff.name FROM `crm_purchase_supplier_contact` left join crm_staff on crm_staff.id = crm_purchase_supplier_contact.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10350'  [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_certification` [ RunTime:0.0360s ]
SQL: SELECT crm_purchase_supplier_certification.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_certification` left join crm_staff on crm_staff.id = crm_purchase_supplier_certification.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_certification.file_id  WHERE `is_del` = 0 AND `supplier_pid` = '10350'  [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_awards` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_awards.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_awards` left join crm_staff on crm_staff.id = crm_purchase_supplier_awards.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_awards.file_id  WHERE `is_del` = 0 AND `supplier_pid` = '10350'  [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_customer` [ RunTime:0.0090s ]
SQL: SELECT crm_purchase_supplier_customer.*,crm_staff.name FROM `crm_purchase_supplier_customer` left join crm_staff on crm_staff.id = crm_purchase_supplier_customer.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10350'  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_equity` [ RunTime:0.0140s ]
SQL: SELECT crm_purchase_supplier_equity.*,crm_staff.name FROM `crm_purchase_supplier_equity` left join crm_staff on crm_staff.id = crm_purchase_supplier_equity.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10350'  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_finance` [ RunTime:0.0190s ]
SQL: SELECT * FROM `crm_purchase_supplier_finance` WHERE `supplier_pid` = '10350' AND `is_del` = 0  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_team` [ RunTime:0.0090s ]
SQL: SELECT crm_purchase_supplier_team.*,crm_staff.name FROM `crm_purchase_supplier_team` left join crm_staff on crm_staff.id = crm_purchase_supplier_team.create_id  WHERE `supplier_pid` = '10350' AND `is_del` = 0  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_cooperation` [ RunTime:0.0120s ]
SQL: SELECT crm_purchase_supplier_cooperation.*,crm_staff.name FROM `crm_purchase_supplier_cooperation` left join crm_staff on crm_staff.id = crm_purchase_supplier_cooperation.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10350'  [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_audit` [ RunTime:0.0320s ]
SQL: SELECT crm_purchase_supplier_audit.*,crm_variable_type.name as type_name,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_audit` INNER JOIN crm_variable_type on crm_variable_type.id = crm_purchase_supplier_audit.audit_id left join crm_staff on crm_staff.id = crm_purchase_supplier_audit.staff_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_audit.file_id  WHERE crm_purchase_supplier_audit.supplier_pid = '10350' AND crm_variable_type.status = 1  [ RunTime:0.0120s ]

[ 2018-09-21T13:42:37+08:00 ] ::1 /Dwin/Purchase/getAwards.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0190s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getawards%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0090s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getawards','1537508557','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\" 10350\"}') [ RunTime:0.0570s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_awards` [ RunTime:0.0090s ]
SQL: SELECT crm_purchase_supplier_awards.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_awards` left join crm_staff on crm_staff.id = crm_purchase_supplier_awards.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_awards.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ' 10350'  [ RunTime:0.0040s ]

[ 2018-09-21T13:42:41+08:00 ] ::1 /Dwin/Purchase/getSupplierAllMsg
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0130s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0080s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0250s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getsupplierallmsg%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0080s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getsupplierallmsg','1537508561','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"\"}') [ RunTime:0.1070s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0260s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_address` [ RunTime:0.0190s ]
SQL: SELECT crm_purchase_supplier_address.*,crm_staff.name FROM `crm_purchase_supplier_address` left join crm_staff on crm_staff.id = crm_purchase_supplier_address.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_contact` [ RunTime:0.0150s ]
SQL: SELECT crm_purchase_supplier_contact.*,crm_staff.name FROM `crm_purchase_supplier_contact` left join crm_staff on crm_staff.id = crm_purchase_supplier_contact.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_certification` [ RunTime:0.0110s ]
SQL: SELECT crm_purchase_supplier_certification.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_certification` left join crm_staff on crm_staff.id = crm_purchase_supplier_certification.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_certification.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_awards` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_awards.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_awards` left join crm_staff on crm_staff.id = crm_purchase_supplier_awards.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_awards.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_customer` [ RunTime:0.0110s ]
SQL: SELECT crm_purchase_supplier_customer.*,crm_staff.name FROM `crm_purchase_supplier_customer` left join crm_staff on crm_staff.id = crm_purchase_supplier_customer.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_equity` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_equity.*,crm_staff.name FROM `crm_purchase_supplier_equity` left join crm_staff on crm_staff.id = crm_purchase_supplier_equity.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_finance` [ RunTime:0.0160s ]
SQL: SELECT * FROM `crm_purchase_supplier_finance` WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_team` [ RunTime:0.0150s ]
SQL: SELECT crm_purchase_supplier_team.*,crm_staff.name FROM `crm_purchase_supplier_team` left join crm_staff on crm_staff.id = crm_purchase_supplier_team.create_id  WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_cooperation` [ RunTime:0.0110s ]
SQL: SELECT crm_purchase_supplier_cooperation.*,crm_staff.name FROM `crm_purchase_supplier_cooperation` left join crm_staff on crm_staff.id = crm_purchase_supplier_cooperation.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0230s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_audit` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_audit.*,crm_variable_type.name as type_name,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_audit` INNER JOIN crm_variable_type on crm_variable_type.id = crm_purchase_supplier_audit.audit_id left join crm_staff on crm_staff.id = crm_purchase_supplier_audit.staff_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_audit.file_id  WHERE crm_purchase_supplier_audit.supplier_pid = '' AND crm_variable_type.status = 1  [ RunTime:0.0040s ]

[ 2018-09-21T13:42:41+08:00 ] ::1 /Dwin/Purchase/supplierIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0280s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0080s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0280s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/supplierindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0160s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/supplierindex','1537508561','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"15\",\"columns\":[{\"data\":\"supplier_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"charge_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"supplier_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"business_licence\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"enterprise_cate\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"legal_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_bank\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"audit_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"second_audit\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"0\",\"dir\":\"asc\"}],\"start\":\"0\",\"length\":\"25\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"function\":\"undefined\",\"staffLimit\":\"1\",\"audit_status\":\"1\"}') [ RunTime:0.0790s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0080s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 785 行.
SQL: SELECT p.*,crm_staff.name,(
                    CASE
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '0' THEN 0 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '2' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '20' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '02' THEN 2 
                    ELSE 1
                    END 
                  ) AS second_audit,group_concat(DISTINCT(a.status)) FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid ORDER BY supplier_id asc LIMIT 0,25   [ RunTime:0.0130s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 796 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0080s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 803 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0110s ]

[ 2018-09-21T13:42:42+08:00 ] ::1 /Dwin/Purchase/getCustomer.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0090s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0020s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0240s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getcustomer%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0080s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getcustomer','1537508562','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"\"}') [ RunTime:0.0560s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_customer` [ RunTime:0.0160s ]
SQL: SELECT crm_purchase_supplier_customer.*,crm_staff.name FROM `crm_purchase_supplier_customer` left join crm_staff on crm_staff.id = crm_purchase_supplier_customer.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0090s ]

[ 2018-09-21T13:42:45+08:00 ] ::1 /Dwin/Purchase/getSupplierAllMsg
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0160s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0170s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0910s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getsupplierallmsg%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0150s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getsupplierallmsg','1537508564','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"\"}') [ RunTime:0.0590s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_address` [ RunTime:0.0480s ]
SQL: SELECT crm_purchase_supplier_address.*,crm_staff.name FROM `crm_purchase_supplier_address` left join crm_staff on crm_staff.id = crm_purchase_supplier_address.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_contact` [ RunTime:0.0130s ]
SQL: SELECT crm_purchase_supplier_contact.*,crm_staff.name FROM `crm_purchase_supplier_contact` left join crm_staff on crm_staff.id = crm_purchase_supplier_contact.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0160s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_certification` [ RunTime:0.0100s ]
SQL: SELECT crm_purchase_supplier_certification.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_certification` left join crm_staff on crm_staff.id = crm_purchase_supplier_certification.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_certification.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0270s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_awards` [ RunTime:0.0500s ]
SQL: SELECT crm_purchase_supplier_awards.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_awards` left join crm_staff on crm_staff.id = crm_purchase_supplier_awards.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_awards.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_customer` [ RunTime:0.0320s ]
SQL: SELECT crm_purchase_supplier_customer.*,crm_staff.name FROM `crm_purchase_supplier_customer` left join crm_staff on crm_staff.id = crm_purchase_supplier_customer.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0220s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_equity` [ RunTime:0.0260s ]
SQL: SELECT crm_purchase_supplier_equity.*,crm_staff.name FROM `crm_purchase_supplier_equity` left join crm_staff on crm_staff.id = crm_purchase_supplier_equity.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0160s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_finance` [ RunTime:0.0100s ]
SQL: SELECT * FROM `crm_purchase_supplier_finance` WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0190s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_team` [ RunTime:0.0120s ]
SQL: SELECT crm_purchase_supplier_team.*,crm_staff.name FROM `crm_purchase_supplier_team` left join crm_staff on crm_staff.id = crm_purchase_supplier_team.create_id  WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_cooperation` [ RunTime:0.0350s ]
SQL: SELECT crm_purchase_supplier_cooperation.*,crm_staff.name FROM `crm_purchase_supplier_cooperation` left join crm_staff on crm_staff.id = crm_purchase_supplier_cooperation.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_audit` [ RunTime:0.0130s ]
SQL: SELECT crm_purchase_supplier_audit.*,crm_variable_type.name as type_name,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_audit` INNER JOIN crm_variable_type on crm_variable_type.id = crm_purchase_supplier_audit.audit_id left join crm_staff on crm_staff.id = crm_purchase_supplier_audit.staff_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_audit.file_id  WHERE crm_purchase_supplier_audit.supplier_pid = '' AND crm_variable_type.status = 1  [ RunTime:0.0160s ]

[ 2018-09-21T13:42:45+08:00 ] ::1 /Dwin/Purchase/supplierIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0110s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0150s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0410s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/supplierindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0200s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0190s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/supplierindex','1537508565','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"16\",\"columns\":[{\"data\":\"supplier_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"charge_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"supplier_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"business_licence\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"enterprise_cate\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"legal_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_bank\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"audit_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"second_audit\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"0\",\"dir\":\"asc\"}],\"start\":\"0\",\"length\":\"25\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"function\":\"undefined\",\"staffLimit\":\"1\",\"audit_status\":\"1\"}') [ RunTime:0.0740s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0680s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 785 行.
SQL: SELECT p.*,crm_staff.name,(
                    CASE
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '0' THEN 0 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '2' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '20' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '02' THEN 2 
                    ELSE 1
                    END 
                  ) AS second_audit,group_concat(DISTINCT(a.status)) FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid ORDER BY supplier_id asc LIMIT 0,25   [ RunTime:0.0490s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 796 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0420s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 803 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0250s ]

[ 2018-09-21T13:42:46+08:00 ] ::1 /Dwin/Purchase/getContact.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0100s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0090s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0180s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getcontact%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0230s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0110s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getcontact','1537508566','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"\"}') [ RunTime:0.0710s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_contact` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_contact.*,crm_staff.name FROM `crm_purchase_supplier_contact` left join crm_staff on crm_staff.id = crm_purchase_supplier_contact.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0060s ]

[ 2018-09-21T13:42:49+08:00 ] ::1 /Dwin/Purchase/supplierIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0160s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0130s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/supplierindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0080s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/supplierindex','1537508569','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"17\",\"columns\":[{\"data\":\"supplier_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"charge_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"supplier_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"business_licence\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"enterprise_cate\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"legal_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_bank\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"audit_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"second_audit\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"0\",\"dir\":\"asc\"}],\"start\":\"0\",\"length\":\"25\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"function\":\"undefined\",\"staffLimit\":\"1\",\"audit_status\":\"1\"}') [ RunTime:0.0660s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0080s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 785 行.
SQL: SELECT p.*,crm_staff.name,(
                    CASE
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '0' THEN 0 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '2' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '20' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '02' THEN 2 
                    ELSE 1
                    END 
                  ) AS second_audit,group_concat(DISTINCT(a.status)) FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid ORDER BY supplier_id asc LIMIT 0,25   [ RunTime:0.0150s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 796 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0170s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 803 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0160s ]

[ 2018-09-21T13:42:49+08:00 ] ::1 /Dwin/Purchase/getSupplierAllMsg
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.003000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.005001s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0060s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0080s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0170s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getsupplierallmsg%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0020s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0090s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getsupplierallmsg','1537508569','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"\"}') [ RunTime:0.0520s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_address` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_address.*,crm_staff.name FROM `crm_purchase_supplier_address` left join crm_staff on crm_staff.id = crm_purchase_supplier_address.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_contact` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_contact.*,crm_staff.name FROM `crm_purchase_supplier_contact` left join crm_staff on crm_staff.id = crm_purchase_supplier_contact.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_certification` [ RunTime:0.0100s ]
SQL: SELECT crm_purchase_supplier_certification.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_certification` left join crm_staff on crm_staff.id = crm_purchase_supplier_certification.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_certification.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_awards` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_awards.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_awards` left join crm_staff on crm_staff.id = crm_purchase_supplier_awards.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_awards.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0200s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_customer` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_customer.*,crm_staff.name FROM `crm_purchase_supplier_customer` left join crm_staff on crm_staff.id = crm_purchase_supplier_customer.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_equity` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_equity.*,crm_staff.name FROM `crm_purchase_supplier_equity` left join crm_staff on crm_staff.id = crm_purchase_supplier_equity.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_finance` [ RunTime:0.0070s ]
SQL: SELECT * FROM `crm_purchase_supplier_finance` WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_team` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_team.*,crm_staff.name FROM `crm_purchase_supplier_team` left join crm_staff on crm_staff.id = crm_purchase_supplier_team.create_id  WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_cooperation` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_cooperation.*,crm_staff.name FROM `crm_purchase_supplier_cooperation` left join crm_staff on crm_staff.id = crm_purchase_supplier_cooperation.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_audit` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_audit.*,crm_variable_type.name as type_name,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_audit` INNER JOIN crm_variable_type on crm_variable_type.id = crm_purchase_supplier_audit.audit_id left join crm_staff on crm_staff.id = crm_purchase_supplier_audit.staff_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_audit.file_id  WHERE crm_purchase_supplier_audit.supplier_pid = '' AND crm_variable_type.status = 1  [ RunTime:0.0090s ]

[ 2018-09-21T13:42:50+08:00 ] ::1 /Dwin/Purchase/getCooperation.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0090s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0020s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0060s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0250s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getcooperation%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getcooperation','1537508570','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"\"}') [ RunTime:0.0410s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_cooperation` [ RunTime:0.0170s ]
SQL: SELECT crm_purchase_supplier_cooperation.*,crm_staff.name FROM `crm_purchase_supplier_cooperation` left join crm_staff on crm_staff.id = crm_purchase_supplier_cooperation.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0080s ]

[ 2018-09-21T13:42:53+08:00 ] ::1 /Dwin/Purchase/getSupplierAllMsg
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0150s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0080s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0180s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getsupplierallmsg%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0100s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getsupplierallmsg','1537508572','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"\"}') [ RunTime:0.0750s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_address` [ RunTime:0.0290s ]
SQL: SELECT crm_purchase_supplier_address.*,crm_staff.name FROM `crm_purchase_supplier_address` left join crm_staff on crm_staff.id = crm_purchase_supplier_address.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_contact` [ RunTime:0.0100s ]
SQL: SELECT crm_purchase_supplier_contact.*,crm_staff.name FROM `crm_purchase_supplier_contact` left join crm_staff on crm_staff.id = crm_purchase_supplier_contact.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_certification` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_certification.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_certification` left join crm_staff on crm_staff.id = crm_purchase_supplier_certification.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_certification.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_awards` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_awards.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_awards` left join crm_staff on crm_staff.id = crm_purchase_supplier_awards.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_awards.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_customer` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_customer.*,crm_staff.name FROM `crm_purchase_supplier_customer` left join crm_staff on crm_staff.id = crm_purchase_supplier_customer.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_equity` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_equity.*,crm_staff.name FROM `crm_purchase_supplier_equity` left join crm_staff on crm_staff.id = crm_purchase_supplier_equity.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_finance` [ RunTime:0.0150s ]
SQL: SELECT * FROM `crm_purchase_supplier_finance` WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_team` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_team.*,crm_staff.name FROM `crm_purchase_supplier_team` left join crm_staff on crm_staff.id = crm_purchase_supplier_team.create_id  WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_cooperation` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_cooperation.*,crm_staff.name FROM `crm_purchase_supplier_cooperation` left join crm_staff on crm_staff.id = crm_purchase_supplier_cooperation.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_audit` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_audit.*,crm_variable_type.name as type_name,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_audit` INNER JOIN crm_variable_type on crm_variable_type.id = crm_purchase_supplier_audit.audit_id left join crm_staff on crm_staff.id = crm_purchase_supplier_audit.staff_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_audit.file_id  WHERE crm_purchase_supplier_audit.supplier_pid = '' AND crm_variable_type.status = 1  [ RunTime:0.0140s ]

[ 2018-09-21T13:42:53+08:00 ] ::1 /Dwin/Purchase/supplierIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0080s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0140s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/supplierindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0170s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/supplierindex','1537508573','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"18\",\"columns\":[{\"data\":\"supplier_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"charge_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"supplier_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"business_licence\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"enterprise_cate\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"legal_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_bank\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"audit_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"second_audit\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"0\",\"dir\":\"asc\"}],\"start\":\"0\",\"length\":\"25\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"function\":\"undefined\",\"staffLimit\":\"1\",\"audit_status\":\"1\"}') [ RunTime:0.0550s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0070s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 785 行.
SQL: SELECT p.*,crm_staff.name,(
                    CASE
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '0' THEN 0 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '2' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '20' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '02' THEN 2 
                    ELSE 1
                    END 
                  ) AS second_audit,group_concat(DISTINCT(a.status)) FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid ORDER BY supplier_id asc LIMIT 0,25   [ RunTime:0.0120s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 796 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0090s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 803 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0240s ]

[ 2018-09-21T13:42:54+08:00 ] ::1 /Dwin/Purchase/getAddress.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0080s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0090s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0170s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getaddress%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0130s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getaddress','1537508574','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"\"}') [ RunTime:0.0750s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_address` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_address.*,crm_staff.name FROM `crm_purchase_supplier_address` left join crm_staff on crm_staff.id = crm_purchase_supplier_address.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0050s ]

[ 2018-09-21T13:42:56+08:00 ] ::1 /Dwin/Purchase/supplierIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0120s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0190s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0160s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0360s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/supplierindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0140s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/supplierindex','1537508575','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"19\",\"columns\":[{\"data\":\"supplier_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"charge_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"supplier_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"business_licence\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"enterprise_cate\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"legal_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_bank\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"audit_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"second_audit\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"0\",\"dir\":\"asc\"}],\"start\":\"0\",\"length\":\"25\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"function\":\"undefined\",\"staffLimit\":\"1\",\"audit_status\":\"1\"}') [ RunTime:0.0680s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0080s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 785 行.
SQL: SELECT p.*,crm_staff.name,(
                    CASE
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '0' THEN 0 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '2' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '20' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '02' THEN 2 
                    ELSE 1
                    END 
                  ) AS second_audit,group_concat(DISTINCT(a.status)) FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid ORDER BY supplier_id asc LIMIT 0,25   [ RunTime:0.0150s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 796 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0170s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 803 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0190s ]

[ 2018-09-21T13:42:56+08:00 ] ::1 /Dwin/Purchase/getSupplierAllMsg
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0100s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0150s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0250s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getsupplierallmsg%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0220s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getsupplierallmsg','1537508576','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"\"}') [ RunTime:0.0460s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_address` [ RunTime:0.0090s ]
SQL: SELECT crm_purchase_supplier_address.*,crm_staff.name FROM `crm_purchase_supplier_address` left join crm_staff on crm_staff.id = crm_purchase_supplier_address.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_contact` [ RunTime:0.0090s ]
SQL: SELECT crm_purchase_supplier_contact.*,crm_staff.name FROM `crm_purchase_supplier_contact` left join crm_staff on crm_staff.id = crm_purchase_supplier_contact.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_certification` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_certification.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_certification` left join crm_staff on crm_staff.id = crm_purchase_supplier_certification.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_certification.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_awards` [ RunTime:0.0090s ]
SQL: SELECT crm_purchase_supplier_awards.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_awards` left join crm_staff on crm_staff.id = crm_purchase_supplier_awards.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_awards.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_customer` [ RunTime:0.0120s ]
SQL: SELECT crm_purchase_supplier_customer.*,crm_staff.name FROM `crm_purchase_supplier_customer` left join crm_staff on crm_staff.id = crm_purchase_supplier_customer.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_equity` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_equity.*,crm_staff.name FROM `crm_purchase_supplier_equity` left join crm_staff on crm_staff.id = crm_purchase_supplier_equity.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_finance` [ RunTime:0.0090s ]
SQL: SELECT * FROM `crm_purchase_supplier_finance` WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_team` [ RunTime:0.0210s ]
SQL: SELECT crm_purchase_supplier_team.*,crm_staff.name FROM `crm_purchase_supplier_team` left join crm_staff on crm_staff.id = crm_purchase_supplier_team.create_id  WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_cooperation` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_cooperation.*,crm_staff.name FROM `crm_purchase_supplier_cooperation` left join crm_staff on crm_staff.id = crm_purchase_supplier_cooperation.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_audit` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_audit.*,crm_variable_type.name as type_name,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_audit` INNER JOIN crm_variable_type on crm_variable_type.id = crm_purchase_supplier_audit.audit_id left join crm_staff on crm_staff.id = crm_purchase_supplier_audit.staff_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_audit.file_id  WHERE crm_purchase_supplier_audit.supplier_pid = '' AND crm_variable_type.status = 1  [ RunTime:0.0050s ]

[ 2018-09-21T13:42:57+08:00 ] ::1 /Dwin/Purchase/getSupplier.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001001s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0240s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0250s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getsupplier%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0090s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getsupplier','1537508577','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"\"}') [ RunTime:0.0780s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0080s ]
SQL: SELECT * FROM `crm_purchase_supplier` WHERE `is_del` = 0 AND `id` = '' LIMIT 1   [ RunTime:0.0050s ]

[ 2018-09-21T13:42:59+08:00 ] ::1 /Dwin/Purchase/getSupplierAllMsg
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0090s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0080s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0150s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getsupplierallmsg%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getsupplierallmsg','1537508578','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"\"}') [ RunTime:0.0920s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_address` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_address.*,crm_staff.name FROM `crm_purchase_supplier_address` left join crm_staff on crm_staff.id = crm_purchase_supplier_address.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_contact` [ RunTime:0.0090s ]
SQL: SELECT crm_purchase_supplier_contact.*,crm_staff.name FROM `crm_purchase_supplier_contact` left join crm_staff on crm_staff.id = crm_purchase_supplier_contact.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_certification` [ RunTime:0.0110s ]
SQL: SELECT crm_purchase_supplier_certification.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_certification` left join crm_staff on crm_staff.id = crm_purchase_supplier_certification.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_certification.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_awards` [ RunTime:0.0170s ]
SQL: SELECT crm_purchase_supplier_awards.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_awards` left join crm_staff on crm_staff.id = crm_purchase_supplier_awards.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_awards.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_customer` [ RunTime:0.0060s ]
SQL: SELECT crm_purchase_supplier_customer.*,crm_staff.name FROM `crm_purchase_supplier_customer` left join crm_staff on crm_staff.id = crm_purchase_supplier_customer.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_equity` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_equity.*,crm_staff.name FROM `crm_purchase_supplier_equity` left join crm_staff on crm_staff.id = crm_purchase_supplier_equity.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_finance` [ RunTime:0.0080s ]
SQL: SELECT * FROM `crm_purchase_supplier_finance` WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_team` [ RunTime:0.0060s ]
SQL: SELECT crm_purchase_supplier_team.*,crm_staff.name FROM `crm_purchase_supplier_team` left join crm_staff on crm_staff.id = crm_purchase_supplier_team.create_id  WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_cooperation` [ RunTime:0.0120s ]
SQL: SELECT crm_purchase_supplier_cooperation.*,crm_staff.name FROM `crm_purchase_supplier_cooperation` left join crm_staff on crm_staff.id = crm_purchase_supplier_cooperation.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_audit` [ RunTime:0.0070s ]
SQL: SELECT crm_purchase_supplier_audit.*,crm_variable_type.name as type_name,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_audit` INNER JOIN crm_variable_type on crm_variable_type.id = crm_purchase_supplier_audit.audit_id left join crm_staff on crm_staff.id = crm_purchase_supplier_audit.staff_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_audit.file_id  WHERE crm_purchase_supplier_audit.supplier_pid = '' AND crm_variable_type.status = 1  [ RunTime:0.0100s ]

[ 2018-09-21T13:42:59+08:00 ] ::1 /Dwin/Purchase/supplierIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.002000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0250s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0060s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0100s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/supplierindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0090s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/supplierindex','1537508579','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"20\",\"columns\":[{\"data\":\"supplier_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"charge_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"supplier_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"business_licence\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"enterprise_cate\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"legal_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_bank\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"audit_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"second_audit\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"0\",\"dir\":\"asc\"}],\"start\":\"0\",\"length\":\"25\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"function\":\"undefined\",\"staffLimit\":\"1\",\"audit_status\":\"1\"}') [ RunTime:0.0550s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0100s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 785 行.
SQL: SELECT p.*,crm_staff.name,(
                    CASE
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '0' THEN 0 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '2' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '20' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '02' THEN 2 
                    ELSE 1
                    END 
                  ) AS second_audit,group_concat(DISTINCT(a.status)) FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid ORDER BY supplier_id asc LIMIT 0,25   [ RunTime:0.0110s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 796 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0150s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 803 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0100s ]

[ 2018-09-21T13:43:00+08:00 ] ::1 /Dwin/Purchase/getAwards.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0070s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0080s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0340s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getawards%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0080s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getawards','1537508580','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"\"}') [ RunTime:0.0830s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0170s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_awards` [ RunTime:0.0160s ]
SQL: SELECT crm_purchase_supplier_awards.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_awards` left join crm_staff on crm_staff.id = crm_purchase_supplier_awards.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_awards.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0070s ]

[ 2018-09-21T13:43:02+08:00 ] ::1 /Dwin/Purchase/getSupplierAllMsg
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0080s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0140s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0080s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0180s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getsupplierallmsg%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0100s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getsupplierallmsg','1537508581','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"\"}') [ RunTime:0.1280s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_address` [ RunTime:0.0110s ]
SQL: SELECT crm_purchase_supplier_address.*,crm_staff.name FROM `crm_purchase_supplier_address` left join crm_staff on crm_staff.id = crm_purchase_supplier_address.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_contact` [ RunTime:0.0150s ]
SQL: SELECT crm_purchase_supplier_contact.*,crm_staff.name FROM `crm_purchase_supplier_contact` left join crm_staff on crm_staff.id = crm_purchase_supplier_contact.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_certification` [ RunTime:0.0140s ]
SQL: SELECT crm_purchase_supplier_certification.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_certification` left join crm_staff on crm_staff.id = crm_purchase_supplier_certification.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_certification.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_awards` [ RunTime:0.0180s ]
SQL: SELECT crm_purchase_supplier_awards.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_awards` left join crm_staff on crm_staff.id = crm_purchase_supplier_awards.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_awards.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_customer` [ RunTime:0.0100s ]
SQL: SELECT crm_purchase_supplier_customer.*,crm_staff.name FROM `crm_purchase_supplier_customer` left join crm_staff on crm_staff.id = crm_purchase_supplier_customer.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_equity` [ RunTime:0.0100s ]
SQL: SELECT crm_purchase_supplier_equity.*,crm_staff.name FROM `crm_purchase_supplier_equity` left join crm_staff on crm_staff.id = crm_purchase_supplier_equity.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_finance` [ RunTime:0.0090s ]
SQL: SELECT * FROM `crm_purchase_supplier_finance` WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_team` [ RunTime:0.0160s ]
SQL: SELECT crm_purchase_supplier_team.*,crm_staff.name FROM `crm_purchase_supplier_team` left join crm_staff on crm_staff.id = crm_purchase_supplier_team.create_id  WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0110s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_cooperation` [ RunTime:0.0130s ]
SQL: SELECT crm_purchase_supplier_cooperation.*,crm_staff.name FROM `crm_purchase_supplier_cooperation` left join crm_staff on crm_staff.id = crm_purchase_supplier_cooperation.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_audit` [ RunTime:0.0090s ]
SQL: SELECT crm_purchase_supplier_audit.*,crm_variable_type.name as type_name,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_audit` INNER JOIN crm_variable_type on crm_variable_type.id = crm_purchase_supplier_audit.audit_id left join crm_staff on crm_staff.id = crm_purchase_supplier_audit.staff_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_audit.file_id  WHERE crm_purchase_supplier_audit.supplier_pid = '' AND crm_variable_type.status = 1  [ RunTime:0.0060s ]

[ 2018-09-21T13:43:02+08:00 ] ::1 /Dwin/Purchase/supplierIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0080s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0080s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0130s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/supplierindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0120s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/supplierindex','1537508582','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"21\",\"columns\":[{\"data\":\"supplier_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"charge_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"supplier_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"business_licence\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"enterprise_cate\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"legal_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_bank\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"audit_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"second_audit\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"0\",\"dir\":\"asc\"}],\"start\":\"0\",\"length\":\"25\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"function\":\"undefined\",\"staffLimit\":\"1\",\"audit_status\":\"1\"}') [ RunTime:0.0550s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0080s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 785 行.
SQL: SELECT p.*,crm_staff.name,(
                    CASE
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '0' THEN 0 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '2' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '20' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '02' THEN 2 
                    ELSE 1
                    END 
                  ) AS second_audit,group_concat(DISTINCT(a.status)) FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid ORDER BY supplier_id asc LIMIT 0,25   [ RunTime:0.0120s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 796 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0080s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 803 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0120s ]

[ 2018-09-21T13:43:03+08:00 ] ::1 /Dwin/Purchase/getSupplier.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0060s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0020s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0290s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0190s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getsupplier%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0100s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getsupplier','1537508582','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"\"}') [ RunTime:0.0630s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0110s ]
SQL: SELECT * FROM `crm_purchase_supplier` WHERE `is_del` = 0 AND `id` = '' LIMIT 1   [ RunTime:0.0080s ]

[ 2018-09-21T13:43:07+08:00 ] ::1 /Dwin/Purchase/supplierIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.002000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.002000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0060s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0210s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/supplierindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.6860s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0240s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/supplierindex','1537508587','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"22\",\"columns\":[{\"data\":\"supplier_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"charge_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"supplier_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"business_licence\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"enterprise_cate\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"legal_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_bank\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"audit_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"second_audit\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"0\",\"dir\":\"asc\"}],\"start\":\"0\",\"length\":\"25\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"function\":\"undefined\",\"staffLimit\":\"1\",\"audit_status\":\"1\"}') [ RunTime:0.2910s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0090s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 785 行.
SQL: SELECT p.*,crm_staff.name,(
                    CASE
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '0' THEN 0 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '2' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '20' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '02' THEN 2 
                    ELSE 1
                    END 
                  ) AS second_audit,group_concat(DISTINCT(a.status)) FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid ORDER BY supplier_id asc LIMIT 0,25   [ RunTime:0.0180s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 796 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0170s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 803 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.0210s ]

[ 2018-09-21T13:43:08+08:00 ] ::1 /Dwin/Purchase/getSupplierAllMsg
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.002001s ]
INFO: [ app_begin ] --END-- [ RunTime:0.003001s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0090s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0100s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0180s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getsupplierallmsg%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0070s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getsupplierallmsg','1537508587','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"\"}') [ RunTime:0.1200s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_address` [ RunTime:0.0120s ]
SQL: SELECT crm_purchase_supplier_address.*,crm_staff.name FROM `crm_purchase_supplier_address` left join crm_staff on crm_staff.id = crm_purchase_supplier_address.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_contact` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_contact.*,crm_staff.name FROM `crm_purchase_supplier_contact` left join crm_staff on crm_staff.id = crm_purchase_supplier_contact.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_certification` [ RunTime:0.0150s ]
SQL: SELECT crm_purchase_supplier_certification.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_certification` left join crm_staff on crm_staff.id = crm_purchase_supplier_certification.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_certification.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_awards` [ RunTime:0.0090s ]
SQL: SELECT crm_purchase_supplier_awards.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_awards` left join crm_staff on crm_staff.id = crm_purchase_supplier_awards.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_awards.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_customer` [ RunTime:0.0140s ]
SQL: SELECT crm_purchase_supplier_customer.*,crm_staff.name FROM `crm_purchase_supplier_customer` left join crm_staff on crm_staff.id = crm_purchase_supplier_customer.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_equity` [ RunTime:0.0180s ]
SQL: SELECT crm_purchase_supplier_equity.*,crm_staff.name FROM `crm_purchase_supplier_equity` left join crm_staff on crm_staff.id = crm_purchase_supplier_equity.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0050s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_finance` [ RunTime:0.0080s ]
SQL: SELECT * FROM `crm_purchase_supplier_finance` WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_team` [ RunTime:0.0100s ]
SQL: SELECT crm_purchase_supplier_team.*,crm_staff.name FROM `crm_purchase_supplier_team` left join crm_staff on crm_staff.id = crm_purchase_supplier_team.create_id  WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_cooperation` [ RunTime:0.0090s ]
SQL: SELECT crm_purchase_supplier_cooperation.*,crm_staff.name FROM `crm_purchase_supplier_cooperation` left join crm_staff on crm_staff.id = crm_purchase_supplier_cooperation.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_audit` [ RunTime:0.0180s ]
SQL: SELECT crm_purchase_supplier_audit.*,crm_variable_type.name as type_name,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_audit` INNER JOIN crm_variable_type on crm_variable_type.id = crm_purchase_supplier_audit.audit_id left join crm_staff on crm_staff.id = crm_purchase_supplier_audit.staff_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_audit.file_id  WHERE crm_purchase_supplier_audit.supplier_pid = '' AND crm_variable_type.status = 1  [ RunTime:0.0060s ]

[ 2018-09-21T13:43:08+08:00 ] ::1 /Dwin/Purchase/getSupplierAllMsg
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.000000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0090s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0060s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0080s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0310s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getsupplierallmsg%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0110s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getsupplierallmsg','1537508588','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"10323\"}') [ RunTime:0.0900s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_address` [ RunTime:0.0140s ]
SQL: SELECT crm_purchase_supplier_address.*,crm_staff.name FROM `crm_purchase_supplier_address` left join crm_staff on crm_staff.id = crm_purchase_supplier_address.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10323'  [ RunTime:0.0120s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_contact` [ RunTime:0.0110s ]
SQL: SELECT crm_purchase_supplier_contact.*,crm_staff.name FROM `crm_purchase_supplier_contact` left join crm_staff on crm_staff.id = crm_purchase_supplier_contact.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10323'  [ RunTime:0.0170s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_certification` [ RunTime:0.0090s ]
SQL: SELECT crm_purchase_supplier_certification.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_certification` left join crm_staff on crm_staff.id = crm_purchase_supplier_certification.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_certification.file_id  WHERE `is_del` = 0 AND `supplier_pid` = '10323'  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_awards` [ RunTime:0.0120s ]
SQL: SELECT crm_purchase_supplier_awards.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_awards` left join crm_staff on crm_staff.id = crm_purchase_supplier_awards.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_awards.file_id  WHERE `is_del` = 0 AND `supplier_pid` = '10323'  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_customer` [ RunTime:0.0120s ]
SQL: SELECT crm_purchase_supplier_customer.*,crm_staff.name FROM `crm_purchase_supplier_customer` left join crm_staff on crm_staff.id = crm_purchase_supplier_customer.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10323'  [ RunTime:0.0170s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_equity` [ RunTime:0.0100s ]
SQL: SELECT crm_purchase_supplier_equity.*,crm_staff.name FROM `crm_purchase_supplier_equity` left join crm_staff on crm_staff.id = crm_purchase_supplier_equity.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10323'  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_finance` [ RunTime:0.0100s ]
SQL: SELECT * FROM `crm_purchase_supplier_finance` WHERE `supplier_pid` = '10323' AND `is_del` = 0  [ RunTime:0.0090s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_team` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_team.*,crm_staff.name FROM `crm_purchase_supplier_team` left join crm_staff on crm_staff.id = crm_purchase_supplier_team.create_id  WHERE `supplier_pid` = '10323' AND `is_del` = 0  [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_cooperation` [ RunTime:0.0080s ]
SQL: SELECT crm_purchase_supplier_cooperation.*,crm_staff.name FROM `crm_purchase_supplier_cooperation` left join crm_staff on crm_staff.id = crm_purchase_supplier_cooperation.create_id  WHERE `is_del` = 0 AND `supplier_pid` = '10323'  [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_audit` [ RunTime:0.0170s ]
SQL: SELECT crm_purchase_supplier_audit.*,crm_variable_type.name as type_name,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_audit` INNER JOIN crm_variable_type on crm_variable_type.id = crm_purchase_supplier_audit.audit_id left join crm_staff on crm_staff.id = crm_purchase_supplier_audit.staff_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_audit.file_id  WHERE crm_purchase_supplier_audit.supplier_pid = '10323' AND crm_variable_type.status = 1  [ RunTime:0.0160s ]

[ 2018-09-21T13:43:10+08:00 ] ::1 /Dwin/Purchase/getAddress.html
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0080s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0090s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0180s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getaddress%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0030s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0080s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getaddress','1537508590','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\" 10323\"}') [ RunTime:0.1740s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0080s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_address` [ RunTime:0.0090s ]
SQL: SELECT crm_purchase_supplier_address.*,crm_staff.name FROM `crm_purchase_supplier_address` left join crm_staff on crm_staff.id = crm_purchase_supplier_address.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ' 10323'  [ RunTime:0.0050s ]

[ 2018-09-21T13:43:15+08:00 ] ::1 /Dwin/Purchase/getSupplierAllMsg
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.002000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.003000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0100s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0100s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0070s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.0260s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/getsupplierallmsg%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0120s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/getsupplierallmsg','1537508594','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"id\":\"\"}') [ RunTime:0.2470s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0210s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_address` [ RunTime:0.0220s ]
SQL: SELECT crm_purchase_supplier_address.*,crm_staff.name FROM `crm_purchase_supplier_address` left join crm_staff on crm_staff.id = crm_purchase_supplier_address.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0180s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_contact` [ RunTime:0.0160s ]
SQL: SELECT crm_purchase_supplier_contact.*,crm_staff.name FROM `crm_purchase_supplier_contact` left join crm_staff on crm_staff.id = crm_purchase_supplier_contact.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0180s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_certification` [ RunTime:0.0190s ]
SQL: SELECT crm_purchase_supplier_certification.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_certification` left join crm_staff on crm_staff.id = crm_purchase_supplier_certification.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_certification.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0270s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_awards` [ RunTime:0.1840s ]
SQL: SELECT crm_purchase_supplier_awards.*,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_awards` left join crm_staff on crm_staff.id = crm_purchase_supplier_awards.create_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_awards.file_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.5400s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_customer` [ RunTime:0.0180s ]
SQL: SELECT crm_purchase_supplier_customer.*,crm_staff.name FROM `crm_purchase_supplier_customer` left join crm_staff on crm_staff.id = crm_purchase_supplier_customer.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0270s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_equity` [ RunTime:0.0200s ]
SQL: SELECT crm_purchase_supplier_equity.*,crm_staff.name FROM `crm_purchase_supplier_equity` left join crm_staff on crm_staff.id = crm_purchase_supplier_equity.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0160s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_finance` [ RunTime:0.0180s ]
SQL: SELECT * FROM `crm_purchase_supplier_finance` WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0160s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_team` [ RunTime:0.0170s ]
SQL: SELECT crm_purchase_supplier_team.*,crm_staff.name FROM `crm_purchase_supplier_team` left join crm_staff on crm_staff.id = crm_purchase_supplier_team.create_id  WHERE `supplier_pid` = '' AND `is_del` = 0  [ RunTime:0.0070s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_cooperation` [ RunTime:0.0100s ]
SQL: SELECT crm_purchase_supplier_cooperation.*,crm_staff.name FROM `crm_purchase_supplier_cooperation` left join crm_staff on crm_staff.id = crm_purchase_supplier_cooperation.create_id  WHERE `is_del` = 0 AND `supplier_pid` = ''  [ RunTime:0.0160s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier_audit` [ RunTime:0.0090s ]
SQL: SELECT crm_purchase_supplier_audit.*,crm_variable_type.name as type_name,crm_staff.name,crm_file_upload.file_name,crm_file_upload.path as file_url,SUBSTRING_INDEX(crm_file_upload.path,'.',-1) as file_type FROM `crm_purchase_supplier_audit` INNER JOIN crm_variable_type on crm_variable_type.id = crm_purchase_supplier_audit.audit_id left join crm_staff on crm_staff.id = crm_purchase_supplier_audit.staff_id left join crm_file_upload on crm_file_upload.id = crm_purchase_supplier_audit.file_id  WHERE crm_purchase_supplier_audit.supplier_pid = '' AND crm_variable_type.status = 1  [ RunTime:0.0080s ]

[ 2018-09-21T13:43:17+08:00 ] ::1 /Dwin/Purchase/supplierIndex
INFO: [ app_begin ] --START--
INFO: Run Behavior\ReadHtmlCacheBehavior [ RunTime:0.001000s ]
INFO: [ app_begin ] --END-- [ RunTime:0.001000s ]
SQL: SHOW COLUMNS FROM `crm_system` [ RunTime:0.0100s ]
SQL: SELECT `timelimit` FROM `crm_system` WHERE `id` = 1 LIMIT 1   [ RunTime:0.0040s ]
SQL: SHOW COLUMNS FROM `crm_auth_rule` [ RunTime:0.0120s ]
SQL: SELECT `rule_string` FROM `crm_auth_rule` WHERE `auth_id` IN ('264','265','266','267','268','269','195','181','182','183','184','185','186','187','188','189','190','191','192','193','194','1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33','34','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70','71','72','73','74','75','76','77','78','79','80','81','82','83','84','85','86','87','88','89','90','91','92','93','94','95','96','97','98','99','100','101','102','103','104','105','106','107','108','109','110','111','112','113','114','115','116','117','118','119','120','121','122','123','124','125','126','127','128','129','130','131','132','133','134','135','136','137','138','139','140','141','142','143','144','145','146','147','148','149','150','151','152','153','154','155','156','157','158','159','160','161','162','163','164','165','166','167','168','169','170','171','172','173','174','175','176','177','178','180','200','201','202','203','207','208','211','212','213','216','221','222','206','209','210','214','218','219','229','231','215','217','220','232','226','227','228','230','223','224','225','238','239','240','241','244','179','245','247','248','249','252','254','255','257','258','260','261','263','270','271')  [ RunTime:0.6620s ]
NOTIC: [8] Undefined variable: proId F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Common\function.php 第 52 行.
SQL: SELECT rule_name auth_rule_name,log_level level FROM `crm_auth_rule` WHERE `rule_string` LIKE '%purchase/supplierindex%' ORDER BY log_level desc LIMIT 1   [ RunTime:0.0160s ]
SQL: SHOW COLUMNS FROM `crm_stafflog` [ RunTime:0.0170s ]
SQL: INSERT INTO `crm_stafflog` (`staffid`,`remote_addr`,`request_uri`,`request_time`,`user_agent`,`request_method`,`request_info`) VALUES ('394','::1','purchase/supplierindex','1537508596','Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36','POST','{\"draw\":\"23\",\"columns\":[{\"data\":\"supplier_id\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"charge_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"supplier_name\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"business_licence\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"enterprise_cate\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"legal_name\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_bank\",\"name\":\"\",\"searchable\":\"false\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"account_number\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"audit_status\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}},{\"data\":\"second_audit\",\"name\":\"\",\"searchable\":\"true\",\"orderable\":\"true\",\"search\":{\"value\":\"\",\"regex\":\"false\"}}],\"order\":[{\"column\":\"0\",\"dir\":\"asc\"}],\"start\":\"0\",\"length\":\"25\",\"search\":{\"value\":\"\",\"regex\":\"false\"},\"function\":\"undefined\",\"staffLimit\":\"1\",\"audit_status\":\"1\"}') [ RunTime:0.0730s ]
SQL: SHOW COLUMNS FROM `crm_purchase_supplier` [ RunTime:0.0210s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 785 行.
SQL: SELECT p.*,crm_staff.name,(
                    CASE
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '0' THEN 0 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '2' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '20' THEN 2 
                        WHEN REPLACE(group_concat(DISTINCT(a.status)),',','')  = '02' THEN 2 
                    ELSE 1
                    END 
                  ) AS second_audit,group_concat(DISTINCT(a.status)) FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid ORDER BY supplier_id asc LIMIT 0,25   [ RunTime:0.2920s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 796 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.2500s ]
NOTIC: [8] Undefined variable: having F:\dwin\phpStudy\WWW\trunk\2-ProductDoc\CRM\Dwin\Model\PurchaseSupplierModel.class.php 第 803 行.
SQL: SELECT * FROM crm_purchase_supplier p left join crm_staff on crm_staff.id = p.creater left join crm_purchase_supplier_audit a on a.supplier_pid = p.id  WHERE p.charger = '394' AND p.is_del = 0 AND p.audit_status = 0 GROUP BY a.supplier_pid  [ RunTime:0.2530s ]

